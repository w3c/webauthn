<!DOCTYPE html>
<html lang="en" dir="ltr" typeof="bibo:Document " prefix="bibo: http://purl.org/ontology/bibo/ w3p: http://www.w3.org/2001/02pd/rec54#">
<head><meta property="dc:language" content="en" lang="">
    <title>FIDO 2.0: Key Attestation Format</title>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    
    
    
    
  <style>/*****************************************************************
 * ReSpec 3 CSS
 * Robin Berjon - http://berjon.com/
 *****************************************************************/

/* --- INLINES --- */
em.rfc2119 { 
    text-transform:     lowercase;
    font-variant:       small-caps;
    font-style:         normal;
    color:              #900;
}

h1 acronym, h2 acronym, h3 acronym, h4 acronym, h5 acronym, h6 acronym, a acronym,
h1 abbr, h2 abbr, h3 abbr, h4 abbr, h5 abbr, h6 abbr, a abbr {
    border: none;
}

dfn {
    font-weight:    bold;
}

a.internalDFN {
    color:  inherit;
    border-bottom:  1px solid #99c;
    text-decoration:    none;
}

a.externalDFN {
    color:  inherit;
    border-bottom:  1px dotted #ccc;
    text-decoration:    none;
}

a.bibref {
    text-decoration:    none;
}

cite .bibref {
    font-style: normal;
}

code {
    color:  #C83500;
}

/* --- TOC --- */
.toc a, .tof a {
    text-decoration:    none;
}

a .secno, a .figno {
    color:  #000;
}

ul.tof, ol.tof {
    list-style: none outside none;
}

.caption {
    margin-top: 0.5em;
    font-style:   italic;
}

/* --- TABLE --- */
table.simple {
    border-spacing: 0;
    border-collapse:    collapse;
    border-bottom:  3px solid #005a9c;
}

.simple th {
    background: #005a9c;
    color:  #fff;
    padding:    3px 5px;
    text-align: left;
}

.simple th[scope="row"] {
    background: inherit;
    color:  inherit;
    border-top: 1px solid #ddd;
}

.simple td {
    padding:    3px 10px;
    border-top: 1px solid #ddd;
}

.simple tr:nth-child(even) {
    background: #f0f6ff;
}

/* --- DL --- */
.section dd > p:first-child {
    margin-top: 0;
}

.section dd > p:last-child {
    margin-bottom: 0;
}

.section dd {
    margin-bottom:  1em;
}

.section dl.attrs dd, .section dl.eldef dd {
    margin-bottom:  0;
}

@media print {
    .removeOnSave {
        display: none;
    }
}
</style><style>/* --- ISSUES/NOTES --- */
div.issue-title, div.note-title , div.ednote-title, div.warning-title {
    padding-right:  1em;
    min-width: 7.5em;
    color: #b9ab2d;
}
div.issue-title { color: #e05252; }
div.note-title, div.ednote-title { color: #2b2; }
div.warning-title { color: #f22; }
div.issue-title span, div.note-title span, div.ednote-title span, div.warning-title span {
    text-transform: uppercase;
}
div.note, div.issue, div.ednote, div.warning {
    margin-top: 1em;
    margin-bottom: 1em;
}
.note > p:first-child, .ednote > p:first-child, .issue > p:first-child, .warning > p:first-child { margin-top: 0 }
.issue, .note, .ednote, .warning {
    padding: .5em;
    border-left-width: .5em;
    border-left-style: solid;
}
div.issue, div.note , div.ednote,  div.warning {
    padding: 1em 1.2em 0.5em;
    margin: 1em 0;
    position: relative;
    clear: both;
}
span.note, span.ednote, span.issue, span.warning { padding: .1em .5em .15em; }

.issue {
    border-color: #e05252;
    background: #fbe9e9;
}
.note, .ednote {
    border-color: #52e052;
    background: #e9fbe9;
}

.warning {
    border-color: #f11;
    border-right-width: .2em;
    border-top-width: .2em;
    border-bottom-width: .2em;
    border-style: solid;
    background: #fbe9e9;
}

.warning-title:before{
    content: "⚠"; /*U+26A0 WARNING SIGN*/
    font-size: 3em;
    float: left;
    height: 100%;
    padding-right: .3em;
    vertical-align: top;
    margin-top: -0.5em;
}

li.task-list-item {
    list-style: none;
}

input.task-list-item-checkbox {
    margin: 0 0.35em 0.25em -1.6em;
    vertical-align: middle;
}
</style><style>/* --- WEB IDL --- */
pre.idl {
    border-top: 1px solid #90b8de;
    border-bottom: 1px solid #90b8de;
    padding:    1em;
    line-height:    120%;
}

pre.idl::before {
    content:    "WebIDL";
    display:    block;
    width:      150px;
    background: #90b8de;
    color:  #fff;
    font-family:    sans-serif;
    padding:    3px;
    font-weight:    bold;
    margin: -1em 0 1em -1em;
}

.idlType {
    color:  #ff4500;
    font-weight:    bold;
    text-decoration:    none;
}

/*.idlModule*/
/*.idlModuleID*/
/*.idlInterface*/
.idlInterfaceID, .idlDictionaryID, .idlCallbackID, .idlEnumID {
    font-weight:    bold;
    color:  #005a9c;
}
a.idlEnumItem {
    color:  #000;
    border-bottom:  1px dotted #ccc;
    text-decoration: none;
}

.idlSuperclass {
    font-style: italic;
    color:  #005a9c;
}

/*.idlAttribute*/
.idlAttrType, .idlFieldType, .idlMemberType {
    color:  #005a9c;
}
.idlAttrName, .idlFieldName, .idlMemberName {
    color:  #ff4500;
}
.idlAttrName a, .idlFieldName a, .idlMemberName a {
    color:  #ff4500;
    border-bottom:  1px dotted #ff4500;
    text-decoration: none;
}

/*.idlMethod*/
.idlMethType, .idlCallbackType {
    color:  #005a9c;
}
.idlMethName {
    color:  #ff4500;
}
.idlMethName a {
    color:  #ff4500;
    border-bottom:  1px dotted #ff4500;
    text-decoration: none;
}

/*.idlCtor*/
.idlCtorName {
    color:  #ff4500;
}
.idlCtorName a {
    color:  #ff4500;
    border-bottom:  1px dotted #ff4500;
    text-decoration: none;
}

/*.idlParam*/
.idlParamType {
    color:  #005a9c;
}
.idlParamName, .idlDefaultValue {
    font-style: italic;
}

.extAttr {
    color:  #666;
}

/*.idlSectionComment*/
.idlSectionComment {
    color: gray;
}

/*.idlIterable*/
.idlIterableKeyType, .idlIterableValueType {
    color:  #005a9c;
}

/*.idlMaplike*/
.idlMaplikeKeyType, .idlMaplikeValueType {
    color:  #005a9c;
}

/*.idlConst*/
.idlConstType {
    color:  #005a9c;
}
.idlConstName {
    color:  #ff4500;
}
.idlConstName a {
    color:  #ff4500;
    border-bottom:  1px dotted #ff4500;
    text-decoration: none;
}

/*.idlException*/
.idlExceptionID {
    font-weight:    bold;
    color:  #c00;
}

.idlTypedefID, .idlTypedefType {
    color:  #005a9c;
}

.idlRaises, .idlRaises a.idlType, .idlRaises a.idlType code, .excName a, .excName a code {
    color:  #c00;
    font-weight:    normal;
}

.excName a {
    font-family:    monospace;
}

.idlRaises a.idlType, .excName a.idlType {
    border-bottom:  1px dotted #c00;
}

.excGetSetTrue, .excGetSetFalse, .prmNullTrue, .prmNullFalse, .prmOptTrue, .prmOptFalse {
    width:  45px;
    text-align: center;
}
.excGetSetTrue, .prmNullTrue, .prmOptTrue { color:  #0c0; }
.excGetSetFalse, .prmNullFalse, .prmOptFalse { color:  #c00; }

.idlImplements a {
    font-weight:    bold;
}

dl.attributes, dl.methods, dl.constants, dl.constructors, dl.fields, dl.dictionary-members {
    margin-left:    2em;
}

.attributes dt, .methods dt, .constants dt, .constructors dt, .fields dt, .dictionary-members dt {
    font-weight:    normal;
}

.attributes dt code, .methods dt code, .constants dt code, .constructors dt code, .fields dt code, .dictionary-members dt code {
    font-weight:    bold;
    color:  #000;
    font-family:    monospace;
}

.attributes dt code, .fields dt code, .dictionary-members dt code {
    background:  #ffffd2;
}

.attributes dt .idlAttrType code, .fields dt .idlFieldType code, .dictionary-members dt .idlMemberType code {
    color:  #005a9c;
    background:  transparent;
    font-family:    inherit;
    font-weight:    normal;
    font-style: italic;
}

.methods dt code {
    background:  #d9e6f8;
}

.constants dt code {
    background:  #ddffd2;
}

.constructors dt code {
    background:  #cfc;
}

.attributes dd, .methods dd, .constants dd, .constructors dd, .fields dd, .dictionary-members dd {
    margin-bottom:  1em;
}

table.parameters, table.exceptions {
    border-spacing: 0;
    border-collapse:    collapse;
    margin: 0.5em 0;
    width:  100%;
}
table.parameters { border-bottom:  1px solid #90b8de; }
table.exceptions { border-bottom:  1px solid #deb890; }

.parameters th, .exceptions th {
    color:  #fff;
    padding:    3px 5px;
    text-align: left;
    font-weight:    normal;
    text-shadow:    #666 1px 1px 0;
}
.parameters th { background: #90b8de; }
.exceptions th { background: #deb890; }

.parameters td, .exceptions td {
    padding:    3px 10px;
    border-top: 1px solid #ddd;
    vertical-align: top;
}

.parameters tr:first-child td, .exceptions tr:first-child td {
    border-top: none;
}

.parameters td.prmName, .exceptions td.excName, .exceptions td.excCodeName {
    width:  100px;
}

.parameters td.prmType {
    width:  120px;
}

table.exceptions table {
    border-spacing: 0;
    border-collapse:    collapse;
    width:  100%;
}
</style><link href="https://www.w3.org/StyleSheets/TR/W3C-Member-SUBM" rel="stylesheet"><!--[if lt IE 9]><script src='https://www.w3.org/2008/site/js/html5shiv.js'></script><![endif]--><script type="application/json" id="initialUserConfig">{
  "specStatus": "Member-SUBM",
  "specVersion": "v2.0",
  "shortName": "fido-key-attestation",
  "publishDate": "2015-11-20",
  "copyrightStart": "2013",
  "editors": [
    {
      "name": "Rolf Lindemann",
      "mailto": "rolf@noknok.com",
      "company": "Nok Nok Labs",
      "companyURL": "https://www.noknok.com"
    }
  ],
  "authors": [
    {
      "name": "Michael B. Jones",
      "mailto": "mbj@microsoft.com",
      "company": "Microsoft",
      "companyURL": "http://www.microsoft.com"
    }
  ],
  "wg": "FIDO Alliance",
  "wgURI": "https://fidoalliance.org/",
  "localBiblio": {
    "FIDOSignatureFormat": {
      "title": "FIDO 2.0: Signature format",
      "href": "http://www.w3.org/Submission/2015/SUBM-fido-signature-format-20151120/"
    },
    "FIDOWebApi": {
      "title": "FIDO 2.0: Web API for accessing FIDO 2.0 credentials",
      "href": "http://www.w3.org/Submission/2015/SUBM-fido-web-api-20151120/"
    },
    "FIDOEcdaaAlgorithm": {
      "title": "FIDO ECDAA Algorithm",
      "authors": [
        "R. Lindemann",
        "A. Edgington",
        "R. Urian"
      ],
      "status": "FIDO Alliance Proposed Standard (To Be Published)"
    },
    "FIDOSecRef": {
      "authors": [
        "R. Lindemann",
        "D. Baghdasaryan",
        "B. Hill"
      ],
      "title": "FIDO Security Reference",
      "href": "https://fidoalliance.org/specs/fido-uaf-v1.0-ps-20141208/fido-security-ref-v1.0-ps-20141208.html",
      "status": "FIDO Alliance Proposed Standard"
    },
    "FIDOMetadataService": {
      "authors": [
        "R. Lindemann",
        "B. Hill",
        "D. Baghdasaryan"
      ],
      "title": "FIDO Metadata Service v1.0",
      "href": "https://fidoalliance.org/specs/fido-uaf-v1.0-ps-20141208/fido-uaf-metadata-service-v1.0-ps-20141208.html",
      "status": "FIDO Alliance Proposed Standard"
    },
    "SEC1": {
      "title": "SEC1: Elliptic Curve Cryptography, Version 2.0",
      "publisher": "Standards for Efficient Cryptography Group",
      "href": "http://www.secg.org/sec1-v2.pdf"
    },
    "TPM": {
      "title": "TPM Main Specification",
      "publisher": "Trusted Computing Group",
      "date": "Accessed March 2014",
      "href": "http://www.trustedcomputinggroup.org/resources/tpm_main_specification"
    },
    "TPMv1-2-Part2": {
      "title": "TPM 1.2 Part 2: Structures",
      "publisher": "Trusted Computing Group",
      "href": "http://www.trustedcomputinggroup.org/files/static_page_files/E55A303C-1A4B-B294-D066E66A82DAE27D/TPM%20Main-Part%202%20TPM%20Structures_v1.2_rev116_01032011.pdf"
    },
    "TPMv1-2-Credential-Profiles": {
      "title": "TPM 1.2 Credential Profiles",
      "publisher": "Trusted Computing Group",
      "href": "http://www.trustedcomputinggroup.org/files/static_page_files/A55529C5-1A4B-B294-D0A5A400E1EDE13A/Credential_Profiles_V1.2_Level2_Revision8.pdf"
    },
    "TPMv2-Part2": {
      "title": "Trusted Platform Module Library, Part 2: Structures",
      "publisher": "Trusted Computing Group",
      "href": "http://www.trustedcomputinggroup.org/files/static_page_files/8C583202-1A4B-B294-D0469592DB10A6CD/TPM%20Rev%202.0%20Part%202%20-%20Structures%2001.16.pdf"
    },
    "TPMv2-EK-Profile": {
      "title": "TCG EK Credential Profile",
      "publisher": "Trusted Computing Group",
      "href": "http://www.trustedcomputinggroup.org/files/static_page_files/DCD56924-1A4B-B294-D0CEF64E80CEE01E/Credential_Profile_EK_V2.0_R12_PublicReview.pdf"
    },
    "UAFProtocol": {
      "authors": [
        "R. Lindemann",
        "D. Baghdasaryan",
        "E. Tiffany",
        "D. Balfanz",
        "B. Hill",
        "J. Hodges"
      ],
      "title": "FIDO UAF Protocol Specification v1.0",
      "status": "FIDO Alliance Proposed Standard",
      "href": "https://fidoalliance.org/specs/fido-uaf-v1.0-ps-20141208/fido-uaf-protocol-v1.0-ps-20141208.html"
    }
  }
}</script></head>
  <body id="respecDocument" role="document" class="h-entry"><div id="respecHeader" role="contentinfo" class="head">
  <p>
      
        
            <a href="http://www.w3.org/"><img src="https://www.w3.org/Icons/w3c_home" alt="W3C" width="72" height="48"></a>
            
            <a href="http://www.w3.org/Submission/"> <img alt="W3C Member Submission" src="http://www.w3.org/Icons/member_subm" width="211" height="48"></a>
            
            
        
      
  </p>
  <h1 class="title p-name" id="title" property="dcterms:title">FIDO 2.0: Key Attestation Format</h1>
  
  <h2 id="w3c-member-submission-20-november-2015"><abbr title="World Wide Web Consortium">W3C</abbr> Member Submission <time property="dcterms:issued" class="dt-published" datetime="2015-11-20">20 November 2015</time></h2>
  <dl>
    
      <dt>This version:</dt>
      <dd><a class="u-url" href="http://www.w3.org/Submission/2015/SUBM-fido-key-attestation-20151120/">http://www.w3.org/Submission/2015/SUBM-fido-key-attestation-20151120/</a></dd>
      <dt>Latest published version:</dt>
      <dd><a href="http://www.w3.org/Submission/fido-key-attestation/">http://www.w3.org/Submission/fido-key-attestation/</a></dd>
    
    
    
    
    
    
    
    
    <dt>Editor:</dt>
    <dd class="p-author h-card vcard" property="bibo:editor" resource="_:editor0"><span property="rdf:first" typeof="foaf:Person"><span property="foaf:name" class="p-name fn">Rolf Lindemann</span>, <a property="foaf:workplaceHomepage" class="p-org org h-org h-card" href="https://www.noknok.com">Nok Nok Labs</a>, <span class="ed_mailto"><a class="u-email email" property="foaf:mbox" href="mailto:rolf@noknok.com">rolf@noknok.com</a></span></span>
<span property="rdf:rest" resource="rdf:nil"></span>
</dd>

    
      <dt>Author:</dt>
      <dd class="p-author h-card vcard"><span property="dc:contributor" typeof="foaf:Person"><span property="foaf:name" class="p-name fn">Michael B. Jones</span>, <a property="foaf:workplaceHomepage" class="p-org org h-org h-card" href="http://www.microsoft.com">Microsoft</a>, <span class="ed_mailto"><a class="u-email email" property="foaf:mbox" href="mailto:mbj@microsoft.com">mbj@microsoft.com</a></span></span>
</dd>

    
    
  </dl>
  
  
  
  
    
      <p class="copyright">
        <a href="http://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a> ©
        2013-2015
        
        <a href="http://www.w3.org/"><abbr title="World Wide Web Consortium">W3C</abbr></a><sup>®</sup>
        (<a href="http://www.csail.mit.edu/"><abbr title="Massachusetts Institute of Technology">MIT</abbr></a>,
        <a href="http://www.ercim.eu/"><abbr title="European Research Consortium for Informatics and Mathematics">ERCIM</abbr></a>,
        <a href="http://www.keio.ac.jp/">Keio</a>, <a href="http://ev.buaa.edu.cn/">Beihang</a>). 
        
        <abbr title="World Wide Web Consortium">W3C</abbr> <a href="http://www.w3.org/Consortium/Legal/ipr-notice#Legal_Disclaimer">liability</a>,
        <a href="http://www.w3.org/Consortium/Legal/ipr-notice#W3C_Trademarks">trademark</a> and
        
          
            <a rel="license" href="http://www.w3.org/Consortium/Legal/copyright-documents">document use</a>
          
        
        rules apply.
      </p>
    
  
  <hr>
</div>
    <!-- only put content here if you want a custom status of document not
	 the specification-maturity-appropriate boilerplate -->
    
    
    <section property="dc:abstract" class="introductory" id="abstract"><h2 resource="#h-abstract" id="h-abstract"><span property="xhv:role" resource="xhv:heading">Abstract</span></h2>
      <p>FIDO specifications support
	different user verification methods (PIN based, fingerprint based, etc.) and 
	authenticator implementations, e.g. in 
	a rich operating system, in a trusted execution environments (TEE) or in a secure element/TPM.
	The resulting authentication strength depends on the user verification method and the 
	protection mechanisms implemented by the authenticator.  
      </p>
      <p>FIDO uses the concept of attestation to provide a cryptographic proof of the authenticator
	model to the relying party.  The relying party can derive the authenticator security 
	characteristics from this proof.
      </p>      
      <p>This specification defines generic data structures that cover the
	semantics of FIDO Authenticator attestation. This specification also 
	provides a profile of these structures when a TPM [<cite><a href="#bib-TPM" class="bibref">TPM</a></cite>] acts as a crypto kernel. 
	More profiles are expected to be added as the specification
	evolves.
      </p>
      
    </section><section id="sotd" class="introductory"><h2 resource="#h-sotd" id="h-sotd"><span property="xhv:role" resource="xhv:heading">Status of This Document</span></h2>
  
    
      
        <p>
          <em>This section describes the status of this document at the time of its publication. Other documents may supersede this document. A list of current <abbr title="World Wide Web Consortium">W3C</abbr> publications can be found in the <a href="http://www.w3.org/TR/"><abbr title="World Wide Web Consortium">W3C</abbr> technical reports index</a> at http://www.w3.org/TR/.</em>
        </p>
        
          
          
            <p>By publishing this document, <abbr title="World Wide Web Consortium">W3C</abbr> acknowledges that the <a href="http://www.w3.org/Submission/2015/SUBM-fido-key-attestation-20151120/">Submitting Members</a> have made a formal Submission request to <abbr title="World Wide Web Consortium">W3C</abbr> for discussion. Publication of this document by <abbr title="World Wide Web Consortium">W3C</abbr> indicates no endorsement of its content by <abbr title="World Wide Web Consortium">W3C</abbr>, nor that <abbr title="World Wide Web Consortium">W3C</abbr> has, is, or will be allocating any resources to the issues addressed by it. This document is not the product of a chartered <abbr title="World Wide Web Consortium">W3C</abbr> group, but is published as potential input to the <a href="http://www.w3.org/Consortium/Process"><abbr title="World Wide Web Consortium">W3C</abbr> Process</a>. A <a href="http://www.w3.org/Submission/2015/02/Comment/"><abbr title="World Wide Web Consortium">W3C</abbr> Team Comment</a> has been published in conjunction with this Member Submission. Publication of acknowledged Member Submissions at the <abbr title="World Wide Web Consortium">W3C</abbr> site is one of the benefits of <a href="http://www.w3.org/Consortium/Prospectus/Joining"><abbr title="World Wide Web Consortium">W3C</abbr> Membership</a>. Please consult the requirements associated with Member Submissions of <a href="http://www.w3.org/Consortium/Patent-Policy-20040205/#sec-submissions">section 3.3 of the <abbr title="World Wide Web Consortium">W3C</abbr> Patent Policy</a>. Please consult the complete <a href="http://www.w3.org/Submission">list of acknowledged <abbr title="World Wide Web Consortium">W3C</abbr> Member Submissions</a>.</p>
          
        
      
    
  
</section><section id="toc"><h2 resource="#h-toc" id="h-toc" class="introductory"><span property="xhv:role" resource="xhv:heading">Table of Contents</span></h2><ul id="respecContents" role="directory" class="toc"><li class="tocline"><a class="tocxref" href="#notation"><span class="secno">1. </span>Notation</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#conformance"><span class="secno">1.1 </span>Conformance</a></li><li class="tocline"><a class="tocxref" href="#glossary"><span class="secno">1.2 </span>Glossary</a></li></ul></li><li class="tocline"><a class="tocxref" href="#overview"><span class="secno">2. </span>Overview</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#attestation-models"><span class="secno">2.1 </span>Attestation Models</a></li><li class="tocline"><a class="tocxref" href="#contextual-data"><span class="secno">2.2 </span>Contextual Data</a></li><li class="tocline"><a class="tocxref" href="#attestation-raw-data-types"><span class="secno">2.3 </span>Attestation Raw Data Types</a></li></ul></li><li class="tocline"><a class="tocxref" href="#attestation-statement"><span class="secno">3. </span>Attestation Statement</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#client-encoding-of-attestation-statements"><span class="secno">3.1 </span>Client encoding of attestation statements</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#attributes"><span class="secno">3.1.1 </span>Attributes</a></li></ul></li><li class="tocline"><a class="tocxref" href="#attestationcore"><span class="secno">3.2 </span>AttestationCore</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#attributes-1"><span class="secno">3.2.1 </span>Attributes</a></li><li class="tocline"><a class="tocxref" href="#client-data"><span class="secno">3.2.2 </span>Client data</a></li></ul></li><li class="tocline"><a class="tocxref" href="#attestationheader"><span class="secno">3.3 </span>AttestationHeader</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#attributes-2"><span class="secno">3.3.1 </span>Attributes</a></li></ul></li><li class="tocline"><a class="tocxref" href="#defined-attestation-raw-data-types"><span class="secno">3.4 </span>Defined Attestation Raw Data Types</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#packed-attestation"><span class="secno">3.4.1 </span>Packed Attestation</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#attestation-rawdata-type-packed"><span class="secno">3.4.1.1 </span>Attestation rawData (type="packed")</a></li><li class="tocline"><a class="tocxref" href="#extensions-for-packed-attestation-rawdata"><span class="secno">3.4.1.2 </span>Extensions for Packed Attestation rawData</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#aaguid-extension"><span class="secno">3.4.1.2.1 </span>AAGUID Extension</a></li><li class="tocline"><a class="tocxref" href="#supportedextensions-extension"><span class="secno">3.4.1.2.2 </span>SupportedExtensions Extension</a></li><li class="tocline"><a class="tocxref" href="#user-verification-index-uvi-extension"><span class="secno">3.4.1.2.3 </span>User Verification Index (UVI) Extension</a></li></ul></li><li class="tocline"><a class="tocxref" href="#signature"><span class="secno">3.4.1.3 </span>Signature</a></li><li class="tocline"><a class="tocxref" href="#attestation-statement-certificate-requirements"><span class="secno">3.4.1.4 </span>Attestation statement certificate requirements</a></li></ul></li><li class="tocline"><a class="tocxref" href="#tpm-attestation"><span class="secno">3.4.2 </span>TPM Attestation</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#attestation-rawdata-type-tpm"><span class="secno">3.4.2.1 </span>Attestation rawData (type="tpm")</a></li><li class="tocline"><a class="tocxref" href="#signature-1"><span class="secno">3.4.2.2 </span>Signature</a></li><li class="tocline"><a class="tocxref" href="#tpm-attestation-statement-certificate-requirements"><span class="secno">3.4.2.3 </span>TPM attestation statement certificate requirements</a></li></ul></li><li class="tocline"><a class="tocxref" href="#android-attestation"><span class="secno">3.4.3 </span>Android Attestation</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#attestation-rawdata-type-android"><span class="secno">3.4.3.1 </span>Attestation rawData (type="android")</a></li><li class="tocline"><a class="tocxref" href="#signature-2"><span class="secno">3.4.3.2 </span>Signature</a></li><li class="tocline"><a class="tocxref" href="#converting-safetynet-response-to-attestationstatement"><span class="secno">3.4.3.3 </span>Converting SafetyNet response to attestationStatement</a></li><li class="tocline"><a class="tocxref" href="#androidattestationclientdata"><span class="secno">3.4.3.4 </span>AndroidAttestationClientData</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#dictionary-androidattestationclientdata-members"><span class="secno">3.4.3.4.1 </span>Dictionary <span class="formerLink"><code>AndroidAttestationClientData</code></span> Members</a></li><li class="tocline"><a class="tocxref" href="#verifying-androidclientdata-specific-contextual-bindings"><span class="secno">3.4.3.4.2 </span>Verifying AndroidClientData specific contextual bindings</a></li></ul></li></ul></li></ul></li><li class="tocline"><a class="tocxref" href="#verifying-an-attestation-statement"><span class="secno">3.5 </span>Verifying an Attestation Statement</a></li></ul></li><li class="tocline"><a class="tocxref" href="#security-considerations"><span class="secno">4. </span>Security Considerations</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#privacy"><span class="secno">4.1 </span>Privacy</a></li><li class="tocline"><a class="tocxref" href="#attestation-certificate-and-attestation-certificate-ca-compromise"><span class="secno">4.2 </span>Attestation Certificate and Attestation Certificate CA Compromise</a></li><li class="tocline"><a class="tocxref" href="#attestation-certificate-hierarchy"><span class="secno">4.3 </span>Attestation Certificate Hierarchy</a></li></ul></li><li class="tocline"><a class="tocxref" href="#references"><span class="secno">A. </span>References</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#normative-references"><span class="secno">A.1 </span>Normative references</a></li><li class="tocline"><a class="tocxref" href="#informative-references"><span class="secno">A.2 </span>Informative references</a></li></ul></li></ul></section>
    
    <section property="bibo:hasPart" resource="#notation" typeof="bibo:Chapter" id="notation">
      <!--OddPage--><h2 resource="#h-notation" id="h-notation"><span property="xhv:role" resource="xhv:heading"><span class="secno">1. </span>Notation</span></h2>
      
      <section property="bibo:hasPart" resource="#conformance" typeof="bibo:Chapter" id="conformance"><h3 resource="#h-conformance" id="h-conformance"><span property="xhv:role" resource="xhv:heading"><span class="secno">1.1 </span>Conformance</span></h3>
<p>
  As well as sections marked as non-normative, all authoring guidelines, diagrams, examples,
  and notes in this specification are non-normative. Everything else in this specification is
  normative.
</p>
<p id="respecRFC2119">The key words <em class="rfc2119" title="MAY">MAY</em>, <em class="rfc2119" title="MUST">MUST</em>, <em class="rfc2119" title="MUST NOT">MUST NOT</em>, <em class="rfc2119" title="SHALL">SHALL</em>, and <em class="rfc2119" title="SHOULD">SHOULD</em> are 
  to be interpreted as described in [<cite><a href="#bib-RFC2119" class="bibref">RFC2119</a></cite>].
</p>
  <!-- inserts normative/non-normative & RFC2119 boilerplate -->
	<!-- add any extra language your spec requires here -->
      </section>

      <section property="bibo:hasPart" resource="#glossary" typeof="bibo:Chapter" id="glossary">
	<h3 resource="#h-glossary" id="h-glossary"><span property="xhv:role" resource="xhv:heading"><span class="secno">1.2 </span>Glossary</span></h3>

	<p>A glossary of terms used here is provided in a companion
	  document.
	</p>

	<p>
	  The term <b>Base64url Encoding</b> refers to the
	  base64 encoding using the URL- and filename-safe
	  character set defined in Section 5 of [<cite><a href="#bib-RFC4648" class="bibref">RFC4648</a></cite>],
	  with all trailing '=' characters omitted (as permitted by Section 3.2)
	  and without the inclusion of any line breaks, whitespace, or other additional characters.
	  This is the same encoding as used by
	  JSON Web Signature (JWS) [<cite><a href="#bib-RFC7515" class="bibref">RFC7515</a></cite>].
      </p>
      </section>
    </section>

    <section property="bibo:hasPart" resource="#overview" typeof="bibo:Chapter" id="overview">
      <!--OddPage--><h2 resource="#h-overview" id="h-overview"><span property="xhv:role" resource="xhv:heading"><span class="secno">2. </span>Overview</span></h2>

      <section property="bibo:hasPart" resource="#attestation-models" typeof="bibo:Chapter" id="attestation-models">
	<h3 resource="#h-attestation-models" id="h-attestation-models"><span property="xhv:role" resource="xhv:heading"><span class="secno">2.1 </span>Attestation Models</span></h3>
      
	<p>FIDO 2.0 specifies multiple attestation models:</p>
	<dl>
	  <dt>Full Basic Attestation</dt>
	  <dd>In the case of full basic attestation [<cite><a href="#bib-UAFProtocol" class="bibref">UAFProtocol</a></cite>], the Authenticator's attestation private key is
	    specific to an Authenticator model.  That means that an Authenticator of the same model
	    typically shares the same attestation private key.
	    <p>This model is also used for FIDO UAF 1.0 and FIDO U2F 1.0.</p>
	  </dd>
	  <dt>Surrogate Basic Attestation</dt>
	  <dd>In the case of surrogate basic attestation [<cite><a href="#bib-UAFProtocol" class="bibref">UAFProtocol</a></cite>], the 
	    Authenticator doesn't have any specific attestation key.  Instead it uses 
	    the authentication key to (self-)sign the (surrogate) attestation message.  
	    Authenticators without meaningful protection measures for an attestation private key
	    typically use this attestation model.  
	  </dd>
	  <dt>Privacy CA</dt>
	  <dd>In this case, the authenticator owns an authenticator-specific (endorsement) key.  
	    This key is used to securely communicate with a trusted third party, 
	    the Privacy CA.  The Authenticator can generate
	    multiple attestation key pairs and asks the Privacy CA to issue an 
	    attestation certificate for it. 
	    <p>Using this approach, the Authenticator can limit the exposure of the 
	      endorsement key (which is a global correlation handle) to Privacy CA(s).
	      Attestation keys can be requested for each FIDO credential individually.
	    </p>
	    <div class="note"><div id="h-note1" role="heading" aria-level="4" class="note-title"><span>Note</span></div><p class="">This concept typically leads to multiple attestation certificates.
	      The attestation certificate requested most recently is called "active".
	    </p></div>
	  </dd>
	  <dt>Direct Anonymous Attestation (DAA)</dt>
	  <dd>In this case, the Authenticator receives DAA credentials from a single DAA-Issuer.
	    These DAA credentials are used along with blinding to sign the attestation data.
	    The concept of blinding avoids the DAA credentials being misused as global correlation handle.
	    <p>FIDO 2.0 supports DAA using elliptic curve cryptography and bilinear pairings, 
	      called ECDAA (see [<cite><a href="#bib-FIDOEcdaaAlgorithm" class="bibref">FIDOEcdaaAlgorithm</a></cite>]) in this specification.</p>
	  </dd>
	</dl>
	<p>Compliant FIDO Servers <em title="MUST" class="rfc2119">MUST</em> support all attestation models.  
	  Authenticators can choose what attestation model to implement.
	</p>
	<div class="note"><div id="h-note2" role="heading" aria-level="4" class="note-title"><span>Note</span></div><p class="">Relying parties can always decide what attestation models are acceptable by policy.
	</p></div>
      </section>

      <section property="bibo:hasPart" resource="#contextual-data" typeof="bibo:Chapter" id="contextual-data">
	<h3 resource="#h-contextual-data" id="h-contextual-data"><span property="xhv:role" resource="xhv:heading"><span class="secno">2.2 </span>Contextual Data</span></h3>

	<p>FIDO 2.0 attestation statements are bound to various contextual data. These data are
	  observed, and added at different levels of the stack as a signature request
	  passes from the server to the authenticator. In verifying a signature, the
	  server checks these bindings against expected values.</p>
	
	<p>These components can be divided into three layers:</p>
	<ol>
	  <li>The relying party (RP) consists of two subcomponents: an online
	    service and a client-side application. The client-side app may, for
	    example, be a web application running in a browser, or a native application
	    that runs directly on the OS platform.</li>
	  <li>The client platform, which consists of the user’s OS and device used to
	    host the RP’s client-side app. For web applications, the browser also belongs
	    to this layer.</li>
	  <li>The authenticator itself, which provides key generation and key management and
	    cryptographic signatures.</li>
	</ol>
	
	<p>The goals of this design can be summarized as follows.
	  </p><ul>
	    <li>The scheme for generating keys and attestation statements should accommodate cases where the
	      link between the client platform and authenticator is very limited, in
	      bandwidth and/or latency. Examples include Bluetooth Low Energy and Near-Field
	      Communication.</li>
	    <li>The data processed by the authenticator should be small and easy to
	      interpret in low-level code. In particular, authenticators should not have to
	      parse high-level encodings such as JSON.</li>
	    <li>Both the client platform and the authenticator should have the flexibility
	      to add contextual bindings, as needed.</li>
	    <li>The design aims to reuse existing encoding formats as much as possible
	      to aid adoption and implementation.</li>
	  </ul>
	<p></p>
	
	<p>
	  There are two kinds of contextual bindings:
	  Those added by the RP or the client platform,
	  referred to as <dfn id="dfn-client-data" data-dfn-type="dfn">client data</dfn> (see [<cite><a href="#bib-FIDOSignatureFormat" class="bibref">FIDOSignatureFormat</a></cite>])
	  and those added by the
	  authenticator, referred to as the <dfn id="dfn-attestation-data" data-dfn-type="dfn">attestation data</dfn>.  The client
	  data must be signed over, but an authenticator is otherwise not interested in
	  its contents.  More specifically, the authenticator cannot attest to the correctness of such data.
	  To save bandwidth and processing requirements on the
	  authenticator, the client platform hashes the client data and sends only
	  the hash result to the authenticator. The authenticator attestation statement includes the combination
	  of this hash, and its own attestation data.
	</p>

      </section>

      <section property="bibo:hasPart" resource="#attestation-raw-data-types" typeof="bibo:Chapter" id="attestation-raw-data-types">
	<h3 resource="#h-attestation-raw-data-types" id="h-attestation-raw-data-types"><span property="xhv:role" resource="xhv:heading"><span class="secno">2.3 </span>Attestation Raw Data Types</span></h3>

	<p>
	  FIDO specifies pluggable attestation raw data types, i.e., 
	  ways to serialize the data being attested to by the authenticator.
	  The reason is to be able to support existing devices like TPMs and other
	  platform-specific formats.
	</p>
	<p>Each attestation type provides the ability to cryptographically attest to a public key, the
	  authenticator model, and contextual data to a remote party.
	</p>
	<p>Attestation raw data types are orthogonal to attestation models, i.e. 
	  attestation raw data types in general are not restricted to a single attestation model.
	</p>
	
      </section>
      
    </section>

    <section property="bibo:hasPart" resource="#attestation-statement" typeof="bibo:Chapter" id="attestation-statement">
      <!--OddPage--><h2 resource="#h-attestation-statement" id="h-attestation-statement"><span property="xhv:role" resource="xhv:heading"><span class="secno">3. </span>Attestation Statement</span></h2>
      <p>When an attestation statement is required for an Authenticator, the client
	needs to ask the Authenticator to generate one. This section describes the
	attestation statement data structures. Attestation statements
	can also include some host and other Authenticator information.
      </p>
      
      The attestation statement consists of
      <ol>
	<li>the <code>header</code> object, containing the signing algorithm and 
	  additional information required to verify the attestation signature.
	</li>
	<li>the <code>core</code> object, containing the attested data.  This object
	  is a container and can carry multiple, authenticator model specific, 
	  attestation rawData types (see section <a class="sec-ref" href="#defined-attestation-raw-data-types"><span class="secno">3.4</span> <span class="sec-title">Defined Attestation Raw Data Types</span></a>). 
	</li>
	<li>the <code>signature</code> object.  This object contains the cryptographic
	  signature computed over the <code>rawData</code> object.  
	  The structure of this object depends on the signature algorithm.
	</li>
      </ol>
      
      <section property="bibo:hasPart" resource="#client-encoding-of-attestation-statements" typeof="bibo:Chapter" id="client-encoding-of-attestation-statements">
	<h3 resource="#h-client-encoding-of-attestation-statements" id="h-client-encoding-of-attestation-statements"><span property="xhv:role" resource="xhv:heading"><span class="secno">3.1 </span>Client encoding of attestation statements</span></h3>

	<p>The client platform uses an authenticator generated 
	  attestation signature (<code>signature</code>) and the 
	  authenticator generated <code>rawData</code> object to construct
	  the final attestation statement object (which will be returned to the RP). 
	  This attestation statement is encoded as:
	</p>

	<pre class="idl"><span class="idlInterface" id="idl-def-AttestationStatement">interface <span class="idlInterfaceID">AttestationStatement</span> {
<span class="idlAttribute">    readonly    attribute <span class="idlAttrType"><a class="idlType" href="#idl-def-AttestationHeader"><code>AttestationHeader</code></a></span> <span class="idlAttrName"><a href="#widl-AttestationStatement-header">header</a></span>;</span>
<span class="idlAttribute">    readonly    attribute <span class="idlAttrType"><a class="idlType" href="#idl-def-AttestationCore"><code>AttestationCore</code></a></span>   <span class="idlAttrName"><a href="#widl-AttestationStatement-core">core</a></span>;</span>
<span class="idlAttribute">    readonly    attribute <span class="idlAttrType">DOMString</span>         <span class="idlAttrName"><a href="#widl-AttestationStatement-signature">signature</a></span>;</span>
};</span></pre><section property="bibo:hasPart" resource="#attributes" typeof="bibo:Chapter" id="attributes"><h4 resource="#h-attributes" id="h-attributes"><span property="xhv:role" resource="xhv:heading"><span class="secno">3.1.1 </span>Attributes</span></h4><dl class="attributes"><dt id="widl-AttestationStatement-core"><code>core</code> of type <span class="idlAttrType"><a class="idlType" href="#idl-def-AttestationCore"><code>AttestationCore</code></a></span>, readonly   </dt><dd>AttestationCore object.  This object includes the attested <code>rawData</code> and 
	    its <code>type</code> and <code>version</code>.</dd><dt id="widl-AttestationStatement-header"><code>header</code> of type <span class="idlAttrType"><a class="idlType" href="#idl-def-AttestationHeader"><code>AttestationHeader</code></a></span>, readonly   </dt><dd>Attestation header, including algorithm, (optionally) the claimed AAGUID 
	    and (optionally) the attestation certificate chain.
	  </dd><dt id="widl-AttestationStatement-signature"><code>signature</code> of type <span class="idlAttrType">DOMString</span>, readonly   </dt><dd>The base64url-encoded attestation signature.  The structure of this 
	    object depends on the signature algorithm specified in the header.
	  </dd></dl></section>
	
	<p>This attestation statement is delivered to the RP according to the Client API.
	  It contains all the information that the RP's FIDO server requires to
	  reconstruct the signature base string, as well as to decode and validate
	  the bindings of both the client- and authenticator data.
	</p>
      </section>

      <section property="bibo:hasPart" resource="#attestationcore" typeof="bibo:Chapter" id="attestationcore">
	<h3 resource="#h-attestationcore" id="h-attestationcore"><span property="xhv:role" resource="xhv:heading"><span class="secno">3.2 </span>AttestationCore</span></h3>
	Data attested by the Authenticator and description of its structure.
	Different types of Authenticators might generate different object types 
	(identified by <code>type</code> and <code>version</code>).

	<pre class="idl"><span class="idlInterface" id="idl-def-AttestationCore">interface <span class="idlInterfaceID">AttestationCore</span> {
<span class="idlAttribute">    readonly    attribute <span class="idlAttrType">DOMString</span>     <span class="idlAttrName"><a href="#widl-AttestationCore-type">type</a></span>;</span>
<span class="idlAttribute">    readonly    attribute <span class="idlAttrType">unsigned long</span> <span class="idlAttrName"><a href="#widl-AttestationCore-version">version</a></span>;</span>
<span class="idlAttribute">    readonly    attribute <span class="idlAttrType">DOMString</span>     <span class="idlAttrName"><a href="#widl-AttestationCore-rawData">rawData</a></span>;</span>
<span class="idlAttribute">    readonly    attribute <span class="idlAttrType">DOMString</span>     <span class="idlAttrName"><a href="#widl-AttestationCore-clientData">clientData</a></span>;</span>
};</span></pre><section property="bibo:hasPart" resource="#attributes-1" typeof="bibo:Chapter" id="attributes-1"><h4 resource="#h-attributes-1" id="h-attributes-1"><span property="xhv:role" resource="xhv:heading"><span class="secno">3.2.1 </span>Attributes</span></h4><dl class="attributes"><dt id="widl-AttestationCore-clientData"><code>clientData</code> of type <span class="idlAttrType">DOMString</span>, readonly   </dt><dd>
	    A base64url encoding of clientDataJSON [<cite><a href="#bib-FIDOSignatureFormat" class="bibref">FIDOSignatureFormat</a></cite>]. The
	    exact encoding must be preserved as the hash (clientDataHash) has been
	    computed over it.
	  </dd><dt id="widl-AttestationCore-rawData"><code>rawData</code> of type <span class="idlAttrType">DOMString</span>, readonly   </dt><dd>
	    The rawData object (for type "android"), or the base64url-encoded rawData
	    object (for types "tpm" and "packed"), containing the attested public key
	    and the <code>clientDataHash</code>.
	  </dd><dt id="widl-AttestationCore-type"><code>type</code> of type <span class="idlAttrType">DOMString</span>, readonly   </dt><dd>
	    The type of the rawData object. This specification defines these
	    attestation raw data types: "tpm", "packed", and "android". Other attestation
	    raw data types may be defined in further versions of this specification.
	  </dd><dt id="widl-AttestationCore-version"><code>version</code> of type <span class="idlAttrType">unsigned long</span>, readonly   </dt><dd>The version number of the rawData object.</dd></dl></section>

	<section property="bibo:hasPart" resource="#client-data" typeof="bibo:Chapter" id="client-data">
	  <h4 resource="#h-client-data" id="h-client-data"><span property="xhv:role" resource="xhv:heading"><span class="secno">3.2.2 </span>Client data</span></h4>	  
	  <p>
	    The client platform <em title="SHALL" class="rfc2119">SHALL</em> deliver, through the EAP API, the
	    <code>clientDataHash</code> (see [<cite><a href="#bib-FIDOSignatureFormat" class="bibref">FIDOSignatureFormat</a></cite>]) to the authenticator.  
	    The client platform <em title="MUST" class="rfc2119">MUST</em> also preserve the exact <code>encodedClientData</code> 
	    string (see [<cite><a href="#bib-FIDOSignatureFormat" class="bibref">FIDOSignatureFormat</a></cite>]), for embedding
	    in a signature object sent back to the RP. This is necessary since multiple
	    JSON encodings of the same client data are possible.
	  </p>
	</section>

      </section>

      <section property="bibo:hasPart" resource="#attestationheader" typeof="bibo:Chapter" id="attestationheader">
	<h3 resource="#h-attestationheader" id="h-attestationheader"><span property="xhv:role" resource="xhv:heading"><span class="secno">3.3 </span>AttestationHeader</span></h3>
	Additional data required to verify the attestation signature.  

	<pre class="idl"><span class="idlInterface" id="idl-def-AttestationHeader">interface <span class="idlInterfaceID">AttestationHeader</span> {
<span class="idlAttribute">    readonly    attribute <span class="idlAttrType">DOMString</span>   <span class="idlAttrName"><a href="#widl-AttestationHeader-claimedAAGUID">claimedAAGUID</a></span>;</span>
<span class="idlAttribute">    readonly    attribute <span class="idlAttrType">DOMString[]</span> <span class="idlAttrName"><a href="#widl-AttestationHeader-xc">x5c</a></span>;</span>
<span class="idlAttribute">    readonly    attribute <span class="idlAttrType">DOMString</span>   <span class="idlAttrName"><a href="#widl-AttestationHeader-alg">alg</a></span>;</span>
};</span></pre><section property="bibo:hasPart" resource="#attributes-2" typeof="bibo:Chapter" id="attributes-2"><h4 resource="#h-attributes-2" id="h-attributes-2"><span property="xhv:role" resource="xhv:heading"><span class="secno">3.3.1 </span>Attributes</span></h4><dl class="attributes"><dt id="widl-AttestationHeader-alg"><code>alg</code> of type <span class="idlAttrType">DOMString</span>, readonly   </dt><dd>The name of the algorithm used to generate the attestation signature according to [<cite><a href="#bib-RFC7518" class="bibref">RFC7518</a></cite>].  
	    <p>See section <a href="#attestationsignature"></a> for the signature algorithms 
	      to be implemented by FIDO Servers.</p>
	  </dd><dt id="widl-AttestationHeader-claimedAAGUID"><code>claimedAAGUID</code> of type <span class="idlAttrType">DOMString</span>, readonly   </dt><dd>The claimed Authenticator Attestation GUID (a version 4 GUID, see [<cite><a href="#bib-RFC4122" class="bibref">RFC4122</a></cite>]).  
	    This value is used by the FIDO Server to 
	    lookup the trust anchor for verifying this AttestationCore object.  
	    If the verification succeeds, 
	    the AAGUID related to the trust anchor is trusted.  This field <em title="MUST" class="rfc2119">MUST</em> be present, if either no
	    attestation certificates are used (e.g., DAA) or if the attestation 
	    certificate doesn't contain the AAGUID value in an extension.
	  </dd><dt id="widl-AttestationHeader-xc"><code>x5c</code> of type array of <span class="idlAttrType">DOMString</span>, readonly   </dt><dd>Attestation Certificate and its certificate chain as described
	    in [<cite><a href="#bib-RFC7515" class="bibref">RFC7515</a></cite>] section 4.1.6.</dd></dl></section>

      </section>

      <section property="bibo:hasPart" resource="#defined-attestation-raw-data-types" typeof="bibo:Chapter" id="defined-attestation-raw-data-types">
	<h3 resource="#h-defined-attestation-raw-data-types" id="h-defined-attestation-raw-data-types"><span property="xhv:role" resource="xhv:heading"><span class="secno">3.4 </span>Defined Attestation Raw Data Types</span></h3>
	
	<p>
	  Attestation Raw Data (<code>rawData</code>) is the to-be-signed object of
	  the attestation statement. FIDO supports pluggable attestation data types.
	  This allows support of TPM generated attestation data as well as support of
	  other FIDO authenticators.
	</p>
	<p>
	  The contents of the attestation data must be controlled (i.e., generated or
	  at least verified) by the authenticator itself.
	</p>
	<section property="bibo:hasPart" resource="#packed-attestation" typeof="bibo:Chapter" id="packed-attestation">
	  <h4 resource="#h-packed-attestation" id="h-packed-attestation"><span property="xhv:role" resource="xhv:heading"><span class="secno">3.4.1 </span>Packed Attestation</span></h4>
	  Packed attestation is a FIDO optimized format of attestation data.  It uses a very compact but 
	  still extensible encoding method.  Encoding this format can even be implemented by authenticators
	  with very limited resources (e.g., secure elements).

	  <section property="bibo:hasPart" resource="#attestation-rawdata-type-packed" typeof="bibo:Chapter" id="attestation-rawdata-type-packed">
	    <h5 resource="#h-attestation-rawdata-type-packed" id="h-attestation-rawdata-type-packed"><span property="xhv:role" resource="xhv:heading"><span class="secno">3.4.1.1 </span>Attestation rawData (type="packed")</span></h5>
	    
	    <p>The attestation data encodes contextual bindings made by the
	      authenticator itself. Unlike client data, the authenticator data has
	      a compact but extensible encoding. This is desired since authenticators can
	      be devices with limited capabilities and low power requirements, with much
	      simpler software stacks than the client platform components.</p>

	    <p>For this type, only version="1" is defined at this time.</p>

	    <p>The field <code>rawData</code> is the <b>base64url encoding of the byte array</b>.
	      The encoding of attestation data (for type "packed") is a byte array 
	      of 45 bytes + length of public key + length of KeyHandle + potentially more extensions. 
	      The first bytes before the extensions have a fixed layout as follows:</p>
	    <table class="simple">
	      <tbody><tr>
		<th>Length (in bytes)</th>
		<th>Description</th>
	      </tr>
	      <tr>
		<td>2</td>
		<td>0xF1D0, fixed big-endian TAG to make sure this object won't be 
		  confused with other (non-FIDO) binary objects.</td>
	      </tr>
	      <tr>
		<td>1</td>
		<td>Flags (bit 0 is the least significant bit):
		  <ul>
		    <li>Bit 0: Test of User Presence (<code>TUP</code>) result.</li>
		    <li>Bits 1-6: Reserved for future use (<code>RFU</code>).</li>
		    <li>Bit 7: Extension data included (<code>ED</code>). Indicates whether the
		      authenticator added extensions (see below).</li>
		  </ul>
		</td>
	      </tr>
	      <tr>
		<td>4</td>
		<td>Signature counter (<code>signCount</code>), 32-bit unsigned big-endian integer.</td>
	      </tr>
	      <tr>
		<td>2</td>
		<td>
		  Public key algorithm and encoding (16-bit big-endian value).
		  Allowed values are: 
		  <ol>
		    <li>0x0100. This is raw ANSI X9.62 formatted Elliptic Curve public key [<cite><a href="#bib-SEC1" class="bibref">SEC1</a></cite>].
		      <p>I.e., <code>[0x04, X (n bytes), Y (n bytes)]</code>.  Where the 
			byte <code>0x04</code> denotes the uncompressed point compression method 
			and n denotes the key length in bytes.</p>
		    </li>	  
		    <li>0x0102.  Raw encoded RSA PKCS1 or 
		      RSASSA-PSS public key [<cite><a href="#bib-RFC3447" class="bibref">RFC3447</a></cite>].
		      <p>In the case of RSASSA-PSS, the default parameters according 
			to [<cite><a href="#bib-RFC4055" class="bibref">RFC4055</a></cite>] <em title="MUST" class="rfc2119">MUST</em> be assumed, i.e.,
			</p><ul>
			  <li>Mask Generation Algorithm MGF1 with SHA256</li>
			  <li>Salt Length of 32 bytes, i.e., the length of a SHA256 hash value.</li>
			  <li>Trailer Field value of 1, which represents the trailer field with 
			    hexadecimal value <code>0xBC</code>.
			</li></ul>
		      <p></p>
		      <p>That is, <code>[modulus (256 bytes), e (m-n bytes)]</code>.  
			Where <code>m</code> is the total length of the field.</p>
		      <p>This total length should be taken from the object containing this key</p>
		    </li>
		  </ol>
		</td>
	      </tr>
	      <tr>
		<td>2</td>
		<td>Byte length m of following public key bytes (16 bit value 
		  with most significant byte first).
		</td>
	      </tr>
	      <tr>
		<td>(length)</td>
		<td>The public key (m bytes) according to the encoding denoted before.</td>
	      </tr>
	      <tr>
		<td>2</td>
		<td>Byte length l of KeyHandle
		</td>
	      </tr>
	      <tr>
		<td>(length)</td>
		<td>KeyHandle (l bytes)</td>
	      </tr>
	      <tr>
		<td>2</td>
		<td>Byte length n of clientDataHash
		</td>
	      </tr>
	      <tr>
		<td>n</td>
		<td>clientDataHash (see section <a class="sec-ref" href="#client-data"><span class="secno">3.2.2</span> <span class="sec-title">Client data</span></a>).  
		  This is the hash of <code>clientData</code>.  The hash algorithm itself is stored
		  in the <code>clientData</code> object [<cite><a href="#bib-FIDOSignatureFormat" class="bibref">FIDOSignatureFormat</a></cite>].
		</td>
	      </tr>
	      <tr>
		<td>As defined by the extension map</td>
		<td>Extension-defined authenticator data. This is a CBOR [RFC7049] map with 
		  extension identifiers as keys, and extension authenticator data values as values. 
		  See [<cite><a href="#bib-FIDOSignatureFormat" class="bibref">FIDOSignatureFormat</a></cite>], section "Signature extensions" for a description 
		  of the extension mechanism.
		  See section <a class="sec-ref" href="#extensions-for-packed-attestation-rawdata"><span class="secno">3.4.1.2</span> <span class="sec-title">Extensions for Packed Attestation rawData</span></a> 
		  for pre-defined extensions.
		</td>
	      </tr>
	    </tbody></table>
	    
	    <p>The <code>TUP</code> flag <em title="SHALL" class="rfc2119">SHALL</em> be set if and only if the authenticator
	      detected a user through an authenticator-specific gesture. The <code>RFU</code>
	      bits in the flags byte <em title="SHALL" class="rfc2119">SHALL</em> be cleared (i.e., zeroed).</p>
	    
	    <p>If the authenticator does not wish to add extensions, it <em title="MUST" class="rfc2119">MUST</em> clear
	      the <code>ED</code> flag in the third byte.</p>
	    
	  </section>

	  <section property="bibo:hasPart" resource="#extensions-for-packed-attestation-rawdata" typeof="bibo:Chapter" id="extensions-for-packed-attestation-rawdata">
	    <h5 resource="#h-extensions-for-packed-attestation-rawdata" id="h-extensions-for-packed-attestation-rawdata"><span property="xhv:role" resource="xhv:heading"><span class="secno">3.4.1.2 </span>Extensions for Packed Attestation rawData</span></h5>

	    <section property="bibo:hasPart" resource="#aaguid-extension" typeof="bibo:Chapter" id="aaguid-extension">
	      <h6 resource="#h-aaguid-extension" id="h-aaguid-extension"><span property="xhv:role" resource="xhv:heading"><span class="secno">3.4.1.2.1 </span>AAGUID Extension</span></h6>
	      <dl>
		<dt>Extension identifier</dt>
		<dd><code>fido.aaguid</code></dd>
		
		<dt>Client argument</dt>
		<dd>N/A</dd>
		
		<dt>Client processing</dt>
		<dd>N/A</dd>
		
		<dt>Authenticator argument</dt>
		<dd>N/A</dd>
		
		<dt>Authenticator processing</dt>
		<dd>This extension is added automatically by the authenticator.  This extension can be added
		  to attestation statements and signatures.
		</dd>
		
		<dt>Authenticator data</dt>
		<dd>A 128-bit Authenticator Attestation GUID encoded as a CBOR text string (major type 3).
		  
		  <p>This AAGUID is used to identify the Authenticator model (Authenticator Attestation GUID).</p>
		    <div class="note"><div id="h-note3" role="heading" aria-level="7" class="note-title"><span>Note</span></div><div class="">
		      <p>The authenticator model (identified by the AAGUID) can be derived from 
			(a) here, or  
			(b) from the attestation certificate (if we have an authenticator specific
			or authenticator model specific attestation certificate), 
			or (c) or from the claimed AAGUID in the client 
			encoded attestation statement (if we have one attestation root certificate 
			per authenticator model).
		      </p>
		      <p>In the case of DAA there is no need for an X.509 
			attestation certificate hierarchy. 
			Instead the trust anchor being known to the RP is 
			the DAA root key (i.e. ECPoint2 X, Y).  This root key must be dedicated
			to a single authenticator model.
		      </p>
		    </div></div>
		</dd>
	      </dl>
	    </section>

	    <section property="bibo:hasPart" resource="#supportedextensions-extension" typeof="bibo:Chapter" id="supportedextensions-extension">
	      <h6 resource="#h-supportedextensions-extension" id="h-supportedextensions-extension"><span property="xhv:role" resource="xhv:heading"><span class="secno">3.4.1.2.2 </span>SupportedExtensions Extension</span></h6>
	      <dl>
		<dt>Extension identifier</dt>
		<dd><code>fido.exts</code></dd>		
		<dt>Client argument</dt>
		<dd>N/A</dd>
		
		<dt>Client processing</dt>
		<dd>N/A</dd>
		
		<dt>Authenticator argument</dt>
		<dd>N/A</dd>
		
		<dt>Authenticator processing</dt>
		<dd>This extension is added automatically by the authenticator.  This extension can be added
		  to attestation statements.
		</dd>
		<dt>Authenticator data</dt>
		<dd>The SupportedExtension extension is a list (CBOR array) of extension identifiers 
		  encoded as UTF-8 Strings.
		</dd>		
	      </dl>
	    </section>

	    <section property="bibo:hasPart" resource="#user-verification-index-uvi-extension" typeof="bibo:Chapter" id="user-verification-index-uvi-extension">
	      <h6 resource="#h-user-verification-index-uvi-extension" id="h-user-verification-index-uvi-extension"><span property="xhv:role" resource="xhv:heading"><span class="secno">3.4.1.2.3 </span>User Verification Index (UVI) Extension</span></h6>
	      <dl>
		<dt>Extension identifier</dt>
		<dd><code>fido.uvi</code></dd>
		
		<dt>Client argument</dt>
		<dd>N/A</dd>
		
		<dt>Client processing</dt>
		<dd>N/A</dd>
		
		<dt>Authenticator argument</dt>
		<dd>N/A</dd>
		
		<dt>Authenticator processing</dt>
		<dd>This extension is added automatically by the authenticator.  This extension can be added
		  to attestation statements and signatures.
		</dd>
		
		<dt>Authenticator data</dt>
		<dd>The user verification index (UVI) is a value uniquely identifying 
		  a user verification data record.  The UVI is encoded as CBOR byte string (type 0x58). 
		    <p>Each UVI value <em title="MUST" class="rfc2119">MUST</em> be specific to the related key (in order to provide unlinkability).  
		      It also must contain sufficient entropy that makes guessing impractical.  
		      UVI values <em title="MUST NOT" class="rfc2119">MUST NOT</em> be reused by the Authenticator (for other biometric data or users).
		    </p>
		    <p>The UVI data can be used by FIDO Servers to understand whether an authentication
		      was authorized by the exact same biometric data as the initial key generation.
		      This allows the detection and prevention of "friendly fraud".
		    </p>
		    <p>As an example, the UVI could be computed as SHA256(KeyID | SHA256(rawUVI)),
		      where the rawUVI reflects (a) the biometric reference data, 
		      (b) the related OS level user ID and (c) an identifier which changes whenever a
		      factory reset is performed for the device, e.g. 
		      rawUVI = biometricReferenceData | OSLevelUserID | FactoryResetCounter.
		    </p>
		    <p>FIDO Servers supporting UVI extensions <em title="MUST" class="rfc2119">MUST</em> support a length of up to 32 bytes
		      for the UVI value.
		    </p>
		    <p>Example for rawData containing one UVI extension</p>
  <pre>  F1 D0                         -- This is a FIDO packed rawData object
  81                            -- TUP and ED set
  00 00 00 01                   -- (initial) signature counter
  ...                           -- all public key alg etc.
  A1                            -- extension: CBOR map of one element
    68                          -- Key 1: CBOR text string of 8 bytes
      66 69 64 6F 2E 75 76 69   -- "fido.uvi" UTF-8 string
    58 20                       -- Value 1: CBOR byte string with 0x20 bytes
    00 43 B8 E3 BE 27 95 8C     -- the UVI value itself
    28 D5 74 BF 46 8A 85 CF 
    46 9A 14 F0 E5 16 69 31 
    DA 4B CF FF C1 BB 11 32 
    82
  </pre>

		</dd>
	      </dl>
	    </section>
	  </section>
	  <section property="bibo:hasPart" resource="#signature" typeof="bibo:Chapter" id="signature">
	    <h5 resource="#h-signature" id="h-signature"><span property="xhv:role" resource="xhv:heading"><span class="secno">3.4.1.3 </span>Signature</span></h5>

	    <p>The <code>signature</code> is computed over the base64url-decoded <code>rawData</code> field.</p>
	    The following 
	    algorithms must be implemented by FIDO Servers: 
	    <ol>
	      <li>"ES256" [<cite><a href="#bib-RFC7518" class="bibref">RFC7518</a></cite>]</li>
	      <li>"RS256" [<cite><a href="#bib-RFC7518" class="bibref">RFC7518</a></cite>]</li>
	      <li>"PS256" [<cite><a href="#bib-RFC7518" class="bibref">RFC7518</a></cite>]</li>
	      <li>"ED256" [<cite><a href="#bib-FIDOEcdaaAlgorithm" class="bibref">FIDOEcdaaAlgorithm</a></cite>]</li>  
	    </ol>
	    Authenticators can choose which algorithm to implement.
	  </section>
	  <section property="bibo:hasPart" resource="#attestation-statement-certificate-requirements" typeof="bibo:Chapter" id="attestation-statement-certificate-requirements">
	    <h5 resource="#h-attestation-statement-certificate-requirements" id="h-attestation-statement-certificate-requirements"><span property="xhv:role" resource="xhv:heading"><span class="secno">3.4.1.4 </span>Attestation statement certificate requirements</span></h5>
	    <div class="note"><div id="h-note4" role="heading" aria-level="6" class="note-title"><span>Note</span></div><p class="">In the case of DAA attestation 
	      [<cite><a href="#bib-FIDOEcdaaAlgorithm" class="bibref">FIDOEcdaaAlgorithm</a></cite>] no attestation certificate is used.
	    </p></div>

	    <p>The attestation certificate <em title="MUST" class="rfc2119">MUST</em> have the following
	      fields/extensions:
	    </p>
	    <ul>
	      <li>Version must be set to 3.</li>
	      <li>Subject field <em title="MUST" class="rfc2119">MUST</em> be set to:
		<dl>
		  <dt>Subject-C</dt>
		  <dd>Country where the Authenticator vendor is incorporated</dd>
		  <dt>Subject-O</dt>
		  <dd>Legal name of the Authenticator vendor</dd>
		  <dt>Subject-OU</dt>
		  <dd>Authenticator Attestation</dd>
		  <dt>Subject-CN</dt>
		  <dd>No stipulation.</dd>
		</dl>
	      </li>
	      <li>If the related attestation root certificate is used for multiple authenticator 
		models, the following extension <em title="MUST" class="rfc2119">MUST</em> be present:
		<p>Extension OID <code>1 3 6 1 4 1 45724 1 1 4</code>
		(id-fido-gen-ce-aaguid) containing the AAGUID as value.
		</p>
	      </li>
	      <li>The Basic Constraints extension <em title="MUST" class="rfc2119">MUST</em> have the cA component set
		to false
	      </li>
	      <li>An Authority Information Access (AIA) extension with entry <code>id-ad-ocsp</code> and 
		a CRL Distribution Point extension [<cite><a href="#bib-RFC5280" class="bibref">RFC5280</a></cite>] are both optional as the status of attestation certificates is
		available through the FIDO Metadata Service [<cite><a href="#bib-FIDOMetadataService" class="bibref">FIDOMetadataService</a></cite>].
	      </li>
	    </ul>
	  </section>

	</section>


	<section property="bibo:hasPart" resource="#tpm-attestation" typeof="bibo:Chapter" id="tpm-attestation">
	  <h4 resource="#h-tpm-attestation" id="h-tpm-attestation"><span property="xhv:role" resource="xhv:heading"><span class="secno">3.4.2 </span>TPM Attestation</span></h4>
	  
	  <section property="bibo:hasPart" resource="#attestation-rawdata-type-tpm" typeof="bibo:Chapter" id="attestation-rawdata-type-tpm">
	    <h5 resource="#h-attestation-rawdata-type-tpm" id="h-attestation-rawdata-type-tpm"><span property="xhv:role" resource="xhv:heading"><span class="secno">3.4.2.1 </span>Attestation rawData (type="tpm")</span></h5>
	    
	    <p>
              The value of <code>rawData</code> is the <b>base64url encoding of a binary object</b>.
	      This binary object is either a
              TPM_CERTIFY_INFO or a TPM_CERTIFY_INFO2 structure [<cite><a href="#bib-TPMv1-2-Part2" class="bibref">TPMv1-2-Part2</a></cite>]
              sections 11.1 and 11.2, if
              <code>attestationStatement.core.version</code> equals 1. Else, if
              <code>attestationStatement.core.version</code> equals 2, it <em title="MUST" class="rfc2119">MUST</em> be
              the base64url encoding of a TPMS_ATTEST structure as defined in
              [<cite><a href="#bib-TPMv2-Part2" class="bibref">TPMv2-Part2</a></cite>] sections 10.12.9.
	    </p>
	    <p>
	      The field "extraData" (in the case of TPMS_ATTEST) or the field "data" 
	      (in the case of TPM_CERTIFY_INFO or TPM_CERTIFY_INFO2) <em title="MUST" class="rfc2119">MUST</em> contain 
	      the <code>clientDataHash</code> (see [<cite><a href="#bib-FIDOSignatureFormat" class="bibref">FIDOSignatureFormat</a></cite>]).
	    </p>

	  </section>
	  <section property="bibo:hasPart" resource="#signature-1" typeof="bibo:Chapter" id="signature-1">
	    <h5 resource="#h-signature-1" id="h-signature-1"><span property="xhv:role" resource="xhv:heading"><span class="secno">3.4.2.2 </span>Signature</span></h5>
	    
	    <p>
              If <code>attestationStatement.core.version</code> equals 1, (i.e., for
              TPM 1.2), RSASSA-PKCS1-v1_5 signature algorithm (section 8.2 of
              [<cite><a href="#bib-RFC3447" class="bibref">RFC3447</a></cite>]) can be used by FIDO Authenticators (i.e.
              <code>attestationStatement.header.alg</code>="RS256").
	    </p>
	    <p>
              If <code>attestationStatement.core.version</code> equals 2, the
              following algorithms can be used by FIDO Authenticators:
	    </p>
	    <ol>
	      <li>TPM_ALG_RSASSA (0x14).  This is the same algorithm RSASSA-PKCS1-v1_5 
		as for version 1 but for use with TPMv2. <code>attestationStatement.header.alg</code>="RS256".</li>
	      <li>TPM_ALG_RSAPSS (0x16); <code>attestationStatement.header.alg</code>="PS256".</li>
	      <li>TPM_ALG_ECDSA (0x18); <code>attestationStatement.header.alg</code>="ES256".</li>
	      <li>TPM_ALG_ECDAA (0x1A); <code>attestationStatement.header.alg</code>="ED256".</li>
	      <li>TPM_ALG_SM2 (0x1B); <code>attestationStatement.header.alg</code>="SM256".</li>
	    </ol>
	      
	    <p>The <code>signature</code> is computed over the base64url-decoded <code>rawData</code> field</p>
	    <p>See section <a href="#attestationsignature"></a> for the signature algorithms 
	      to be implemented by FIDO Servers.
	    </p>
	  </section>

	  <section property="bibo:hasPart" resource="#tpm-attestation-statement-certificate-requirements" typeof="bibo:Chapter" id="tpm-attestation-statement-certificate-requirements">
	    <h5 resource="#h-tpm-attestation-statement-certificate-requirements" id="h-tpm-attestation-statement-certificate-requirements"><span property="xhv:role" resource="xhv:heading"><span class="secno">3.4.2.3 </span>TPM attestation statement certificate requirements</span></h5>
	    
	    <p>TPM attestation certificate <em title="MUST" class="rfc2119">MUST</em> have the following
	      fields/extensions:
	    </p>
	    <ul>
	      <li>Version must be set to 3.</li>
	      <li>Subject field <em title="MUST" class="rfc2119">MUST</em> be set to empty.</li>
	      <li>The Subject Alternative Name extension must be set as defined in
		[<cite><a href="#bib-TPMv2-EK-Profile" class="bibref">TPMv2-EK-Profile</a></cite>] section 3.2.9 if "version" equals 2 and
		[<cite><a href="#bib-TPMv1-2-Credential-Profiles" class="bibref">TPMv1-2-Credential-Profiles</a></cite>] section 3.2.9 if "version" equals 1.
	      </li>
	      <li>The Extended Key Usage extension <em title="MUST" class="rfc2119">MUST</em> contain the
		"joint-iso-itu-t(2) internationalorganizations(23) 133
		tcg-kp(8) tcg-kp-AIKCertificate(3)" OID.
	      </li>
	      <li>The Basic Constraints extension <em title="MUST" class="rfc2119">MUST</em> have the CA component set
		to false
	      </li>
	      <li>An Authority Information Access (AIA) extension with entry <code>id-ad-ocsp</code> and 
		a CRL Distribution Point extension [<cite><a href="#bib-RFC5280" class="bibref">RFC5280</a></cite>] are both optional as the status of attestation certificates is
		available through the FIDO Metadata Service [<cite><a href="#bib-FIDOMetadataService" class="bibref">FIDOMetadataService</a></cite>].
	      </li>
	    </ul>
	  </section>
	</section>

      <section property="bibo:hasPart" resource="#android-attestation" typeof="bibo:Chapter" id="android-attestation">
        <h4 resource="#h-android-attestation" id="h-android-attestation"><span property="xhv:role" resource="xhv:heading"><span class="secno">3.4.3 </span>Android Attestation</span></h4>
        <p>
          When the Authenticator in question is a platform-provided
          Authenticator on the Android platform, the attestation statement is
          based on the <a href="https://developer.android.com/training/safetynet/index.html#compat-check-response">
	    SafetyNet API</a>.
        </p>
	
	<p>Android attestation statement <em title="MUST" class="rfc2119">MUST</em> always be used in conjunction with the more 
	  specific <code>AndroidAttestationClientData</code> (see section <a class="sec-ref" href="#androidattestationclientdata"><span class="secno">3.4.3.4</span> <span class="sec-title">AndroidAttestationClientData</span></a>)
	  in order to let the RP App store the public key in the attestation object.
	</p>

	<section property="bibo:hasPart" resource="#attestation-rawdata-type-android" typeof="bibo:Chapter" id="attestation-rawdata-type-android">
	  <h5 resource="#h-attestation-rawdata-type-android" id="h-attestation-rawdata-type-android"><span property="xhv:role" resource="xhv:heading"><span class="secno">3.4.3.1 </span>Attestation rawData (type="android")</span></h5>
	  <p>
	    Android SafetyNet returns a JWS [<cite><a href="#bib-RFC7515" class="bibref">RFC7515</a></cite>] object (see 
	    <a href="https://developer.android.com/training/safetynet/index.html#compat-check-response">
	      SafetyNet online documentation</a>) in Compact
	    Serialization. A JWS in Compact Serialization consists of three segments
	    (each a base64url-encoded string) separated by a dot ("."). The
	    <code>rawData</code> object is the concatenation of:    
	  </p>
	  <ol>
	    <li>the first segment (a base64url encoding of the UTF-8 encoded JWS Protected Header)</li>
	    <li>a dot "."</li>
	    <li>the second segment (a base64url encoding of the UTF-8 encoded JWS Payload).</li>
	  </ol>
	  <p>
	    In contrast to the "packed" and "tpm" attestation types, for the
	    "android" attestation type, the <code>rawData</code> field and the
	    <code>rawData</code> object are the same string. (In the "packed" and
	    "tpm" attestation types the <code>rawData</code> field is the
	    base64url-encoding of the <code>rawData</code> object.)
	  </p>
	</section>	  

	<section property="bibo:hasPart" resource="#signature-2" typeof="bibo:Chapter" id="signature-2">
	  <h5 resource="#h-signature-2" id="h-signature-2"><span property="xhv:role" resource="xhv:heading"><span class="secno">3.4.3.2 </span>Signature</span></h5>
	  <p>
	    The signature is directly computed over the <code>rawData</code> field, as
	    defined above (see [<cite><a href="#bib-RFC7515" class="bibref">RFC7515</a></cite>] for more details). The third segment of the
	    JWS returned by SafetyNet is the base64url encoding of this signature,
	    and also becomes the <code>AttestationStatement.signature</code>.
	  </p>
	</section>

	<section property="bibo:hasPart" resource="#converting-safetynet-response-to-attestationstatement" typeof="bibo:Chapter" id="converting-safetynet-response-to-attestationstatement">
	  <h5 resource="#h-converting-safetynet-response-to-attestationstatement" id="h-converting-safetynet-response-to-attestationstatement"><span property="xhv:role" resource="xhv:heading"><span class="secno">3.4.3.3 </span>Converting SafetyNet response to attestationStatement</span></h5>
	  <p>
	    The Authenticator and/or platform <em title="SHOULD" class="rfc2119">SHOULD</em> use the steps outlined below to
	    create an attestationStatement from an Android SafetyNet response. It <em title="MAY" class="rfc2119">MAY</em>
	    use a different algorithm, as long as the results are the same.
	  </p>
	  <ol>
	    <li>create clientDataJSON with type AndroidAttestationClientData (see below) and 
	      compute clientData as base64url-encoded clientDataJSON.</li>
	    <li>provide the clientDataHash computed as the hash value of clientData 
	      as Nonce value when requesting the SafetyNet attestation.</li>
	    <li>take SafetyNet response <dfn id="dfn-snr" data-dfn-type="dfn">snr</dfn>.  This is a JWS object ([<cite><a href="#bib-RFC7515" class="bibref">RFC7515</a></cite>]).</li>
	    <li>extract the base64url-encoded Protected Header <dfn id="dfn-hdr" data-dfn-type="dfn">hdr</dfn> from <var>snr</var> (see [<cite><a href="#bib-RFC7515" class="bibref">RFC7515</a></cite>])</li>
	    <li>extract the base64url-encoded payload <dfn id="dfn-p" data-dfn-type="dfn">p</dfn> from <var>snr</var></li>
	    <li>extract the base64url-encoded signature <dfn id="dfn-s" data-dfn-type="dfn">s</dfn> from <var>snr</var></li>
	    <li>set <code>AttestationStatement.core.rawData</code> = <var>hdr</var> | "." | <var>p</var></li>
	    <li>set <code>AttestationStatement.signature</code> = <var>s</var></li>
	    <li>base64url-decode <var>hdr</var> into <dfn id="dfn-hdr-d" data-dfn-type="dfn">hdr-d</dfn></li>
	    <li>set <code>AttestationStatement.header.alg</code> = <var>hdr-d</var>.alg</li>
	    <li>if <var>hdr-d</var>.x5c is present, then set 
	      <code>AttestationStatement.header.x5c</code> = <var>hdr-d</var>.x5c</li>
	    <li>
	      if <var>hdr-d</var>.x5u is present, then resolve the URL and add the 
	      retrieved certificate chain to <code>AttestationStatement.header.x5c</code>
	    </li>
	    <li>set <code>AttestationStatement.core.type</code> = "android"</li>
	    <li>set <code>AttestationStatement.core.version</code> to the 
	      version number of Google Play Services responsible for providing the SafetyNet API</li>
	  </ol>	    
	</section>
	  
	<section property="bibo:hasPart" resource="#androidattestationclientdata" typeof="bibo:Chapter" id="androidattestationclientdata">
	  <h5 resource="#h-androidattestationclientdata" id="h-androidattestationclientdata"><span property="xhv:role" resource="xhv:heading"><span class="secno">3.4.3.4 </span>AndroidAttestationClientData</span></h5>
          <p>
            The ClientData dictionary is extended in the following way:
          </p>
	  <pre class="idl"><span class="idlDictionary" id="idl-def-AndroidAttestationClientData">dictionary <span class="idlDictionaryID">AndroidAttestationClientData</span> : <span class="idlSuperclass">ClientData</span> {
<span class="idlMember">             <span class="idlMemberType">JsonWebKey</span>             <span class="idlMemberName"><a href="#widl-AndroidAttestationClientData-publicKey">publicKey</a></span>;</span>
<span class="idlMember">             <span class="idlMemberType">boolean</span>                <span class="idlMemberName"><a href="#widl-AndroidAttestationClientData-isInsideSecureHardware">isInsideSecureHardware</a></span>;</span>
<span class="idlMember">             <span class="idlMemberType">DOMString</span>              <span class="idlMemberName"><a href="#widl-AndroidAttestationClientData-userAuthentication">userAuthentication</a></span>;</span>
<span class="idlMember">             <span class="idlMemberType">optional unsigned long</span> <span class="idlMemberName"><a href="#widl-AndroidAttestationClientData-userAuthenticationValidityDurationSeconds">userAuthenticationValidityDurationSeconds</a></span>;</span>
};</span></pre><section property="bibo:hasPart" resource="#dictionary-androidattestationclientdata-members" typeof="bibo:Chapter" id="dictionary-androidattestationclientdata-members"><h6 resource="#h-dictionary-androidattestationclientdata-members" id="h-dictionary-androidattestationclientdata-members"><span property="xhv:role" resource="xhv:heading"><span class="secno">3.4.3.4.1 </span>Dictionary <a href="#idl-def-AndroidAttestationClientData" class="idlType"><code>AndroidAttestationClientData</code></a> Members</span></h6><dl class="dictionary-members"><dt id="widl-AndroidAttestationClientData-isInsideSecureHardware"><code>isInsideSecureHardware</code> of type <span class="idlMemberType">boolean</span></dt><dd>
              <code>true</code> if the key resides inside secure hardware (e.g.,
              Trusted Execution Environment (TEE) or Secure Element (SE)).
            </dd><dt id="widl-AndroidAttestationClientData-publicKey"><code>publicKey</code> of type <span class="idlMemberType">JsonWebKey</span></dt><dd>
              The public key generated by the Authenticator, as a JsonWebKey object (see [<cite><a href="#bib-WebCryptoAPI" class="bibref">WebCryptoAPI</a></cite>]).
            </dd><dt id="widl-AndroidAttestationClientData-userAuthentication"><code>userAuthentication</code> of type <span class="idlMemberType">DOMString</span></dt><dd>
              One of "none", "keyguard", or "fingerprint". <em>none</em> means
              that the user has not enrolled a fingerprint, or set up a secure
              lock screen, and that therefore the key has not been linked to user
              authentication. <em>keyguard</em> means that the generated key only
              be used after the user unlocks a secure lock screen.
              <em>fingerprint</em> means that each operation involving the
              generated key must be individually authorized by the user by
              presenting a fingerprint.
            </dd><dt id="widl-AndroidAttestationClientData-userAuthenticationValidityDurationSeconds"><code>userAuthenticationValidityDurationSeconds</code> of type <span class="idlMemberType">optional unsigned long</span></dt><dd>
              If the <code>userAuthentication</code> is set to "keyguard", then
              this parameter specifies the duration of time (seconds) for which
              this key is authorized to be used after the user is successfully
              authenticated.
            </dd></dl></section>
          
	  <section property="bibo:hasPart" resource="#verifying-androidclientdata-specific-contextual-bindings" typeof="bibo:Chapter" id="verifying-androidclientdata-specific-contextual-bindings">
	    <h6 resource="#h-verifying-androidclientdata-specific-contextual-bindings" id="h-verifying-androidclientdata-specific-contextual-bindings"><span property="xhv:role" resource="xhv:heading"><span class="secno">3.4.3.4.2 </span>Verifying AndroidClientData specific contextual bindings</span></h6>

	    <p>
              A relying party shall verify the clientData contextual bindings (see step 4 
	      in <a class="sec-ref" href="#verifying-an-attestation-statement"><span class="secno">3.5</span> <span class="sec-title">Verifying an Attestation Statement</span></a> as follows:
	    </p>
	    <ul>
              <li>
		Check that <code>AndroidAttestationClientData.challenge</code> equals the
		attestationChallenge that was passed into the
		<code>makeCredential</code> call [<cite><a href="#bib-FIDOWebApi" class="bibref">FIDOWebApi</a></cite>].
              </li>
              <li>
		Check that the <code>facet</code> and <code>tokenBinding</code>
		parameters in the <code>AndroidAttestationClientData</code> match the
		RP App.
              </li>
              <li>
		Check that <code>AndroidAttestationClientData.publicKey</code> is the same key as the one
		returned in the <code>FIDOCredentialInfo</code> by the
		<code>makeCredential</code> call.
              </li>
              <li>
		Check that the hash of the clientDataJSON matches the
		<code>nonce</code> attribute in the payload of the
		<code>safetynetResponse</code> JWS.
              </li>
              <li>
		Check that the <code>ctsProfileMatch</code> attribute in the payload
		of the <code>safetynetResponse</code> is true.
              </li>
              <li>
		Check that the <code>apkPackageName</code> attribute in the payload of the
		<code>safetynetResponse</code> matches package name of the application calling 
		SafetyNet API.
              </li>
              <li>
		Check that the <code>apkDigestSha256</code> attribute in the
		payload of the <code>safetynetResponse</code> matches the package hash 
		of the application calling SafetyNet API.
              </li>        
              <li>
		Check that the <code>apkCertificateDigestSha256</code> attribute in the
		payload of the <code>safetynetResponse</code> matches the hash of the signing certificate 
		of the application calling SafetyNet API.
              </li>        
	    </ul>      
	  </section>  
	</section>
      </section>
      
      </section>

      <section property="bibo:hasPart" resource="#verifying-an-attestation-statement" typeof="bibo:Chapter" id="verifying-an-attestation-statement">
	<h3 resource="#h-verifying-an-attestation-statement" id="h-verifying-an-attestation-statement"><span property="xhv:role" resource="xhv:heading"><span class="secno">3.5 </span>Verifying an Attestation Statement</span></h3>
	<p>This section outlines the recommended algorithm for verifying an
	  attestation statement, independent of attestation type.
	</p>
	<p>Upon receiving an attestation statement, the relying party
	  shall:
	</p>
	<ol>
	  <li>Verify that the attestation statement is properly formatted</li>
	  <li>If <code>attestationSignature.alg</code> is not ECDAA (e.g., not "ED256" and not "ED512"): 
	    <ol>
	      <li>Lookup the attestation root certificate from a trusted source.  
		The FIDO Metadata Service [<cite><a href="#bib-FIDOMetadataService" class="bibref">FIDOMetadataService</a></cite>]
		provides an easy way to access such information.
		The <code>header.claimedAAGUID</code>
		can be used for this lookup.
	      </li>
	      <li>Verify that 
		the attestation certificate chain is valid and
		chains up to a trusted root (following [<cite><a href="#bib-RFC5280" class="bibref">RFC5280</a></cite>]).
	      </li>
	      <li>Verify that the attestation certificate has the right Extended Key Usage (EKU) based
		on the FIDO Authenticator type (as denoted by the <code>header.type</code> member). In case of a
		type="tpm", this EKU shall be OID "2.23.133.8.3".
	      </li>
	      <li>If the attestation type is "android", verify that the attestation certificate is issued 
	          to the hostname "attest.android.com" (see 
		<a href="https://developer.android.com/training/safetynet/index.html#compat-check-response">
	          SafetyNet online documentation</a>).
	      </li>
	      <li>Verify that all issuing CA certificates in the chain are valid
		and not revoked.
	      </li>
	      <li>
		Verify the <code>signature</code> on <code>core.rawData</code> using the
		attestation certificate public key and algorithm as identified by <code>header.alg</code>.
	      </li>
	      <li>
		Verify <code>core.rawData</code> syntax and that it doesn't contradict the signing 
		algorithm specified in <code>header.alg</code>.
	      </li>
	      <li>If the attestation certificate contains an extension with 
		OID <code>1 3 6 1 4 1 45724 1 1 4</code>
		(id-fido-gen-ce-aaguid) verify that the value of this extension matches 
		<code>header.claimedAAGUID</code>.  This identifies the Authenticator model.
	      </li>
	      <li>If such extension doesn't exist, 
		the attestation root certificate is dedicated to a single Authenticator model.
	      </li>
	    </ol>
	  </li>
	  <li>If <code>attestationSignature.alg</code> is ECDAA (e.g., "ED256", "ED512"):
	    <ol>
	      <li>Lookup the DAA 
		root key from a trusted source.  The FIDO Metadata Service [<cite><a href="#bib-FIDOMetadataService" class="bibref">FIDOMetadataService</a></cite>]
		provides an easy way to access such information.
		The <code>header.claimedAAGUID</code>
		can be used for this lookup.	    
	      </li>
	      <li>Perform DAA-Verify on <code>signature</code> 
		for <code>core.rawData</code> (see [<cite><a href="#bib-FIDOEcdaaAlgorithm" class="bibref">FIDOEcdaaAlgorithm</a></cite>]).</li>
	      <li>
		Verify <code>core.rawData</code> syntax and that it doesn't contradict the signing 
		algorithm specified in <code>header.alg</code>.
	      </li>
	      <li>The DAA root key is dedicated to a single Authenticator model.</li>
	    </ol>
	  </li>
	  <li>Verify the contextual bindings (e.g., channel binding) from the 
	    clientData (see Section <a class="sec-ref" href="#client-data"><span class="secno">3.2.2</span> <span class="sec-title">Client data</span></a>).
	  </li>
	  <li>
	    Verify that user verification method and other authenticator characteristics 
	    related to this authenticator model, match the relying party policy.
	    The FIDO Metadata Service [<cite><a href="#bib-FIDOMetadataService" class="bibref">FIDOMetadataService</a></cite>]
	    provides an easy way to access the authenticator characteristics.
	  </li>
	</ol>

	The relying party <em title="MAY" class="rfc2119">MAY</em> take any of the below actions when
	verification of an attestation statement fails:
	<ul>
	  <li>
	    Reject the request, such as a registration request, associated
	    with the attestation statement.
	  </li>
	  <li>
	    Accept the request associated with the attestation statement but
	    treat the attested FIDO Credential as one with surrogate basic 
	    attestation (see <a class="sec-ref" href="#attestation-models"><span class="secno">2.1</span> <span class="sec-title">Attestation Models</span></a>), if policy allows it.
	    If doing so, there is no cryptographic proof that the FIDO Credential 
	    has been generated by a particular Authenticator model.  
	    See [<cite><a href="#bib-FIDOSecRef" class="bibref">FIDOSecRef</a></cite>] and [<cite><a href="#bib-UAFProtocol" class="bibref">UAFProtocol</a></cite>] for more details on the relevance on attestation.
	  </li>
	</ul>
	<p>Verification of attestation statements requires that the relying
	  party trusts the root of the attestation certificate chain.
	  Also, the relying party must have access to certificate status
	  information for the intermediate CA certificates. The relying
	  party must also be able to build the attestation certificate
	  chain if the client didn't provide this chain in the
	  attestation information.
	</p>
      </section>

    </section>

    <section property="bibo:hasPart" resource="#security-considerations" typeof="bibo:Chapter" id="security-considerations">
      <!--OddPage--><h2 resource="#h-security-considerations" id="h-security-considerations"><span property="xhv:role" resource="xhv:heading"><span class="secno">4. </span>Security Considerations</span></h2> 
      
      <section property="bibo:hasPart" resource="#privacy" typeof="bibo:Chapter" id="privacy">
	<h3 resource="#h-privacy" id="h-privacy"><span property="xhv:role" resource="xhv:heading"><span class="secno">4.1 </span>Privacy</span></h3>
	
	<p>Attestation keys may be used to track users or link
	  various online identities of the same user together. This may
	  be mitigated in several ways, including:
	</p>
	<ul>
	  <li>A FIDO Authenticator manufacturer may choose to ship all of their devices with
	    the same (or a fixed number of) attestation key(s) (called Full Basic Attestation). This will
	    anonymize the user at the risk of not being able to revoke a
	    particular attestation key should its FIDO Authenticator be compromised.
	  </li>
	  <li>A FIDO Authenticator may be capable of dynamically generating different attestation keys
	    (and requesting related certificates) per origin (following the Privacy CA model). 
	    For example, a FIDO Authenticator can ship with a master 
	    attestation key (and certificate), and
	    combined with a cloud operated privacy CA, can dynamically generate per origin
	    attestation keys and attestation certificates.
	  </li>
	  <li>A FIDO Authenticator can implement direct anonymous 
	    attestation (see [<cite><a href="#bib-FIDOEcdaaAlgorithm" class="bibref">FIDOEcdaaAlgorithm</a></cite>]).  Using this scheme the authenticator
	    generates a blinded attestation signature.  This allows the relying party to verify 
	    the signature using the DAA root key, but the attestation signature doesn't 
	    serve as a global correlation handle.
	  </li>
	</ul>
      </section>

      <section property="bibo:hasPart" resource="#attestation-certificate-and-attestation-certificate-ca-compromise" typeof="bibo:Chapter" id="attestation-certificate-and-attestation-certificate-ca-compromise">
	<h3 resource="#h-attestation-certificate-and-attestation-certificate-ca-compromise" id="h-attestation-certificate-and-attestation-certificate-ca-compromise"><span property="xhv:role" resource="xhv:heading"><span class="secno">4.2 </span>Attestation Certificate and Attestation Certificate CA Compromise</span></h3>
	<p>When an intermediate CA or a root CA used for issuing attestation
	  certificates is compromised, FIDO Authenticator attestation keys are still
	  safe although their certificates can no longer be trusted. A
	  FIDO Authenticator manufacturer that has recorded the public attestation keys
	  for their devices can issue new attestation certificates for
	  these keys from a new intermediate CA or from a new root CA.
	  If the root CA changes, the relying parties must update their trusted 
	  root certificates accordingly.
	</p>
	<p>A FIDO Authenticator attestation certificate must be revoked by the issuing CA
	  if its key has been compromised. A FIDO Authenticator manufacturer may need to
	  ship a firmware update and inject new attestation keys and
	  certificates into already manufactured FIDO Authenticators, if
	  the exposure was due to a firmware flaw.
	  (The process by which this happens is out of scope for this specification.)
	  No further valid
	  attestation statements can be made by the affected FIDO Authenticators unless
	  the FIDO Authenticator manufacturer has this capability.
	</p>
	<p>If attestation certificate validation fails due to a revoked
	  intermediate attestation CA certificate, and relying party policy requires rejecting
	  the registration/authentication request in these situations,
	  then it is recommended that the relying party also un-registers
	  (or marks as "surrogate attestation" (see <a class="sec-ref" href="#attestation-models"><span class="secno">2.1</span> <span class="sec-title">Attestation Models</span></a>), policy permitting) 
	  FIDO credentials that were registered post the CA compromise date using an attestation
	  certificate chaining up to the same intermediate CA. It is thus
	  recommended that relying parties remember intermediate attestation CA certificates
	  during Authenticator registration in order to un-register related FIDO Credentials if 
	  the registration was performed after revocation of such certificates.
	</p>
	
	<p>If a DAA attestation key has been compromised, it can be added to the
	  RogueList (i.e., the list of revoked authenticators) maintained by the related DAA-Issuer.
	  The relying party should verify whether an authenticator belongs to the
	  RogueList when performing DAA-Verify.  The FIDO Metadata Service [<cite><a href="#bib-FIDOMetadataService" class="bibref">FIDOMetadataService</a></cite>]
	  provides an easy way to access such information.
	</p>
      </section>
      
      <section property="bibo:hasPart" resource="#attestation-certificate-hierarchy" typeof="bibo:Chapter" id="attestation-certificate-hierarchy">
	<h3 resource="#h-attestation-certificate-hierarchy" id="h-attestation-certificate-hierarchy"><span property="xhv:role" resource="xhv:heading"><span class="secno">4.3 </span>Attestation Certificate Hierarchy</span></h3>
	<p>A 3 tier hierarchy for attestation certificates is recommended 
	  (i.e., Attestation Root, Attestation Issuing CA, Attestation Certificate). 
	  It is also recommended that
	  for each FIDO Authenticator device line (i.e., model), a separate issuing CA is used to help
	  facilitate isolating problems with a specific version of a device.
	</p>
	<p>If the attestation root certificate is <em>not</em> dedicated 
	  to a single FIDO Authenticator device line (i.e., AAGUID),
	  the AAGUID must be specified either in the attestation certificate itself or 
	  as an extension in the <code>core.rawData</code>.
	</p>
      </section>
    </section>
  

<section property="bibo:hasPart" resource="#references" typeof="bibo:Chapter" id="references" class="appendix"><!--OddPage--><h2 resource="#h-references" id="h-references"><span property="xhv:role" resource="xhv:heading"><span class="secno">A. </span>References</span></h2><section property="bibo:hasPart" resource="#normative-references" typeof="bibo:Chapter" id="normative-references"><h3 resource="#h-normative-references" id="h-normative-references"><span property="xhv:role" resource="xhv:heading"><span class="secno">A.1 </span>Normative references</span></h3><dl resource="" class="bibliography"><dt id="bib-FIDOEcdaaAlgorithm">[FIDOEcdaaAlgorithm]</dt><dd>R. Lindemann; A. Edgington; R. Urian. <cite>FIDO ECDAA Algorithm</cite>. FIDO Alliance Proposed Standard (To Be Published). 
</dd><dt id="bib-FIDOSignatureFormat">[FIDOSignatureFormat]</dt><dd><a property="dc:requires" href="http://www.w3.org/Submission/2015/SUBM-fido-signature-format-20151120/"><cite>FIDO 2.0: Signature format</cite></a>. URL: <a property="dc:requires" href="http://www.w3.org/Submission/2015/SUBM-fido-signature-format-20151120/">http://www.w3.org/Submission/2015/SUBM-fido-signature-format-20151120/</a>
</dd><dt id="bib-RFC2119">[RFC2119]</dt><dd>S. Bradner. <a property="dc:requires" href="https://tools.ietf.org/html/rfc2119"><cite>Key words for use in RFCs to Indicate Requirement Levels</cite></a>. March 1997. Best Current Practice. URL: <a property="dc:requires" href="https://tools.ietf.org/html/rfc2119">https://tools.ietf.org/html/rfc2119</a>
</dd><dt id="bib-RFC7515">[RFC7515]</dt><dd>M. Jones; J. Bradley; N. Sakimura. <a property="dc:requires" href="https://tools.ietf.org/html/rfc7515"><cite>JSON Web Signature (JWS)</cite></a>. May 2015. Proposed Standard. URL: <a property="dc:requires" href="https://tools.ietf.org/html/rfc7515">https://tools.ietf.org/html/rfc7515</a>
</dd><dt id="bib-RFC7518">[RFC7518]</dt><dd>M. Jones. <a property="dc:requires" href="https://tools.ietf.org/html/rfc7518"><cite>JSON Web Algorithms (JWA)</cite></a>. May 2015. Proposed Standard. URL: <a property="dc:requires" href="https://tools.ietf.org/html/rfc7518">https://tools.ietf.org/html/rfc7518</a>
</dd><dt id="bib-SEC1">[SEC1]</dt><dd><a property="dc:requires" href="http://www.secg.org/sec1-v2.pdf"><cite>SEC1: Elliptic Curve Cryptography, Version 2.0</cite></a>. URL: <a property="dc:requires" href="http://www.secg.org/sec1-v2.pdf">http://www.secg.org/sec1-v2.pdf</a>
</dd><dt id="bib-WebCryptoAPI">[WebCryptoAPI]</dt><dd>Ryan Sleevi; Mark Watson. <a property="dc:requires" href="http://www.w3.org/TR/WebCryptoAPI/"><cite>Web Cryptography API</cite></a>. 11 December 2014. W3C Candidate Recommendation. URL: <a property="dc:requires" href="http://www.w3.org/TR/WebCryptoAPI/">http://www.w3.org/TR/WebCryptoAPI/</a>
</dd></dl></section><section property="bibo:hasPart" resource="#informative-references" typeof="bibo:Chapter" id="informative-references"><h3 resource="#h-informative-references" id="h-informative-references"><span property="xhv:role" resource="xhv:heading"><span class="secno">A.2 </span>Informative references</span></h3><dl resource="" class="bibliography"><dt id="bib-FIDOMetadataService">[FIDOMetadataService]</dt><dd>R. Lindemann; B. Hill; D. Baghdasaryan. <a property="dc:references" href="https://fidoalliance.org/specs/fido-uaf-v1.0-ps-20141208/fido-uaf-metadata-service-v1.0-ps-20141208.html"><cite>FIDO Metadata Service v1.0</cite></a>. FIDO Alliance Proposed Standard. URL: <a property="dc:references" href="https://fidoalliance.org/specs/fido-uaf-v1.0-ps-20141208/fido-uaf-metadata-service-v1.0-ps-20141208.html">https://fidoalliance.org/specs/fido-uaf-v1.0-ps-20141208/fido-uaf-metadata-service-v1.0-ps-20141208.html</a>
</dd><dt id="bib-FIDOSecRef">[FIDOSecRef]</dt><dd>R. Lindemann; D. Baghdasaryan; B. Hill. <a property="dc:references" href="https://fidoalliance.org/specs/fido-uaf-v1.0-ps-20141208/fido-security-ref-v1.0-ps-20141208.html"><cite>FIDO Security Reference</cite></a>. FIDO Alliance Proposed Standard. URL: <a property="dc:references" href="https://fidoalliance.org/specs/fido-uaf-v1.0-ps-20141208/fido-security-ref-v1.0-ps-20141208.html">https://fidoalliance.org/specs/fido-uaf-v1.0-ps-20141208/fido-security-ref-v1.0-ps-20141208.html</a>
</dd><dt id="bib-FIDOWebApi">[FIDOWebApi]</dt><dd><a property="dc:references" href="http://www.w3.org/Submission/2015/SUBM-fido-web-api-20151120/"><cite>FIDO 2.0: Web API for accessing FIDO 2.0 credentials</cite></a>. URL: <a property="dc:references" href="http://www.w3.org/Submission/2015/SUBM-fido-web-api-20151120/">http://www.w3.org/Submission/2015/SUBM-fido-web-api-20151120/</a>
</dd><dt id="bib-RFC3447">[RFC3447]</dt><dd>J. Jonsson; B. Kaliski. <a property="dc:references" href="https://tools.ietf.org/html/rfc3447"><cite>Public-Key Cryptography Standards (PKCS) #1: RSA Cryptography Specifications Version 2.1</cite></a>. February 2003. Informational. URL: <a property="dc:references" href="https://tools.ietf.org/html/rfc3447">https://tools.ietf.org/html/rfc3447</a>
</dd><dt id="bib-RFC4055">[RFC4055]</dt><dd>J. Schaad; B. Kaliski; R. Housley. <a property="dc:references" href="https://tools.ietf.org/html/rfc4055"><cite>Additional Algorithms and Identifiers for RSA Cryptography for use in the Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile</cite></a>. June 2005. Proposed Standard. URL: <a property="dc:references" href="https://tools.ietf.org/html/rfc4055">https://tools.ietf.org/html/rfc4055</a>
</dd><dt id="bib-RFC4122">[RFC4122]</dt><dd>P. Leach; M. Mealling; R. Salz. <a property="dc:references" href="https://tools.ietf.org/html/rfc4122"><cite>A Universally Unique IDentifier (UUID) URN Namespace</cite></a>. July 2005. Proposed Standard. URL: <a property="dc:references" href="https://tools.ietf.org/html/rfc4122">https://tools.ietf.org/html/rfc4122</a>
</dd><dt id="bib-RFC4648">[RFC4648]</dt><dd>S. Josefsson. <a property="dc:references" href="https://tools.ietf.org/html/rfc4648"><cite>The Base16, Base32, and Base64 Data Encodings</cite></a>. October 2006. Proposed Standard. URL: <a property="dc:references" href="https://tools.ietf.org/html/rfc4648">https://tools.ietf.org/html/rfc4648</a>
</dd><dt id="bib-RFC5280">[RFC5280]</dt><dd>D. Cooper; S. Santesson; S. Farrell; S. Boeyen; R. Housley; W. Polk. <a property="dc:references" href="https://tools.ietf.org/html/rfc5280"><cite>Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile</cite></a>. May 2008. Proposed Standard. URL: <a property="dc:references" href="https://tools.ietf.org/html/rfc5280">https://tools.ietf.org/html/rfc5280</a>
</dd><dt id="bib-TPM">[TPM]</dt><dd><a property="dc:references" href="http://www.trustedcomputinggroup.org/resources/tpm_main_specification"><cite>TPM Main Specification</cite></a>. Accessed March 2014. URL: <a property="dc:references" href="http://www.trustedcomputinggroup.org/resources/tpm_main_specification">http://www.trustedcomputinggroup.org/resources/tpm_main_specification</a>
</dd><dt id="bib-TPMv1-2-Credential-Profiles">[TPMv1-2-Credential-Profiles]</dt><dd><a property="dc:references" href="http://www.trustedcomputinggroup.org/files/static_page_files/A55529C5-1A4B-B294-D0A5A400E1EDE13A/Credential_Profiles_V1.2_Level2_Revision8.pdf"><cite>TPM 1.2 Credential Profiles</cite></a>. URL: <a property="dc:references" href="http://www.trustedcomputinggroup.org/files/static_page_files/A55529C5-1A4B-B294-D0A5A400E1EDE13A/Credential_Profiles_V1.2_Level2_Revision8.pdf">http://www.trustedcomputinggroup.org/files/static_page_files/A55529C5-1A4B-B294-D0A5A400E1EDE13A/Credential_Profiles_V1.2_Level2_Revision8.pdf</a>
</dd><dt id="bib-TPMv1-2-Part2">[TPMv1-2-Part2]</dt><dd><a property="dc:references" href="http://www.trustedcomputinggroup.org/files/static_page_files/E55A303C-1A4B-B294-D066E66A82DAE27D/TPM%20Main-Part%202%20TPM%20Structures_v1.2_rev116_01032011.pdf"><cite>TPM 1.2 Part 2: Structures</cite></a>. URL: <a property="dc:references" href="http://www.trustedcomputinggroup.org/files/static_page_files/E55A303C-1A4B-B294-D066E66A82DAE27D/TPM%20Main-Part%202%20TPM%20Structures_v1.2_rev116_01032011.pdf">http://www.trustedcomputinggroup.org/files/static_page_files/E55A303C-1A4B-B294-D066E66A82DAE27D/TPM%20Main-Part%202%20TPM%20Structures_v1.2_rev116_01032011.pdf</a>
</dd><dt id="bib-TPMv2-EK-Profile">[TPMv2-EK-Profile]</dt><dd><a property="dc:references" href="http://www.trustedcomputinggroup.org/files/static_page_files/DCD56924-1A4B-B294-D0CEF64E80CEE01E/Credential_Profile_EK_V2.0_R12_PublicReview.pdf"><cite>TCG EK Credential Profile</cite></a>. URL: <a property="dc:references" href="http://www.trustedcomputinggroup.org/files/static_page_files/DCD56924-1A4B-B294-D0CEF64E80CEE01E/Credential_Profile_EK_V2.0_R12_PublicReview.pdf">http://www.trustedcomputinggroup.org/files/static_page_files/DCD56924-1A4B-B294-D0CEF64E80CEE01E/Credential_Profile_EK_V2.0_R12_PublicReview.pdf</a>
</dd><dt id="bib-TPMv2-Part2">[TPMv2-Part2]</dt><dd><a property="dc:references" href="http://www.trustedcomputinggroup.org/files/static_page_files/8C583202-1A4B-B294-D0469592DB10A6CD/TPM%20Rev%202.0%20Part%202%20-%20Structures%2001.16.pdf"><cite>Trusted Platform Module Library, Part 2: Structures</cite></a>. URL: <a property="dc:references" href="http://www.trustedcomputinggroup.org/files/static_page_files/8C583202-1A4B-B294-D0469592DB10A6CD/TPM%20Rev%202.0%20Part%202%20-%20Structures%2001.16.pdf">http://www.trustedcomputinggroup.org/files/static_page_files/8C583202-1A4B-B294-D0469592DB10A6CD/TPM%20Rev%202.0%20Part%202%20-%20Structures%2001.16.pdf</a>
</dd><dt id="bib-UAFProtocol">[UAFProtocol]</dt><dd>R. Lindemann; D. Baghdasaryan; E. Tiffany; D. Balfanz; B. Hill; J. Hodges. <a property="dc:references" href="https://fidoalliance.org/specs/fido-uaf-v1.0-ps-20141208/fido-uaf-protocol-v1.0-ps-20141208.html"><cite>FIDO UAF Protocol Specification v1.0</cite></a>. FIDO Alliance Proposed Standard. URL: <a property="dc:references" href="https://fidoalliance.org/specs/fido-uaf-v1.0-ps-20141208/fido-uaf-protocol-v1.0-ps-20141208.html">https://fidoalliance.org/specs/fido-uaf-v1.0-ps-20141208/fido-uaf-protocol-v1.0-ps-20141208.html</a>
</dd></dl></section></section></body></html>
