<!doctype html><html lang="en">
 <head>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
  <title>FIDO 2.0: Web API for accessing FIDO 2.0 credentials</title>
  <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
<style data-fill-with="stylesheet">/******************************************************************************
 *                   Style sheet for the W3C specifications                   *
 *
 * Special classes handled by this style sheet include:
 *
 * Indices
 *   - .toc for the Table of Contents (<ol class="toc">)
 *     -> <span class="secno"> for the section numbers
 *   - #toc for the Table of Contents (<nav id="toc">)
 *   - ul.index for Indices (<a href="#ref">term</a><span>, in §N.M</span>)
 *   - table.index for Index Tables (e.g. for properties or elements)
 *
 * Structural Markup
 *   - table.data for general data tables
 *     -> use 'scope' attribute, <colgroup>, <thead>, and <tbody> for best results !
 *     -> use <table class='complex data'> for extra-complex tables
 *     -> use <td class='long'> for paragraph-length cell content
 *     -> use <td class='pre'> when manual line breaks/indentation would help readability
 *   - dl.switch for switch statements
 *   - ol.algorithm for algorithms (helps to visualize nesting)
 *   - .figure and .caption (HTML4) and figure and figcaption (HTML5)
 *     -> .sidefigure for right-floated figures
 *   - ins/del
 *
 * Code
 *   - pre and code
 *
 * Special Sections
 *   - .note       for informative notes             (div, p, span, aside, details)
 *   - .example    for informative examples          (div, p, pre, span)
 *   - .issue      for issues                        (div, p, span)
 *   - .advisement for loud normative statements     (div, p, strong)
 *   - .annoying-warning for spec obsoletion notices (div, aside, details)
 *
 * Definition Boxes
 *   - pre.def   for WebIDL definitions
 *   - table.def for tables that define other entities (e.g. CSS properties)
 *   - dl.def    for definition lists that define other entitles (e.g. HTML elements)
 *
 * Numbering
 *   - .secno for section numbers in .toc and headings (<span class='secno'>3.2</span>)
 *   - .marker for source-inserted example/figure/issue numbers (<span class='marker'>Issue 4</span>)
 *   - ::before styled for CSS-generated issue/example/figure numbers:
 *     -> Documents wishing to use this only need to add
 *        figcaption::before,
 *        .caption::before { content: "Figure "  counter(figure);  }
 *        .example::before { content: "Example " counter(example); }
 *        .issue::before   { content: "Issue "   counter(issue);   }
 *
 * Header Stuff (ignore, just don't conflict with these classes)
 *   - .head for the header
 *   - .copyright for the copyright
 *
 * Miscellaneous
 *   - .overlarge for things that should be as wide as possible, even if
 *     that overflows the body text area. This can be used on an item or
 *     on its container, depending on the effect desired.
 *     Note that this styling basically doesn't help at all when printing,
 *     since A4 paper isn't much wider than the max-width here.
 *     It's better to design things to fit into a narrower measure if possible.
 *   - js-added ToC jump links (see fixup.js)
 *
 ******************************************************************************/

/******************************************************************************/
/*                                   Body                                     */
/******************************************************************************/

	body {
		counter-reset: example figure issue;

		/* Layout */
		max-width: 50em;               /* limit line length to 50em for readability   */
		margin: 0 auto;                /* center text within page                     */
		padding: 1.6em 1.5em 2em 50px; /* assume 16px font size for downlevel clients */
		padding: 1.6em 1.5em 2em calc(26px + 1.5em); /* leave space for status flag     */

		/* Typography */
		line-height: 1.5;
		font-family: sans-serif;
		widows: 2;
		orphans: 2;
		word-wrap: break-word;
		overflow-wrap: break-word;
		hyphens: auto;

		/* Colors */
		color: black;
		background: white top left fixed no-repeat;
		background-size: 25px auto;
	}


/******************************************************************************/
/*                         Front Matter & Navigation                          */
/******************************************************************************/

/** Header ********************************************************************/

	div.head { margin-bottom: 1em }
	div.head hr { border-style: solid; }

	div.head h1 {
		font-weight: bold;
		margin: 0 0 .1em;
		font-size: 220%;
	}

	div.head h2 { margin-bottom: 1.5em;}

	div.head .logo {
		float: right;
		margin: 0;
	}

	@media screen {
		div.head .logo > a {
			display: inline-block;
			margin: 0.4rem 0 0.2rem .4rem;
		}

		div.head img[src*="logos/W3C"] {
			display: block;
			border: solid #1a5e9a;
			border-width: .65rem .7rem .6rem;
			border-radius: .4rem;
			background: #1a5e9a;
			color: white;
			font-weight: bold;
		}

		div.head a:hover > img[src*="logos/W3C"],
		div.head a:focus > img[src*="logos/W3C"] {
			background: #457cad;
			border-color: #457cad;
		}

		div.head a:active > img[src*="logos/W3C"] {
			background: #c00;
			border-color: #c00;
		}
	}


	p.copyright,
	p.copyright small { font-size: small }

/** Back to Top / ToC Toggle **************************************************/

	@media print {
		#toc-nav {
			display: none;
		}
	}
	@media not print {
		#toc-nav {
			position: fixed;
			z-index: 2;
			bottom: 0; left: 0;
			margin: 0;
			min-width: 1.33em;
			border-top-right-radius: 2rem;
			box-shadow: 0 0 2px;
			font-size: 1.5em;
			color: black;
		}
		#toc-nav > a {
			display: block;
			white-space: nowrap;

			height: 1.33em;
			padding: .1em 0.3em;
			margin: 0;

			background: white;
			box-shadow: 0 0 2px;
			border: none;
			border-top-right-radius: 1.33em;
			background: white;
		}
		#toc-nav > #toc-jump {
			padding-bottom: 2em;
			margin-bottom: -1.9em;
		}

		#toc-nav > a:hover,
		#toc-nav > a:focus {
			background: #f8f8f8;
		}
		#toc-nav > a:not(:hover):not(:focus) {
			color: #707070;
		}

		/* statusbar gets in the way on keyboard focus; remove once browsers fix */
		#toc-nav > a[href="#toc"]:not(:hover):focus:last-child {
			padding-bottom: 1.5rem;
		}

		#toc-nav:not(:hover) > a:not(:focus) > span + span {
			/* Ideally this uses :focus-within on #toc-nav */
			display: none;
		}
		#toc-nav > a > span + span {
			padding-right: 0.2em;
		}

		#toc-toggle-inline {
			vertical-align: 0.05em;
			font-size: 80%;
			color: gray;
			color: hsla(203,20%,40%,.7);
			border-style: none;
			background: transparent;
			position: relative;
		}
		#toc-toggle-inline:hover:not(:active),
		#toc-toggle-inline:focus:not(:active) {
			text-shadow: 1px 1px silver;
			top: -1px;
			left: -1px;
		}

		#toc-nav :active {
			color: #C00;
		}
	}

/** ToC Sidebar ***************************************************************/

	/* Floating sidebar */
	@media screen {
		body.toc-sidebar #toc {
			position: fixed;
			top: 0; bottom: 0;
			left: 0;
			width: 23.5em;
			max-width: 80%;
			max-width: calc(100% - 2em - 26px);
			overflow: auto;
			padding: 0 1em;
			padding-left: 42px;
			padding-left: calc(1em + 26px);
			background: inherit;
			background-color: #f7f8f9;
			z-index: 1;
			box-shadow: -.1em 0 .25em rgba(0,0,0,.1) inset;
		}
		body.toc-sidebar #toc h2 {
			margin-top: .8rem;
			font-variant: small-caps;
			font-variant: all-small-caps;
			text-transform: lowercase;
			font-weight: bold;
			color: gray;
			color: hsla(203,20%,40%,.7);
		}
		body.toc-sidebar #toc-jump:not(:focus) {
			width: 0;
			height: 0;
			padding: 0;
			position: absolute;
			overflow: hidden;
		}
	}
	/* Hide main scroller when only the ToC is visible anyway */
	@media screen and (max-width: 28em) {
		body.toc-sidebar {
			overflow: hidden;
		}
	}

	/* Sidebar with its own space */
	@media screen and (min-width: 78em) {
		body:not(.toc-inline) #toc {
			position: fixed;
			top: 0; bottom: 0;
			left: 0;
			width: 23.5em;
			overflow: auto;
			padding: 0 1em;
			padding-left: 42px;
			padding-left: calc(1em + 26px);
			background: inherit;
			background-color: #f7f8f9;
			z-index: 1;
			box-shadow: -.1em 0 .25em rgba(0,0,0,.1) inset;
		}
		body:not(.toc-inline) #toc h2 {
			margin-top: .8rem;
			font-variant: small-caps;
			font-variant: all-small-caps;
			text-transform: lowercase;
			font-weight: bold;
			color: gray;
			color: hsla(203,20%,40%,.7);
		}

		body:not(.toc-inline) {
			padding-left: 29em;
		}
		/* See also Overflow section at the bottom */

		body:not(.toc-inline) #toc-jump:not(:focus) {
			width: 0;
			height: 0;
			padding: 0;
			position: absolute;
			overflow: hidden;
		}
	}
	@media screen and (min-width: 90em) {
		body:not(.toc-inline) {
			margin: 0 4em;
		}
	}

/******************************************************************************/
/*                                Sectioning                                  */
/******************************************************************************/

/** Headings ******************************************************************/

	h1, h2, h3, h4, h5, h6, dt {
		page-break-after: avoid;
		page-break-inside: avoid;
		font: 100% sans-serif;   /* Reset all font styling to clear out UA styles */
		font-family: inherit;    /* Inherit the font family. */
		line-height: 1.2;        /* Keep wrapped headings compact */
	}

	h2, h3, h4, h5, h6 {
		margin-top: 3rem;
	}

	h1, h2, h3 {
		color: #005A9C;
		background: transparent;
	}

	h1 { font-size: 170%; }
	h2 { font-size: 140%; }
	h3 { font-size: 120%; }
	h4 { font-weight: bold; }
	h5 { font-style: italic; }
	h6 { font-variant: small-caps; }
	dt { font-weight: bold; }

/** Subheadings ***************************************************************/

	h1 + h2,
	#subtitle {
		/* #subtitle is a subtitle in an H2 under the H1 */
		margin-top: 0;
	}
	h2 + h3,
	h3 + h4,
	h4 + h5,
	h5 + h6 {
		margin-top: 1.2em; /* = 1 x line-height */
	}

/** Section divider ***********************************************************/

	:not(.head) > hr {
		font-size: 1.5em;
		text-align: center;
		margin: 1em auto;
		height: auto;
		border: transparent solid 0;
		background: transparent;
	}
	:not(.head) > hr::before {
		content: "\2727\2003\2003\2727\2003\2003\2727";
	}

/******************************************************************************/
/*                            Paragraphs and Lists                            */
/******************************************************************************/

	p {
		margin: 1em 0;
	}

	dd > p:first-child,
	li > p:first-child {
		margin-top: 0;
	}

	ul, ol {
		margin-left: 0;
		padding-left: 2em;
	}

	li {
		margin: 0.25em 0 0.5em;
		padding: 0;
	}

	dl dd {
		margin: 0 0 .5em 2em;
	}

	.head dd + dd { /* compact for header */
		margin-top: -.5em;
	}

	/* Style for algorithms */
	ol.algorithm ol:not(.algorithm) {
	 border-left: 0.5em solid #DEF;
	}

	/* Style for switch/case <dl>s */
	dl.switch > dd > ol.only {
	 margin-left: 0;
	}
	dl.switch > dd > ol.algorithm {
	 margin-left: -2em;
	}
	dl.switch {
	 padding-left: 2em;
	}
	dl.switch > dt {
	 text-indent: -1.5em;
	 margin-top: 1em;
	}
	dl.switch > dt + dt {
	 margin-top: 0;
	}
	dl.switch > dt::before {
	 content: '\21AA';
	 padding: 0 0.5em 0 0;
	 display: inline-block;
	 width: 1em;
	 text-align: right;
	 line-height: 0.5em;
	}

/** Terminology Markup ********************************************************/


/******************************************************************************/
/*                                 Inline Markup                              */
/******************************************************************************/

/** Terminology Markup ********************************************************/
	dfn   { /* Defining instance */
		font-weight: bolder;
	}
	a > i { /* Instance of term */
		font-style: normal;
	}
	dt dfn code, code.idl {
		font-size: inherit;
	}
	dfn var {
		font-style: normal;
	}

/** Change Marking ************************************************************/

	del { color: red;  text-decoration: line-through; }
	ins { color: #080; text-decoration: underline;    }

/** Miscellaneous improvements to inline formatting ***************************/

	sup {
		vertical-align: super;
		font-size: 80%
	}

/******************************************************************************/
/*                                    Code                                    */
/******************************************************************************/

/** General monospace/pre rules ***********************************************/

	pre, code, samp {
		font-family: Menlo, Consolas, "DejaVu Sans Mono", Monaco, monospace;
		font-size: .9em;
		page-break-inside: avoid;
		hyphens: none;
		text-transform: none;
	}
	pre code,
	code code {
		font-size: 100%;
	}

	pre {
		margin-top: 1em;
		margin-bottom: 1em;
		overflow: auto;
	}

/** Inline Code fragments *****************************************************/

  /* Do something nice. */

/******************************************************************************/
/*                                    Links                                   */
/******************************************************************************/

/** General Hyperlinks ********************************************************/

	/* We hyperlink a lot, so make it less intrusive */
	a[href] {
		color: #034575;
		text-decoration: none;
		border-bottom: 1px solid #707070;
		/* Need a bit of extending for it to look okay */
		padding: 0 1px 0;
		margin: 0 -1px 0;
	}
	a:visited {
		border-bottom-color: #BBB;
	}

	/* Use distinguishing colors when user is interacting with the link */
	a[href]:focus,
	a[href]:hover {
		background: #f8f8f8;
		background: rgba(75%, 75%, 75%, .25);
		border-bottom-width: 3px;
		margin-bottom: -2px;
	}
	a[href]:active {
		color: #C00;
		border-color: #C00;
	}

	/* Backout above styling for W3C logo */
	.head > p:first-child > a {
		border: none;
		text-decoration: none;
	}

/******************************************************************************/
/*                                    Images                                  */
/******************************************************************************/

	img {
		border-style: none;
	}

	/* For autogen numbers, add
	   .caption::before, figcaption::before { content: "Figure " counter(figure) ". "; }
	*/

	figure, .figure, .sidefigure {
		page-break-inside: avoid;
		text-align: center;
		margin: 2.5em 0;
	}
	.figure img,    .sidefigure img,    figure img,
	.figure object, .sidefigure object, figure object {
		max-width: 100%;
		margin: auto;
	}
	.figure pre, .sidefigure pre, figure pre {
		text-align: left;
		display: table;
		margin: 1em auto;
	}
	.figure table, figure table {
		margin: auto;
	}
	@media screen and (min-width: 20em) {
		.sidefigure {
			float: right;
			width: 50%;
			margin: 0 0 0.5em 0.5em
		}
	}
	.caption, figcaption, caption {
		font-style: italic;
		font-size: 90%;
	}
	.caption::before, figcaption::before, figcaption > .marker {
		font-weight: bold;
	}
	.caption, figcaption {
		counter-increment: figure;
	}

	/* DL list is indented 2em, but figure inside it is not */
	dd > .figure, dd > figure { margin-left: -2em }

/******************************************************************************/
/*                             Colored Boxes                                  */
/******************************************************************************/

	.issue, .note, .example, .advisement, blockquote {
		padding: .5em;
		border: .5em;
		border-left-style: solid;
		page-break-inside: avoid;
	}
	span.issue, span.note {
		padding: .1em .5em .15em;
		border-right-style: solid;
	}

	.issue,
	.note,
	.example,
	.advisement,
	blockquote {
		margin: 1em auto;
	}
	.note  > p:first-child,
	.issue > p:first-child,
	blockquote > :first-child {
		margin-top: 0;
	}
	blockquote > :last-child {
		margin-bottom: 0;
	}

/** Blockquotes ***************************************************************/

	blockquote {
		border-color: silver;
	}

/** Open issue ****************************************************************/

	.issue {
		border-color: #E05252;
		background: #FBE9E9;
		counter-increment: issue;
		overflow: auto;
	}
	.issue::before, .issue > .marker {
		text-transform: uppercase;
		color: #AE1E1E;
		padding-right: 1em;
		text-transform: uppercase;
	}
	/* Add .issue::before { content: "Issue " counter(issue); } for autogen numbers,
	   or use class="marker" to mark up the issue number in source. */

/** Example *******************************************************************/

	.example {
		border-color: #E0CB52;
		background: #FCFAEE;
		counter-increment: example;
		overflow: auto;
		clear: both;
	}
	.example::before, .example > .marker {
		text-transform: uppercase;
		color: #827017;
		min-width: 7.5em;
		display: block;
	}
	/* Add .example::before { content: "Example " counter(example); } for autogen numbers,
	   or use class="marker" to mark up the example number in source. */

/** Non-normative Note ********************************************************/

	.note {
		border-color: #52E052;
		background: #E9FBE9;
		overflow: auto;
	}

	.note::before, .note > .marker,
	details.note > summary::before,
	details.note > summary > .marker {
		text-transform: uppercase;
		display: block;
		color: hsl(120, 70%, 30%);
	}
	/* Add .note::before { content: "Note"; } for autogen label,
	   or use class="marker" to mark up the label in source. */

	details.note > summary {
		display: block;
		color: hsl(120, 70%, 30%);
	}
	details.note[open] > summary {
		border-bottom: 1px silver solid;
	}

/** Advisement Box ************************************************************/
	/*  for attention-grabbing normative statements */

	.advisement {
		border-color: orange;
		border-style: none solid;
		background: #FFEECC;
	}
	strong.advisement {
		display: block;
		text-align: center;
	}
	.advisement > .marker {
		color: #B35F00;
	}

/** Spec Obsoletion Notice ****************************************************/
	/* obnoxious obsoletion notice for older/abandoned specs. */

	details {
		display: block;
	}
	summary {
		font-weight: bolder;
	}

	.annoying-warning:not(details),
	details.annoying-warning:not([open]) > summary,
	details.annoying-warning[open] {
		background: #fdd;
		color: red;
		font-weight: bold;
		padding: .75em 1em;
		border: thick red;
		border-style: solid;
		border-radius: 1em;
	}
	.annoying-warning :last-child {
		margin-bottom: 0;
	}

@media not print {
	details.annoying-warning[open] {
		position: fixed;
		left: 1em;
		right: 1em;
		bottom: 1em;
		z-index: 1000;
	}
}

	details.annoying-warning:not([open]) > summary {
		text-align: center;
	}

/** Entity Definition Boxes ***************************************************/

	.def {
		padding: .5em 1em;
		background: #DEF;
		margin: 1.2em 0;
		border-left: 0.5em solid #8CCBF2;
	}

/******************************************************************************/
/*                                    Tables                                  */
/******************************************************************************/

	th, td {
		text-align: left;
		text-align: start;
	}

/** Property/Descriptor Definition Tables *************************************/

	table.def {
		/* inherits .def box styling, see above */
		width: 100%;
		border-spacing: 0;
	}

	table.def td,
	table.def th {
		padding: 0.5em;
		vertical-align: baseline;
		border-bottom: 1px solid #bbd7e9;
	}

	table.def > tbody > tr:last-child th,
	table.def > tbody > tr:last-child td {
		border-bottom: 0;
	}

	table.def th {
		font-style: italic;
		font-weight: normal;
		padding-left: 1em;
		width: 3em;
	}

	/* For when values are extra-complex and need formatting for readability */
	table td.pre {
		white-space: pre-wrap;
	}

	/* A footnote at the bottom of a def table */
	table.def           td.footnote {
		padding-top: 0.6em;
	}
	table.def           td.footnote::before {
		content: " ";
		display: block;
		height: 0.6em;
		width: 4em;
		border-top: thin solid;
	}

/** Data tables (and properly marked-up index tables) *************************/
	/*
		 <table class="data"> highlights structural relationships in a table
		 when correct markup is used (e.g. thead/tbody, th vs. td, scope attribute)

		 Use class="complex data" for particularly complicated tables --
		 (This will draw more lines: busier, but clearer.)

		 Use class="long" on table cells with paragraph-like contents
		 (This will adjust text alignment accordingly.)
		 Alternately use class="longlastcol" on tables, to have the last column assume "long".
	*/

	table {
		word-wrap: normal;
		overflow-wrap: normal;
		hyphens: manual;
	}

	table.data,
	table.index {
		margin: 1em auto;
		border-collapse: collapse;
		width: 100%;
		border: hidden;
	}
	table.data caption,
	table.index caption {
		max-width: 50em;
		margin: 0 auto 1em;
	}

	table.data td,  table.data th,
	table.index td, table.index th {
		padding: 0.5em 1em;
		border-width: 1px;
		border-color: silver;
		border-top-style: solid;
	}

	table.data thead td:empty {
		padding: 0;
		border: 0;
	}

	table.data  thead,
	table.index thead,
	table.data  tbody,
	table.index tbody {
		border-bottom: 2px solid;
	}

	table.data colgroup,
	table.index colgroup {
		border-left: 2px solid;
	}

	table.data  tbody th:first-child,
	table.index tbody th:first-child  {
		border-right: 2px solid;
		border-top: 1px solid silver;
		padding-right: 1em;
	}

	table.data th[colspan],
	table.data td[colspan] {
		text-align: center;
	}

	table.complex.data th,
	table.complex.data td {
		border: 1px solid silver;
		text-align: center;
	}

	table.data.longlastcol td:last-child,
	table.data td.long {
	 vertical-align: baseline;
	 text-align: left;
	}

	table.data img {
		vertical-align: middle;
	}


/*
Alternate table alignment rules

	table.data,
	table.index {
		text-align: center;
	}

	table.data  thead th[scope="row"],
	table.index thead th[scope="row"] {
		text-align: right;
	}

	table.data  tbody th:first-child,
	table.index tbody th:first-child  {
		text-align: right;
	}

Possible extra rowspan handling

	table.data  tbody th[rowspan]:not([rowspan='1']),
	table.index tbody th[rowspan]:not([rowspan='1']),
	table.data  tbody td[rowspan]:not([rowspan='1']),
	table.index tbody td[rowspan]:not([rowspan='1']) {
		border-left: 1px solid silver;
	}

	table.data  tbody th[rowspan]:first-child,
	table.index tbody th[rowspan]:first-child,
	table.data  tbody td[rowspan]:first-child,
	table.index tbody td[rowspan]:first-child{
		border-left: 0;
		border-right: 1px solid silver;
	}
*/

/******************************************************************************/
/*                                  Indices                                   */
/******************************************************************************/


/** Table of Contents *********************************************************/

	.toc a {
		/* More spacing; use padding to make it part of the click target. */
		padding-top: 0.1em;
		/* Larger, more consistently-sized click target */
		display: block;
		/* Reverse color scheme */
		color: black;
		border-color: #3980B5;
	}
	.toc a:visited {
		border-color: #054572;
	}
	.toc a:not(:focus):not(:hover) {
		/* Allow colors to cascade through from link styling */
		border-bottom-color: transparent;
	}

	.toc, .toc ol, .toc ul, .toc li {
		list-style: none; /* Numbers must be inlined into source */
		/* because generated content isn't search/selectable and markers can't do multilevel yet */
		margin:  0;
		padding: 0;
		line-height: 1.1rem; /* consistent spacing */
	}

	/* ToC not indented until third level, but font style & margins show hierarchy */
	.toc > li             { font-weight: bold;   }
	.toc > li li          { font-weight: normal; }
	.toc > li li li       { font-style:  italic; }
	.toc > li li li li    { font-style:  normal; }
	.toc > li li li li li { font-style:  italic;
	                        font-size:   85%;    }

	.toc > li             { margin: 1.5em 0;     }
	.toc > li li          { margin: 0.3rem 0;    }
	.toc > li li li       { margin-left: 2em;
	                        margin-left: 2rem;   }

	/* Section numbers in a column of their own */
	:not(li) > .toc {
		margin-left: 5em;
	}

	.toc .secno {
		float: left;
		width: 4em;
		white-space: nowrap;
	}
	.toc > li li li li .secno {
		font-size: 85%;
	}
	.toc > li li li li li .secno {
		font-size: 100%;
	}

	:not(li) > .toc              { margin-left:  5rem; }
	.toc .secno                  { margin-left: -5rem; }
	.toc > li li li .secno       { margin-left: -7rem; }
	.toc > li li li li .secno    { margin-left: -9rem; }
	.toc > li li li li li .secno { margin-left: -11rem; }

	/* Tighten up indentation in narrow ToCs */
	@media (max-width: 30em) {
		:not(li) > .toc              { margin-left:  4rem; }
		.toc .secno                  { margin-left: -4rem; }
		.toc > li li li              { margin-left:  1rem; }
		.toc > li li li .secno       { margin-left: -5rem; }
		.toc > li li li li .secno    { margin-left: -6rem; }
		.toc > li li li li li .secno { margin-left: -7rem; }
	}
	@media screen and (min-width: 78em) {
		body:not(.toc-inline) :not(li) > .toc              { margin-left:  4rem; }
		body:not(.toc-inline) .toc .secno                  { margin-left: -4rem; }
		body:not(.toc-inline) .toc > li li li              { margin-left:  1rem; }
		body:not(.toc-inline) .toc > li li li .secno       { margin-left: -5rem; }
		body:not(.toc-inline) .toc > li li li li .secno    { margin-left: -6rem; }
		body:not(.toc-inline) .toc > li li li li li .secno { margin-left: -7rem; }
	}
	body.toc-sidebar #toc :not(li) > .toc              { margin-left:  4rem; }
	body.toc-sidebar #toc .toc .secno                  { margin-left: -4rem; }
	body.toc-sidebar #toc .toc > li li li              { margin-left:  1rem; }
	body.toc-sidebar #toc .toc > li li li .secno       { margin-left: -5rem; }
	body.toc-sidebar #toc .toc > li li li li .secno    { margin-left: -6rem; }
	body.toc-sidebar #toc .toc > li li li li li .secno { margin-left: -7rem; }

	.toc li {
		clear: both;
	}


/** Index *********************************************************************/

	/* Index Lists: Layout */
	ul.index       { margin-left: 0; columns: 15em; -webkit-columns: 15em; -moz-columns: 15em; text-indent: 1em hanging; }
	ul.index li    { margin-left: 0; list-style: none; break-inside: avoid; }
	ul.index li li { margin-left: 1em }
	ul.index dl    { margin-top: 0; }
	ul.index dt    { margin: .2em 0 .2em 20px;}
	ul.index dd    { margin: .2em 0 .2em 40px;}
	/* Index Lists: Typography */
	ul.index ul,
	ul.index dl { font-size: smaller; }
	@media not print {
		ul.index li span {
			white-space: nowrap;
			color: transparent; }
		ul.index li a:hover + span,
		ul.index li a:focus + span {
			color: #707070;
		}
	}

/** Index Tables *****************************************************/
	/* See also the data table styling section, which this effectively subclasses */

	table.index {
		font-size: small;
		border-collapse: collapse;
		border-spacing: 0;
		text-align: left;
		margin: 1em 0;
	}

	table.index td,
	table.index th {
		padding: 0.4em;
	}

	table.index tr:hover td:not([rowspan]),
	table.index tr:hover th:not([rowspan]) {
		background: #f7f8f9;
	}

	/* The link in the first column in the property table (formerly a TD) */
	table.index th:first-child a {
		font-weight: bold;
	}

/******************************************************************************/
/*                                    Print                                   */
/******************************************************************************/

	@media print {
		/* Pages have their own margins. */
		html {
			margin: 0;
		}
		/* Serif for print. */
		body {
			font-family: serif;
		}
	}
	@page {
		margin: 1.5cm 1.1cm;
	}

/******************************************************************************/
/*                                    Legacy                                  */
/******************************************************************************/

	/* This rule is inherited from past style sheets. No idea what it's for. */
	.hide { display: none }



/******************************************************************************/
/*                             Overflow Control                               */
/******************************************************************************/

	.figure .caption, .sidefigure .caption, figcaption {
		/* in case figure is overlarge, limit caption to 50em */
		max-width: 50rem;
		margin-left: auto;
		margin-right: auto;
	}

	@media (min-width: 55em) {
		.overlarge {
			margin-left: calc(13px + 26.5rem - 50vw);
			margin-right: calc(13px + 26.5rem - 50vw);
			max-width: none;
		}
	}
	@media screen and (min-width: 78em) {
		body:not(.toc-inline) .overlarge {
			/* 30.5em body padding 50em content area */
			margin-left: calc(40em - 50vw) !important;
			margin-right: calc(40em - 50vw) !important;
		}
	}
	@media screen and (min-width: 90em) {
		body:not(.toc-inline) .overlarge {
			/* 4em html margin 30.5em body padding 50em content area */
			margin-left: 0 !important;
			margin-right: calc(84.5em - 100vw) !important;
		}
	}

	@media not print {
		.overlarge {
			overflow-x: auto;
			/* See Lea Verou's explanation background-attachment:
			 * http://lea.verou.me/2012/04/background-attachment-local/
			 *
			background: top left  / 4em 100% linear-gradient(to right,  #ffffff, rgba(255, 255, 255, 0)) local,
			            top right / 4em 100% linear-gradient(to left, #ffffff, rgba(255, 255, 255, 0)) local,
			            top left  / 1em 100% linear-gradient(to right,  #c3c3c5, rgba(195, 195, 197, 0)) scroll,
			            top right / 1em 100% linear-gradient(to left, #c3c3c5, rgba(195, 195, 197, 0)) scroll,
			            white;
			background-repeat: no-repeat;
			*/
		}
	}

/******************************************************************************/
/*                                  Bikeshed                                  */
/******************************************************************************/

	/* Style for paragraphs I know are in MD-genned lists */
	/* This is a weird hack for me not yet following the commonmark spec
	   regarding paragraph and lists. */
	[data-md] > :first-child {
		margin-top: 0;
	}
	[data-md] > :last-child {
		margin-bottom: 0;
	}

/** Inline CSS fragments ******************************************************/

	.css.css, .property.property, .descriptor.descriptor {
		color: #005a9c;
		font-size: inherit;
		font-family: inherit;
	}
	.css::before, .property::before, .descriptor::before {
		content: "‘";
	}
	.css::after, .property::after, .descriptor::after {
		content: "’";
	}
	.property, .descriptor {
		/* Don't wrap property and descriptor names */
		white-space: nowrap;
	}
	.type { /* CSS value <type> */
		font-style: italic;
	}
	pre .property::before, pre .property::after {
		content: "";
	}

/** Autolinks produced using Bikeshed *****************************************/

	[data-link-type="property"]::before,
	[data-link-type="propdesc"]::before,
	[data-link-type="descriptor"]::before,
	[data-link-type="value"]::before,
	[data-link-type="function"]::before,
	[data-link-type="at-rule"]::before,
	[data-link-type="selector"]::before,
	[data-link-type="maybe"]::before {
		content: "‘";
	}
	[data-link-type="property"]::after,
	[data-link-type="propdesc"]::after,
	[data-link-type="descriptor"]::after,
	[data-link-type="value"]::after,
	[data-link-type="function"]::after,
	[data-link-type="at-rule"]::after,
	[data-link-type="selector"]::after,
	[data-link-type="maybe"]::after {
		content: "’";
	}

	[data-link-type].production::before,
	[data-link-type].production::after,
	.prod [data-link-type]::before,
	.prod [data-link-type]::after {
		content: "";
	}

	[data-link-type=element],
	[data-link-type=element-attr] {
		font-family: Menlo, Consolas, "DejaVu Sans Mono", monospace;
		font-size: .9em;
	}
	[data-link-type=element]::before { content: "<" }
	[data-link-type=element]::after  { content: ">" }

	[data-link-type=biblio] {
		white-space: pre;
	}

/** Self-Links ****************************************************************/
/* Auto-generated links from an element to its own anchor, for usability */

	.heading, .issue, .note, .example, li, dt {
		position: relative;
	}
	a.self-link {
		position: absolute;
		top: 0;
		left: calc(-1 * (3.5rem - 26px));
		width: calc(3.5rem - 26px);
		height: 2em;
		text-align: center;
		border: none;
		transition: opacity .2s;
		opacity: .5;
	}
	a.self-link:hover {
		opacity: 1;
	}
	.heading > a.self-link {
		font-size: 83%;
	}
	dfn > a.self-link {
		top: auto;
		left: auto;
		opacity: 0;
		width: 1.5em;
		height: 1.5em;
		background: gray;
		color: white;
		font-style: normal;
		transition: opacity .2s, background-color .2s, color .2s;
	}
	dfn:hover > a.self-link {
		opacity: 1;
	}
	dfn > a.self-link:hover {
		color: black;
	}

	a.self-link::before            { content: "¶"; }
	.heading > a.self-link::before { content: "§"; }
	dfn > a.self-link::before      { content: "#"; }

/** Counters ******************************************************************/
/* Adds the auto-genned issue/example counters,
   until Bikeshed fills in manual ones. */
	.issue:not(.no-marker)::before {
		content: "Issue " counter(issue);
	}

	.example:not(.no-marker)::before {
		content: "Example";
		content: "Example " counter(example);
	}
	.invalid.example:not(.no-marker)::before,
	.illegal.example:not(.no-marker)::before {
		content: "Invalid Example";
		content: "Invalid Example" counter(example);
	}



/********************************************
 Remember to remove the logo section when copypasting freshly.
 */
</style>
  <meta content="Bikeshed 1.0.0" name="generator">
<style>
        .dfn-panel {
            display: inline-block;
            position: absolute;
            z-index: 35;
            height: auto;
            width: -webkit-fit-content;
            max-width: 300px;
            max-height: 500px;
            overflow: auto;
            padding: 0.5em 0.75em;
            font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
            background: #DDDDDD;
            color: black;
            border: outset 0.2em;
        }
        .dfn-panel:not(.on) { display: none; }
        .dfn-panel * { margin: 0; padding: 0; text-indent: 0; }
        .dfn-panel > b { display: block; }
        .dfn-panel a { color: black; }
        .dfn-panel a:not(:hover) { text-decoration: none !important; border-bottom: none !important; }
        .dfn-panel > b + b { margin-top: 0.25em; }
        .dfn-panel > span { display: list-item; list-style: inside; }
        .dfn-panel.activated {
            display: inline-block;
            position: fixed;
            left: .5em;
            bottom: .5em;
            margin: 0 auto;
            max-width: calc(100vw - 1.5em - .4em - .5em);
            max-height: 30vh;
        }

        .dfn-paneled { cursor: pointer; }
        </style>
 <body class="h-entry">
  <div class="head">
   <p data-fill-with="logo"></p>
   <h1 class="p-name no-ref" id="title">FIDO 2.0: Web API for accessing FIDO 2.0 credentials</h1>
   <h2 class="no-num no-toc no-ref heading settled" id="subtitle"><span class="content">Editor’s Draft, <time class="dt-updated" datetime="2016-03-14">14 March 2016</time></span></h2>
   <div data-fill-with="spec-metadata">
    <dl>
     <dt>This version:
     <dd><a class="u-url" href="http://w3c.github.io/webauthn/">http://w3c.github.io/webauthn/</a>
     <dt>Latest version:
     <dd><a href="http://www.w3.org/TR/webauthn/">http://www.w3.org/TR/webauthn/</a>
     <dt class="editor">Editors:
     <dd class="editor p-author h-card vcard"><a class="p-name fn u-email email" href="mailto:vijay.bharadwaj@microsoft.com">Vijay Bharadwaj</a> (<span class="p-org org">Microsoft</span>)
     <dd class="editor p-author h-card vcard"><a class="p-name fn u-email email" href="mailto:hlevangong@paypal.com">Hubert Le Van Gong</a> (<span class="p-org org">PayPal</span>)
     <dd class="editor p-author h-card vcard"><a class="p-name fn u-email email" href="mailto:balfanz@google.com">Dirk Balfanz</a> (<span class="p-org org">Google</span>)
     <dd class="editor p-author h-card vcard"><a class="p-name fn u-email email" href="mailto:aczeskis@google.com">Alexei Czeskis</a> (<span class="p-org org">Google</span>)
     <dd class="editor p-author h-card vcard"><a class="p-name fn u-email email" href="mailto:arnarb@google.com">Arnar Birgisson</a> (<span class="p-org org">Google</span>)
     <dd class="editor p-author h-card vcard"><a class="p-name fn u-email email" href="mailto:Jeff.Hodges@paypal.com">Jeff Hodges</a> (<span class="p-org org">PayPal</span>)
     <dd class="editor p-author h-card vcard"><a class="p-name fn u-email email" href="mailto:mbj@microsoft.com">Michael B. Jones</a> (<span class="p-org org">Microsoft</span>)
     <dd class="editor p-author h-card vcard"><a class="p-name fn u-email email" href="mailto:rolf@noknok.com">Rolf Lindemann</a> (<span class="p-org org">Nok Nok Labs</span>)
    </dl>
   </div>
   <div data-fill-with="warning"></div>
   <p class="copyright" data-fill-with="copyright"><a href="http://creativecommons.org/publicdomain/zero/1.0/" rel="license"><img alt="CC0" src="https://licensebuttons.net/p/zero/1.0/80x15.png"></a> To the extent possible under law, the editors have waived all copyright
and related or neighboring rights to this work.
In addition, as of 14 March 2016,
the editors have made this specification available under the <a href="http://www.openwebfoundation.org/legal/the-owf-1-0-agreements/owfa-1-0" rel="license">Open Web Foundation Agreement Version 1.0</a>,
which is available at http://www.openwebfoundation.org/legal/the-owf-1-0-agreements/owfa-1-0.
Parts of this work may be from another specification document.  If so, those parts are instead covered by the license of that specification document. </p>
   <hr title="Separator for header">
  </div>
  <h2 class="no-num no-toc no-ref heading settled" id="abstract"><span class="content">Abstract</span></h2>
  <div class="p-summary" data-fill-with="abstract">
   <p>This specification defines an API that enables web pages to access FIDO 2.0 compliant strong cryptographic credentials through browser script. Conceptually, credentials are stored on a FIDO 2.0 authenticator, and each credential is bound to a single Relying Party. Authenticators are responsible for ensuring that no operation is performed without the user’s consent. The user agent mediates access to credentials in order to preserve user privacy. FIDO uses the concept of attestation to provide a cryptographic proof of the authenticator model to the relying party.  The relying party can derive the authenticator security characteristics from this proof.</p>
  </div>
  <div data-fill-with="at-risk"></div>
  <nav data-fill-with="table-of-contents" id="toc">
   <h2 class="no-num no-toc no-ref" id="contents">Table of Contents</h2>
   <ol class="toc" role="directory">
    <li>
     <a href="#use-cases"><span class="secno">1</span> <span class="content">Use Cases</span></a>
     <ol class="toc">
      <li><a href="#registration-embedded"><span class="secno">1.1</span> <span class="content">Registration (embedded authenticator mode)</span></a>
      <li><a href="#authentication-external"><span class="secno">1.2</span> <span class="content">Authentication (external authenticator mode)</span></a>
      <li><a href="#other-configurations"><span class="secno">1.3</span> <span class="content">Other configurations</span></a>
     </ol>
    <li>
     <a href="#conformance"><span class="secno">2</span> <span class="content">Conformance</span></a>
     <ol class="toc">
      <li><a href="#dependencies"><span class="secno">2.1</span> <span class="content">Dependencies</span></a>
     </ol>
    <li>
     <a href="#authenticator-model"><span class="secno">3</span> <span class="content">FIDO Authenticator model</span></a>
     <ol class="toc">
      <li><a href="#op-make-cred"><span class="secno">3.1</span> <span class="content">The <span>authenticatorMakeCredential</span> operation</span></a>
      <li><a href="#op-get-assertion"><span class="secno">3.2</span> <span class="content">The <span>authenticatorGetAssertion</span> operation</span></a>
      <li><a href="#op-cancel"><span class="secno">3.3</span> <span class="content">The <span>authenticatorCancel</span> operation</span></a>
     </ol>
    <li>
     <a href="#api"><span class="secno">4</span> <span class="content">FIDO Credential API</span></a>
     <ol class="toc">
      <li>
       <a href="#iface-credential"><span class="secno">4.1</span> <span class="content"><span>FIDOCredentials</span> Interface</span></a>
       <ol class="toc">
        <li><a href="#makeCredential"><span class="secno">4.1.1</span> <span class="content">Create a new credential (<span>makeCredential()</span> method)</span></a>
        <li><a href="#getAssertion"><span class="secno">4.1.2</span> <span class="content">Use an existing credential (<span>getAssertion()</span> method)</span></a>
       </ol>
      <li><a href="#iface-credentialInfo"><span class="secno">4.2</span> <span class="content"><span>FIDOCredentialInfo</span> Interface</span></a>
      <li><a href="#iface-account"><span class="secno">4.3</span> <span class="content">User Account Information (dictionary <span>Account</span>)</span></a>
      <li><a href="#credential-params"><span class="secno">4.4</span> <span class="content">Parameters for Credential Generation (dictionary <span>FIDOCredentialParameters</span>)</span></a>
      <li>
       <a href="#supporting-data-structures"><span class="secno">4.5</span> <span class="content">Supporting Data Structures</span></a>
       <ol class="toc">
        <li><a href="#credentialType"><span class="secno">4.5.1</span> <span class="content">Credential Type enumeration (enum <span>CredentialType</span>)</span></a>
        <li><a href="#credential-identifier"><span class="secno">4.5.2</span> <span class="content">Unique Identifier for Credential (interface <span>Credential</span>)</span></a>
        <li><a href="#alg-identifier"><span class="secno">4.5.3</span> <span class="content">Cryptographic Algorithm Identifier (type <code class="idl"><span>AlgorithmIdentifier</span></code>)</span></a>
        <li><a href="#iface-assertion"><span class="secno">4.5.4</span> <span class="content">FIDO Assertion (interface <code class="idl"><span>FIDOAssertion</span></code>)</span></a>
        <li><a href="#iface-assertion-extensions"><span class="secno">4.5.5</span> <span class="content">FIDO Assertion Extensions (dictionary <span>FIDOExtensions</span>)</span></a>
        <li><a href="#iface-attestation-statement"><span class="secno">4.5.6</span> <span class="content">Key Attestation Statement (interface <span>AttestationStatement</span>)</span></a>
       </ol>
     </ol>
    <li>
     <a href="#signature-format"><span class="secno">5</span> <span class="content">Signature Format</span></a>
     <ol class="toc">
      <li><a href="#sec-client-data"><span class="secno">5.1</span> <span class="content">Client data</span></a>
      <li><a href="#sec-authenticator-data"><span class="secno">5.2</span> <span class="content">Authenticator data</span></a>
      <li><a href="#authenticator-signature"><span class="secno">5.3</span> <span class="content">Generating a signature</span></a>
      <li><a href="#fido-assertion"><span class="secno">5.4</span> <span class="content">Client encoding of assertions</span></a>
     </ol>
    <li>
     <a href="#attestation"><span class="secno">6</span> <span class="content">Key Attestation Format</span></a>
     <ol class="toc">
      <li>
       <a href="#attestation-overview"><span class="secno">6.1</span> <span class="content">Overview</span></a>
       <ol class="toc">
        <li><a href="#attestation-models"><span class="secno">6.1.1</span> <span class="content">Attestation Models</span></a>
        <li><a href="#attestation-contextual-data"><span class="secno">6.1.2</span> <span class="content">Contextual Data</span></a>
        <li><a href="#attestation-raw-data-types"><span class="secno">6.1.3</span> <span class="content">Attestation Raw Data Types</span></a>
       </ol>
      <li><a href="#attestation-statement"><span class="secno">6.2</span> <span class="content">Attestation Statement</span></a>
      <li>
       <a href="#attestation-client-encoding"><span class="secno">6.3</span> <span class="content">Client encoding of attestation statements</span></a>
       <ol class="toc">
        <li>
         <a href="#sec-attestationcore"><span class="secno">6.3.1</span> <span class="content">AttestationCore</span></a>
         <ol class="toc">
          <li><a href="#sec-attestation-client-data"><span class="secno">6.3.1.1</span> <span class="content">Client data</span></a>
         </ol>
        <li><a href="#sec-attestation-header"><span class="secno">6.3.2</span> <span class="content">AttestationHeader</span></a>
       </ol>
      <li>
       <a href="#defined-attestation-raw-data-types"><span class="secno">6.4</span> <span class="content">Defined Attestation Raw Data Types</span></a>
       <ol class="toc">
        <li>
         <a href="#packed-attestation"><span class="secno">6.4.1</span> <span class="content">Packed Attestation</span></a>
         <ol class="toc">
          <li><a href="#sec-raw-data-packed"><span class="secno">6.4.1.1</span> <span class="content">Attestation rawData (type="packed")</span></a>
          <li>
           <a href="#sec-extensions-for-packed-attestation-rawdata"><span class="secno">6.4.1.2</span> <span class="content">Extensions for Packed Attestation rawData</span></a>
           <ol class="toc">
            <li><a href="#aaguid-extension"><span class="secno">6.4.1.2.1</span> <span class="content">AAGUID Extension</span></a>
            <li><a href="#supported-extensions-extension"><span class="secno">6.4.1.2.2</span> <span class="content">SupportedExtensions Extension</span></a>
            <li><a href="#uvi-extension"><span class="secno">6.4.1.2.3</span> <span class="content">User Verification Index (UVI) Extension</span></a>
           </ol>
          <li><a href="#packed-attestation-signature"><span class="secno">6.4.1.3</span> <span class="content">Signature</span></a>
          <li><a href="#packed-attestation-cert-requirements"><span class="secno">6.4.1.4</span> <span class="content">Packed attestation statement certificate requirements</span></a>
         </ol>
        <li>
         <a href="#tpm-attestation"><span class="secno">6.4.2</span> <span class="content">TPM Attestation</span></a>
         <ol class="toc">
          <li><a href="#sec-raw-data-tpm"><span class="secno">6.4.2.1</span> <span class="content">Attestation rawData (type="tpm")</span></a>
          <li><a href="#tpm-attestation-signature"><span class="secno">6.4.2.2</span> <span class="content">Signature</span></a>
          <li><a href="#tpm-cert-requirements"><span class="secno">6.4.2.3</span> <span class="content">TPM attestation statement certificate requirements</span></a>
         </ol>
        <li>
         <a href="#android-attestation"><span class="secno">6.4.3</span> <span class="content">Android Attestation</span></a>
         <ol class="toc">
          <li><a href="#sec-attestation-android"><span class="secno">6.4.3.1</span> <span class="content">Attestation rawData (type="android")</span></a>
          <li><a href="#sec-android-attestation-signature"><span class="secno">6.4.3.2</span> <span class="content">Signature</span></a>
          <li><a href="#safetynet-conversion"><span class="secno">6.4.3.3</span> <span class="content">Converting SafetyNet response to attestationStatement</span></a>
          <li><a href="#sec-android-attestationclientdata"><span class="secno">6.4.3.4</span> <span class="content">AndroidAttestationClientData</span></a>
          <li><a href="#verifying-android-contextual-bindings"><span class="secno">6.4.3.5</span> <span class="content">Verifying AndroidClientData specific contextual bindings</span></a>
         </ol>
       </ol>
      <li><a href="#verifying-an-attestation-statement"><span class="secno">6.5</span> <span class="content">Verifying an Attestation Statement</span></a>
      <li>
       <a href="#sec-attestation-security-considerations"><span class="secno">6.6</span> <span class="content">Security Considerations</span></a>
       <ol class="toc">
        <li><a href="#sec-attestation-privacy"><span class="secno">6.6.1</span> <span class="content">Privacy</span></a>
        <li><a href="#ca-compromise"><span class="secno">6.6.2</span> <span class="content">Attestation Certificate and Attestation Certificate CA Compromise</span></a>
        <li><a href="#cert-hierarchy"><span class="secno">6.6.3</span> <span class="content">Attestation Certificate Hierarchy</span></a>
       </ol>
     </ol>
    <li>
     <a href="#extensions"><span class="secno">7</span> <span class="content">FIDO Extensions</span></a>
     <ol class="toc">
      <li><a href="#extension-id"><span class="secno">7.1</span> <span class="content">Extension identifiers</span></a>
      <li><a href="#extension-specification"><span class="secno">7.2</span> <span class="content">Defining extensions</span></a>
      <li><a href="#extension-request-parameters"><span class="secno">7.3</span> <span class="content">Extending request parameters</span></a>
      <li><a href="#extension-client-processing"><span class="secno">7.4</span> <span class="content">Extending client processing</span></a>
      <li><a href="#extension-authenticator-processing"><span class="secno">7.5</span> <span class="content">Extending authenticator processing with signature extensions</span></a>
      <li><a href="#sample-extensions"><span class="secno">7.6</span> <span class="content">Example extension</span></a>
     </ol>
    <li>
     <a href="#extension-standard"><span class="secno">8</span> <span class="content">Standard Extensions</span></a>
     <ol class="toc">
      <li><a href="#extension-txauth"><span class="secno">8.1</span> <span class="content">Transaction authorization</span></a>
      <li><a href="#extension-authenticator-selection"><span class="secno">8.2</span> <span class="content">Authenticator Selection Extension</span></a>
     </ol>
    <li><a href="#iana-considerations"><span class="secno">9</span> <span class="content">IANA Considerations</span></a>
    <li>
     <a href="#sample-scenarios"><span class="secno">10</span> <span class="content">Sample scenarios</span></a>
     <ol class="toc">
      <li><a href="#sample-registration"><span class="secno">10.1</span> <span class="content">Registration</span></a>
      <li><a href="#sample-authentication"><span class="secno">10.2</span> <span class="content">Authentication</span></a>
      <li><a href="#sample-decommissioning"><span class="secno">10.3</span> <span class="content">Decommissioning</span></a>
     </ol>
    <li><a href="#acknowledgements"><span class="secno">11</span> <span class="content">Acknowledgements</span></a>
    <li>
     <a href="#index"><span class="secno"></span> <span class="content">Index</span></a>
     <ol class="toc">
      <li><a href="#index-defined-here"><span class="secno"></span> <span class="content">Terms defined by this specification</span></a>
      <li><a href="#index-defined-elsewhere"><span class="secno"></span> <span class="content">Terms defined by reference</span></a>
     </ol>
    <li>
     <a href="#references"><span class="secno"></span> <span class="content">References</span></a>
     <ol class="toc">
      <li><a href="#normative"><span class="secno"></span> <span class="content">Normative References</span></a>
      <li><a href="#informative"><span class="secno"></span> <span class="content">Informative References</span></a>
     </ol>
    <li><a href="#idl-index"><span class="secno"></span> <span class="content">IDL Index</span></a>
   </ol>
  </nav>
  <main>
   <h2 class="heading settled" data-level="1" id="use-cases"><span class="secno">1. </span><span class="content">Use Cases</span><a class="self-link" href="#use-cases"></a></h2>
   <p><em>This section is not normative.</em></p>
   <p>This specification defines an API for web pages to access FIDO 2.0 credentials through JavaScript, for the purpose of strongly authenticating a user. FIDO 2.0 credentials are always bound to a single FIDO Relying Party, and the API respects this requirement. Credentials created by a Relying Party can only be accessed by web origins belonging to that Relying Party. Additionally, privacy across Relying Parties must be maintained; scripts must not be able to detect any properties, or even the existence, of credentials belonging to other Relying Parties.</p>
   <p>FIDO 2.0 credentials are located on authenticators, which can use them to perform operations subject to user consent. Broadly, authenticators are of two types:</p>
   <ol>
    <li><dfn data-dfn-type="dfn" data-noexport="" id="embedded-authenticators">Embedded authenticators<a class="self-link" href="#embedded-authenticators"></a></dfn> have their operation managed by the same computing device (e.g., smart phone, tablet, desktop PC) as the user agent is running on. For instance, such an authenticator might consist of a Trusted Platform Module (TPM) or Secure Element (SE) integrated into the computing device, along with appropriate platform software to mediate access to this device’s functionality.
    <li><dfn data-dfn-type="dfn" data-noexport="" id="external-authenticators">External authenticators<a class="self-link" href="#external-authenticators"></a></dfn> operate autonomously from the device running the user agent, and accessed over a transport such as Universal Serial Bus (USB), Bluetooth Low Energy (BLE) or Near Field Communications (NFC).
   </ol>
   <p>Note that an external authenticator may itself contain an embedded authenticator. For example, consider a smart phone that contains a FIDO 2.0 credential. The credential may be accessed by a web browser running on the phone itself. In this case the module containing the credential is functioning as an embedded authenticator. However, the credential may also be accessed over BLE by a user agent on a nearby laptop. In this latter case, the phone is functioning as an external authenticator. These modes may even be used in a single end-to-end user scenario. One such scenario is described in the remainder of this section.</p>
   <h3 class="heading settled" data-level="1.1" id="registration-embedded"><span class="secno">1.1. </span><span class="content">Registration (embedded authenticator mode)</span><a class="self-link" href="#registration-embedded"></a></h3>
   <ul>
    <li>
      On the phone: 
     <ul>
      <li>User goes to example.com in the browser, and signs in using whatever method they have been using (possibly a pre-FIDO method such as a password).
      <li>The phone prompts, "Do you want to register this device with example.com?"
      <li>User agrees.
      <li>The phone prompts the user for a previously configured authorization gesture (PIN, biometric, etc.); the user provides this.
      <li>Website shows message, "Registration complete."
     </ul>
   </ul>
   <h3 class="heading settled" data-level="1.2" id="authentication-external"><span class="secno">1.2. </span><span class="content">Authentication (external authenticator mode)</span><a class="self-link" href="#authentication-external"></a></h3>
   <ul>
    <li>
      On the laptop: 
     <ul>
      <li>User goes to example.com in browser, sees an option "Sign in with your phone."
      <li>User chooses this option and gets a message from the browser, "Please complete this action on your phone."
     </ul>
    <li>
      Next, on the phone: 
     <ul>
      <li>User sees a discreet prompt or notification, "Sign in to example.com."
      <li>User selects this prompt / notification.
      <li>User is shown a list of their example.com identities, e.g., "Sign in as Alice / Sign in as Bob."
      <li>User picks an identity, is prompted for an authorization gesture (PIN, biometric, etc.) and provides this.
     </ul>
    <li>
      Now, on the laptop: 
     <ul>
      <li>Web page shows that the selected user is signed in, and navigates to the signed-in page.
     </ul>
   </ul>
   <h3 class="heading settled" data-level="1.3" id="other-configurations"><span class="secno">1.3. </span><span class="content">Other configurations</span><a class="self-link" href="#other-configurations"></a></h3>
   <p>A variety of additional use cases and configurations are also possible, including (but not limited to):</p>
   <ul>
    <li>User goes to example.com on their laptop, is guided through a flow to create and register a credential on their phone.
    <li>User employs a FIDO 2.0 credential as described above to authorize a single transaction, such as a payment or other financial transaction.
   </ul>
   <h2 class="heading settled" data-level="2" id="conformance"><span class="secno">2. </span><span class="content">Conformance</span><a class="self-link" href="#conformance"></a></h2>
   <p>This specification defines criteria for a <dfn data-dfn-type="dfn" data-noexport="" id="conforming-user-agent">conforming user agent<a class="self-link" href="#conforming-user-agent"></a></dfn>. A user agent MUST behave as described in this specification in order to be considered conformant. User agents MAY implement algorithms given in this specification in any way desired, so long as the end result is indistinguishable from the result that would be obtained by the specification’s algorithms. A conforming FIDO Credential API user agent MUST also be a conforming implementation of the IDL fragments of this specification, as described in the “Web IDL” specification. <a data-link-type="biblio" href="#biblio-webidl-1">[WebIDL-1]</a></p>
   <p> The term <b>Base64url Encoding</b> refers to the base64 encoding using the URL- and filename-safe character set defined in Section 5 of <a data-link-type="biblio" href="#biblio-rfc4648">[RFC4648]</a>, with all trailing '=' characters omitted (as permitted by Section 3.2) and without the inclusion of any line breaks, whitespace, or other additional characters. This is the same encoding as used by JSON Web Signature (JWS) <a data-link-type="biblio" href="#biblio-rfc7515">[RFC7515]</a>.</p>
   <h3 class="heading settled" data-level="2.1" id="dependencies"><span class="secno">2.1. </span><span class="content">Dependencies</span><a class="self-link" href="#dependencies"></a></h3>
   <p>This specification relies on several other underlying specifications.</p>
   <dl>
    <dt>HTML5
    <dd>The concept of <dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="origin" data-noexport="" id="origin">origin<span class="dfn-panel" data-deco=""><b><a href="#origin">#origin</a></b><b>Referenced in:</b><span><a href="#ref-for-origin-1">4.1.1. Create a new credential (makeCredential() method)</a></span><span><a href="#ref-for-origin-2">4.1.2. Use an existing credential (getAssertion() method)</a></span></span></dfn> and the <dfn data-dfn-type="dfn" data-noexport="" id="window">Window<a class="self-link" href="#window"></a></dfn> interface are defined in <a data-link-type="biblio" href="#biblio-html5">[HTML5]</a>.
    <dt>Web IDL
    <dd>Many of the interface definitions and all of the IDL in this specification depend on <a data-link-type="biblio" href="#biblio-webidl-1">[WebIDL-1]</a>. This updated version of the Web IDL standard adds support for <dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="Promises" data-noexport="" id="promises">Promises<span class="dfn-panel" data-deco=""><b><a href="#promises">#promises</a></b><b>Referenced in:</b><span><a href="#ref-for-promises-1">4.1.1. Create a new credential (makeCredential() method)</a></span><span><a href="#ref-for-promises-2">4.1.2. Use an existing credential (getAssertion() method)</a></span></span></dfn>, which are now the preferred mechanism for asynchronous interaction in all new web APIs.
    <dt>DOM
    <dd><dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="DOMException" data-noexport="" id="domexception">DOMException<span class="dfn-panel" data-deco=""><b><a href="#domexception">#domexception</a></b><b>Referenced in:</b><span><a href="#ref-for-domexception-1">4.1.1. Create a new credential (makeCredential() method)</a></span><span><a href="#ref-for-domexception-2">4.1.2. Use an existing credential (getAssertion() method)</a></span></span></dfn> and the DOMException values used in this specification are defined in <a data-link-type="biblio" href="#biblio-dom4">[DOM4]</a>.
    <dt>Web Cryptography API
    <dd>The <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export="" data-lt="AlgorithmIdentifier" id="algorithmidentifier">AlgorithmIdentifier<span class="dfn-panel" data-deco=""><b><a href="#algorithmidentifier">#algorithmidentifier</a></b><b>Referenced in:</b><span><a href="#ref-for-algorithmidentifier-1">4. FIDO Credential API</a> <a href="#ref-for-algorithmidentifier-2">(2)</a></span><span><a href="#ref-for-algorithmidentifier-3">4.5.3. Cryptographic Algorithm Identifier (type AlgorithmIdentifier)</a></span></span></dfn> type and the method for normalizing an algorithm are defined in <a data-link-type="biblio" href="#biblio-webcryptoapi">[WebCryptoAPI]</a>.
    <dd><dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export="" data-lt="JsonWebKey" id="jsonwebkey">JsonWebKey<span class="dfn-panel" data-deco=""><b><a href="#jsonwebkey">#jsonwebkey</a></b><b>Referenced in:</b><span><a href="#ref-for-jsonwebkey-1">5.1. Client data</a></span><span><a href="#ref-for-jsonwebkey-2">6.4.3.4. AndroidAttestationClientData</a></span></span></dfn>: A cryptographic key as defined in <a data-link-type="biblio" href="#biblio-webcryptoapi">[WebCryptoAPI]</a>.
   </dl>
   <h2 class="heading settled" data-level="3" id="authenticator-model"><span class="secno">3. </span><span class="content">FIDO Authenticator model</span><a class="self-link" href="#authenticator-model"></a></h2>
   <p>The API defined in this specification implies a specific abstract functional model for a FIDO authenticator. This section describes the FIDO authenticator model. Client platforms may implement and expose this abstract model in any way desired. However, the behavior of the client’s FIDO Credential API implementation, when operating on the embedded and external authenticators supported by that platform, MUST be indistinguishable from the behavior specified in the <a href="#api">FIDO Credential API</a> section.</p>
   <p>In this abstract model, each FIDO authenticator stores some number of FIDO credentials. Each FIDO credential has an identifier which is unique (or extremely unlikely to be duplicated) among all FIDO credentials. Each credential is also associated with a FIDO Relying Party, whose identity is represented by a Relying Party Identifier (RP ID).</p>
   <p>A client must connect to a FIDO authenticator in order to invoke any of the operations of that authenticator. This connection defines an authenticator session. A FIDO authenticator must maintain isolation between sessions. It may do this by only allowing one session to exist at any particular time, or by providing more complicated session management.</p>
   <p>The following operations can be invoked by the client in an authenticator session.</p>
   <h3 class="heading settled" data-level="3.1" id="op-make-cred"><span class="secno">3.1. </span><span class="content">The <dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="authenticatorMakeCredential" data-noexport="" id="authenticatormakecredential">authenticatorMakeCredential<span class="dfn-panel" data-deco=""><b><a href="#authenticatormakecredential">#authenticatormakecredential</a></b><b>Referenced in:</b><span><a href="#ref-for-authenticatormakecredential-1">3.3. The authenticatorCancel operation</a> <a href="#ref-for-authenticatormakecredential-2">(2)</a></span><span><a href="#ref-for-authenticatormakecredential-3">4.1.1. Create a new credential (makeCredential() method)</a></span></span></dfn> operation</span><a class="self-link" href="#op-make-cred"></a></h3>
   <p>This operation must be invoked in an authenticator session which has no other operations in progress. It takes the following input parameters:</p>
   <ul>
    <li>The web origin of the script on whose behalf the operation is being initiated, as determined by the user agent and the client.
    <li>The RP ID corresponding to the above web origin, as determined by the user agent and the client.
    <li>All input parameters accepted by the <a data-link-type="functionish" href="#dom-fidocredentials-makecredential" id="ref-for-dom-fidocredentials-makecredential-1"><code>makeCredential()</code></a> method, specified below.
   </ul>
   <p>When this operation is invoked, the authenticator obtains user consent for creating a new credential. The prompt for obtaining this consent is shown by the authenticator if it has its own output capability, or by the user agent otherwise. Once user consent is obtained, the authenticator generates the appropriate cryptographic keys and creates a new credential. It then associates the credential with the specified RP ID such that it will be able to retrieve the RP ID later, given the credential ID.</p>
   <p>On successful completion of this operation, the authenticator returns the type and unique identifier of this new credential to the user agent.</p>
   <p>If the user refuses consent, the authenticator returns an  appropriate error status to the client.</p>
   <h3 class="heading settled" data-level="3.2" id="op-get-assertion"><span class="secno">3.2. </span><span class="content">The <dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="authenticatorGetAssertion" data-noexport="" id="authenticatorgetassertion">authenticatorGetAssertion<span class="dfn-panel" data-deco=""><b><a href="#authenticatorgetassertion">#authenticatorgetassertion</a></b><b>Referenced in:</b><span><a href="#ref-for-authenticatorgetassertion-1">3.3. The authenticatorCancel operation</a> <a href="#ref-for-authenticatorgetassertion-2">(2)</a></span><span><a href="#ref-for-authenticatorgetassertion-3">4.1.2. Use an existing credential (getAssertion() method)</a></span></span></dfn> operation</span><a class="self-link" href="#op-get-assertion"></a></h3>
   <p>This operation must be invoked in an authenticator session which has no other operations in progress. It takes the following input parameters:</p>
   <ul>
    <li>The web origin of the script on whose behalf the operation is being initiated, as determined by the user agent and the client.
    <li>The RP ID corresponding to the above web origin, as determined by the user agent and the client.
    <li>All input parameters accepted by the <a data-link-type="functionish" href="#dom-fidocredentials-getassertion" id="ref-for-dom-fidocredentials-getassertion-1"><code>getAssertion()</code></a> method, specified below.
   </ul>
   <p>When this method is invoked, the authenticator allows the user to select a credential from among the credentials associated with that Relying Party and matching the specified criteria, then obtains user consent for using that credential. The prompt for obtaining this consent may be shown by the authenticator if it has its own output capability, or by the user agent otherwise. Once a credential is selected and user consent is obtained, the authenticator computes a cryptographic signature using the credential’s private key and constructs an assertion as specified in <a href="#signature-format">§5 Signature Format</a>. It then returns this assertion to the user agent.</p>
   <p>If the authenticator cannot find any credential corresponding to the specified Relying Party that matches the specified criteria, it terminates the operation and returns an error.</p>
   <p>If the user refuses consent, the authenticator returns an appropriate error status to the client.</p>
   <h3 class="heading settled" data-level="3.3" id="op-cancel"><span class="secno">3.3. </span><span class="content">The <dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="authenticatorCancel" data-noexport="" id="authenticatorcancel">authenticatorCancel<span class="dfn-panel" data-deco=""><b><a href="#authenticatorcancel">#authenticatorcancel</a></b><b>Referenced in:</b><span><a href="#ref-for-authenticatorcancel-1">4.1.1. Create a new credential (makeCredential() method)</a> <a href="#ref-for-authenticatorcancel-2">(2)</a></span><span><a href="#ref-for-authenticatorcancel-3">4.1.2. Use an existing credential (getAssertion() method)</a> <a href="#ref-for-authenticatorcancel-4">(2)</a></span></span></dfn> operation</span><a class="self-link" href="#op-cancel"></a></h3>
   <p>This operation takes no input parameters and returns no result.</p>
   <p>When this operation is invoked by the client in an authenticator session, it has the effect of terminating any <a data-link-type="dfn" href="#authenticatormakecredential" id="ref-for-authenticatormakecredential-1"><code>authenticatorMakeCredential</code></a> or <a data-link-type="dfn" href="#authenticatorgetassertion" id="ref-for-authenticatorgetassertion-1"><code>authenticatorGetAssertion</code></a> operation currently in progress in that authenticator session. The authenticator stops prompting for, or accepting, any user input related to authorizing the canceled operation. The client ignores any further responses from the authenticator for the canceled operation.</p>
   <p>This operation is ignored if it is invoked in an authenticator session which does not have an <a data-link-type="dfn" href="#authenticatormakecredential" id="ref-for-authenticatormakecredential-2"><code>authenticatorMakeCredential</code></a> or <a data-link-type="dfn" href="#authenticatorgetassertion" id="ref-for-authenticatorgetassertion-2"><code>authenticatorGetAssertion</code></a> operation currently in progress.</p>
   <h2 class="heading settled" data-level="4" id="api"><span class="secno">4. </span><span class="content">FIDO Credential API</span><a class="self-link" href="#api"></a></h2>
   <p>This section normatively specifies the API for creating and using FIDO 2.0 credentials. Support for deleting credentials is deliberately omitted; this is expected to be done through platform-specific user interfaces rather than from a script. The basic idea is that the credentials belong to the user and are managed by the browser and underlying platform. Scripts can (with the user's consent) request the browser to create a new credential for future use by the script’s origin. Scripts can also request the user’s permission to perform authentication operations with an existing credential held by the platform. However, all such operations are mediated by the browser and/or platform on the user's behalf. At no point does the script get access to the credentials themselves; it only gets information about the credentials in the form of objects.</p>
   <p>User agents SHOULD only expose this API to callers in <dfn data-dfn-type="dfn" data-noexport="" id="secure-contexts">secure contexts<a class="self-link" href="#secure-contexts"></a></dfn>, as defined in <a data-link-type="biblio" href="#biblio-powerful-features">[powerful-features]</a>.</p>
   <p>In the future, this API may be integrated into a more general Web API framework for credential management, which is being worked on in the W3C. Such integration will, most likely, create intermediate interface and dictionary types, from which the types in this specification will then inherit. However the experience of the FIDO developer and end user will not be substantially changed by this. In the meantime, this specification is maintained in a more minimal form for ease of review.</p>
   <p>The API is defined by the following Web IDL fragment.</p>
<pre class="idl def">partial interface <a class="idl-code" data-link-type="interface" href="https://html.spec.whatwg.org/multipage/browsers.html#window">Window</a> { 
    readonly attribute <a data-link-type="idl-name" href="#fidocredentials" id="ref-for-fidocredentials-1">FIDOCredentials</a> <dfn class="idl-code" data-dfn-for="Window" data-dfn-type="attribute" data-export="" data-readonly="" data-type="FIDOCredentials " id="dom-window-fido">fido<a class="self-link" href="#dom-window-fido"></a></dfn>; 
}; 
   
interface <a class="idl-code" data-link-type="interface" href="#fidocredentials" id="ref-for-fidocredentials-2">FIDOCredentials</a> { 
    Promise &lt; <a data-link-type="idl-name" href="#fidocredentialinfo" id="ref-for-fidocredentialinfo-1">FIDOCredentialInfo</a> > <a class="idl-code" data-link-type="method" href="#dom-fidocredentials-makecredential" id="ref-for-dom-fidocredentials-makecredential-2">makeCredential</a> ( 
        <a data-link-type="idl-name" href="#dictdef-account" id="ref-for-dictdef-account-1">Account</a>                               <dfn class="idl-code" data-dfn-for="FIDOCredentials/makeCredential(accountInformation, cryptoParameters, attestationChallenge, credentialTimeoutSeconds, blacklist, credentialExtensions), FIDOCredentials/makeCredential(accountInformation, cryptoParameters, attestationChallenge, credentialTimeoutSeconds, blacklist), FIDOCredentials/makeCredential(accountInformation, cryptoParameters, attestationChallenge, credentialTimeoutSeconds), FIDOCredentials/makeCredential(accountInformation, cryptoParameters, attestationChallenge)" data-dfn-type="argument" data-export="" id="dom-fidocredentials-makecredential-accountinformation-cryptoparameters-attestationchallenge-credentialtimeoutseconds-blacklist-credentialextensions-accountinformation">accountInformation<a class="self-link" href="#dom-fidocredentials-makecredential-accountinformation-cryptoparameters-attestationchallenge-credentialtimeoutseconds-blacklist-credentialextensions-accountinformation"></a></dfn>, 
        sequence &lt; <a data-link-type="idl-name" href="#dictdef-fidocredentialparameters" id="ref-for-dictdef-fidocredentialparameters-1">FIDOCredentialParameters</a> > <dfn class="idl-code" data-dfn-for="FIDOCredentials/makeCredential(accountInformation, cryptoParameters, attestationChallenge, credentialTimeoutSeconds, blacklist, credentialExtensions), FIDOCredentials/makeCredential(accountInformation, cryptoParameters, attestationChallenge, credentialTimeoutSeconds, blacklist), FIDOCredentials/makeCredential(accountInformation, cryptoParameters, attestationChallenge, credentialTimeoutSeconds), FIDOCredentials/makeCredential(accountInformation, cryptoParameters, attestationChallenge)" data-dfn-type="argument" data-export="" id="dom-fidocredentials-makecredential-accountinformation-cryptoparameters-attestationchallenge-credentialtimeoutseconds-blacklist-credentialextensions-cryptoparameters">cryptoParameters<a class="self-link" href="#dom-fidocredentials-makecredential-accountinformation-cryptoparameters-attestationchallenge-credentialtimeoutseconds-blacklist-credentialextensions-cryptoparameters"></a></dfn>, 
        DOMString                             <dfn class="idl-code" data-dfn-for="FIDOCredentials/makeCredential(accountInformation, cryptoParameters, attestationChallenge, credentialTimeoutSeconds, blacklist, credentialExtensions), FIDOCredentials/makeCredential(accountInformation, cryptoParameters, attestationChallenge, credentialTimeoutSeconds, blacklist), FIDOCredentials/makeCredential(accountInformation, cryptoParameters, attestationChallenge, credentialTimeoutSeconds), FIDOCredentials/makeCredential(accountInformation, cryptoParameters, attestationChallenge)" data-dfn-type="argument" data-export="" id="dom-fidocredentials-makecredential-accountinformation-cryptoparameters-attestationchallenge-credentialtimeoutseconds-blacklist-credentialextensions-attestationchallenge">attestationChallenge<a class="self-link" href="#dom-fidocredentials-makecredential-accountinformation-cryptoparameters-attestationchallenge-credentialtimeoutseconds-blacklist-credentialextensions-attestationchallenge"></a></dfn>,
        optional unsigned long                <dfn class="idl-code" data-dfn-for="FIDOCredentials/makeCredential(accountInformation, cryptoParameters, attestationChallenge, credentialTimeoutSeconds, blacklist, credentialExtensions), FIDOCredentials/makeCredential(accountInformation, cryptoParameters, attestationChallenge, credentialTimeoutSeconds, blacklist), FIDOCredentials/makeCredential(accountInformation, cryptoParameters, attestationChallenge, credentialTimeoutSeconds), FIDOCredentials/makeCredential(accountInformation, cryptoParameters, attestationChallenge)" data-dfn-type="argument" data-export="" id="dom-fidocredentials-makecredential-accountinformation-cryptoparameters-attestationchallenge-credentialtimeoutseconds-blacklist-credentialextensions-credentialtimeoutseconds">credentialTimeoutSeconds<a class="self-link" href="#dom-fidocredentials-makecredential-accountinformation-cryptoparameters-attestationchallenge-credentialtimeoutseconds-blacklist-credentialextensions-credentialtimeoutseconds"></a></dfn>,
        optional sequence &lt; <a data-link-type="idl-name" href="#credential" id="ref-for-credential-1">Credential</a> >      <dfn class="idl-code" data-dfn-for="FIDOCredentials/makeCredential(accountInformation, cryptoParameters, attestationChallenge, credentialTimeoutSeconds, blacklist, credentialExtensions), FIDOCredentials/makeCredential(accountInformation, cryptoParameters, attestationChallenge, credentialTimeoutSeconds, blacklist), FIDOCredentials/makeCredential(accountInformation, cryptoParameters, attestationChallenge, credentialTimeoutSeconds), FIDOCredentials/makeCredential(accountInformation, cryptoParameters, attestationChallenge)" data-dfn-type="argument" data-export="" id="dom-fidocredentials-makecredential-accountinformation-cryptoparameters-attestationchallenge-credentialtimeoutseconds-blacklist-credentialextensions-blacklist">blacklist<a class="self-link" href="#dom-fidocredentials-makecredential-accountinformation-cryptoparameters-attestationchallenge-credentialtimeoutseconds-blacklist-credentialextensions-blacklist"></a></dfn>,
        optional <a data-link-type="idl-name" href="#dictdef-fidoextensions" id="ref-for-dictdef-fidoextensions-1">FIDOExtensions</a>               <dfn class="dfn-paneled idl-code" data-dfn-for="FIDOCredentials/makeCredential(accountInformation, cryptoParameters, attestationChallenge, credentialTimeoutSeconds, blacklist, credentialExtensions), FIDOCredentials/makeCredential(accountInformation, cryptoParameters, attestationChallenge, credentialTimeoutSeconds, blacklist), FIDOCredentials/makeCredential(accountInformation, cryptoParameters, attestationChallenge, credentialTimeoutSeconds), FIDOCredentials/makeCredential(accountInformation, cryptoParameters, attestationChallenge)" data-dfn-type="argument" data-export="" data-lt="credentialExtensions" id="dom-fidocredentials-makecredential-accountinformation-cryptoparameters-attestationchallenge-credentialtimeoutseconds-blacklist-credentialextensions-credentialextensions">credentialExtensions<span class="dfn-panel" data-deco=""><b><a href="#dom-fidocredentials-makecredential-accountinformation-cryptoparameters-attestationchallenge-credentialtimeoutseconds-blacklist-credentialextensions-credentialextensions">#dom-fidocredentials-makecredential-accountinformation-cryptoparameters-attestationchallenge-credentialtimeoutseconds-blacklist-credentialextensions-credentialextensions</a></b><b>Referenced in:</b><span><a href="#ref-for-dom-fidocredentials-makecredential-accountinformation-cryptoparameters-attestationchallenge-credentialtimeoutseconds-blacklist-credentialextensions-credentialextensions-1">7.3. Extending request parameters</a></span></span></dfn>
    ); 
   
    Promise &lt; <a data-link-type="idl-name" href="#fidoassertion" id="ref-for-fidoassertion-1">FIDOAssertion</a> > <a class="idl-code" data-link-type="method" href="#dom-fidocredentials-getassertion" id="ref-for-dom-fidocredentials-getassertion-2">getAssertion</a> ( 
        DOMString                        <dfn class="idl-code" data-dfn-for="FIDOCredentials/getAssertion(assertionChallenge, assertionTimeoutSeconds, whitelist, assertionExtensions), FIDOCredentials/getAssertion(assertionChallenge, assertionTimeoutSeconds, whitelist), FIDOCredentials/getAssertion(assertionChallenge, assertionTimeoutSeconds), FIDOCredentials/getAssertion(assertionChallenge)" data-dfn-type="argument" data-export="" id="dom-fidocredentials-getassertion-assertionchallenge-assertiontimeoutseconds-whitelist-assertionextensions-assertionchallenge">assertionChallenge<a class="self-link" href="#dom-fidocredentials-getassertion-assertionchallenge-assertiontimeoutseconds-whitelist-assertionextensions-assertionchallenge"></a></dfn>,
        optional unsigned long           <dfn class="idl-code" data-dfn-for="FIDOCredentials/getAssertion(assertionChallenge, assertionTimeoutSeconds, whitelist, assertionExtensions), FIDOCredentials/getAssertion(assertionChallenge, assertionTimeoutSeconds, whitelist), FIDOCredentials/getAssertion(assertionChallenge, assertionTimeoutSeconds), FIDOCredentials/getAssertion(assertionChallenge)" data-dfn-type="argument" data-export="" id="dom-fidocredentials-getassertion-assertionchallenge-assertiontimeoutseconds-whitelist-assertionextensions-assertiontimeoutseconds">assertionTimeoutSeconds<a class="self-link" href="#dom-fidocredentials-getassertion-assertionchallenge-assertiontimeoutseconds-whitelist-assertionextensions-assertiontimeoutseconds"></a></dfn>,
        optional sequence &lt; <a data-link-type="idl-name" href="#credential" id="ref-for-credential-2">Credential</a> > <dfn class="idl-code" data-dfn-for="FIDOCredentials/getAssertion(assertionChallenge, assertionTimeoutSeconds, whitelist, assertionExtensions), FIDOCredentials/getAssertion(assertionChallenge, assertionTimeoutSeconds, whitelist), FIDOCredentials/getAssertion(assertionChallenge, assertionTimeoutSeconds), FIDOCredentials/getAssertion(assertionChallenge)" data-dfn-type="argument" data-export="" id="dom-fidocredentials-getassertion-assertionchallenge-assertiontimeoutseconds-whitelist-assertionextensions-whitelist">whitelist<a class="self-link" href="#dom-fidocredentials-getassertion-assertionchallenge-assertiontimeoutseconds-whitelist-assertionextensions-whitelist"></a></dfn>, 
        optional <a data-link-type="idl-name" href="#dictdef-fidoextensions" id="ref-for-dictdef-fidoextensions-2">FIDOExtensions</a>          <dfn class="dfn-paneled idl-code" data-dfn-for="FIDOCredentials/getAssertion(assertionChallenge, assertionTimeoutSeconds, whitelist, assertionExtensions), FIDOCredentials/getAssertion(assertionChallenge, assertionTimeoutSeconds, whitelist), FIDOCredentials/getAssertion(assertionChallenge, assertionTimeoutSeconds), FIDOCredentials/getAssertion(assertionChallenge)" data-dfn-type="argument" data-export="" data-lt="assertionExtensions" id="dom-fidocredentials-getassertion-assertionchallenge-assertiontimeoutseconds-whitelist-assertionextensions-assertionextensions">assertionExtensions<span class="dfn-panel" data-deco=""><b><a href="#dom-fidocredentials-getassertion-assertionchallenge-assertiontimeoutseconds-whitelist-assertionextensions-assertionextensions">#dom-fidocredentials-getassertion-assertionchallenge-assertiontimeoutseconds-whitelist-assertionextensions-assertionextensions</a></b><b>Referenced in:</b><span><a href="#ref-for-dom-fidocredentials-getassertion-assertionchallenge-assertiontimeoutseconds-whitelist-assertionextensions-assertionextensions-1">7.3. Extending request parameters</a></span></span></dfn> 
    ); 
}; 
   
interface <a class="idl-code" data-link-type="interface" href="#fidocredentialinfo" id="ref-for-fidocredentialinfo-2">FIDOCredentialInfo</a> { 
    readonly attribute <a data-link-type="idl-name" href="#credential" id="ref-for-credential-3">Credential</a>           <dfn class="idl-code" data-dfn-for="FIDOCredentialInfo" data-dfn-type="attribute" data-export="" data-readonly="" data-type="Credential           " id="dom-fidocredentialinfo-credential">credential<a class="self-link" href="#dom-fidocredentialinfo-credential"></a></dfn>; 
    readonly attribute <a data-link-type="idl-name" href="#algorithmidentifier" id="ref-for-algorithmidentifier-1">AlgorithmIdentifier</a>  <dfn class="idl-code" data-dfn-for="FIDOCredentialInfo" data-dfn-type="attribute" data-export="" data-readonly="" data-type="AlgorithmIdentifier  " id="dom-fidocredentialinfo-algorithm">algorithm<a class="self-link" href="#dom-fidocredentialinfo-algorithm"></a></dfn>; 
    readonly attribute any                  <dfn class="idl-code" data-dfn-for="FIDOCredentialInfo" data-dfn-type="attribute" data-export="" data-readonly="" data-type="any                  " id="dom-fidocredentialinfo-publickey">publicKey<a class="self-link" href="#dom-fidocredentialinfo-publickey"></a></dfn>; 
    readonly attribute <a data-link-type="idl-name" href="#fidoassertion-attestationstatement" id="ref-for-fidoassertion-attestationstatement-1">AttestationStatement</a> <dfn class="idl-code" data-dfn-for="FIDOCredentialInfo" data-dfn-type="attribute" data-export="" data-readonly="" data-type="AttestationStatement " id="dom-fidocredentialinfo-attestation">attestation<a class="self-link" href="#dom-fidocredentialinfo-attestation"></a></dfn>; 
}; 

dictionary <a class="idl-code" data-link-type="dictionary" href="#dictdef-account" id="ref-for-dictdef-account-2">Account</a> { 
    required DOMString <dfn class="idl-code" data-dfn-for="Account" data-dfn-type="dict-member" data-export="" data-type="DOMString " id="dom-account-rpdisplayname">rpDisplayName<a class="self-link" href="#dom-account-rpdisplayname"></a></dfn>; 
    required DOMString <dfn class="idl-code" data-dfn-for="Account" data-dfn-type="dict-member" data-export="" data-type="DOMString " id="dom-account-displayname">displayName<a class="self-link" href="#dom-account-displayname"></a></dfn>; 
    DOMString          <dfn class="idl-code" data-dfn-for="Account" data-dfn-type="dict-member" data-export="" data-type="DOMString          " id="dom-account-name">name<a class="self-link" href="#dom-account-name"></a></dfn>; 
    DOMString          <dfn class="idl-code" data-dfn-for="Account" data-dfn-type="dict-member" data-export="" data-type="DOMString          " id="dom-account-id">id<a class="self-link" href="#dom-account-id"></a></dfn>; 
    DOMString          <dfn class="idl-code" data-dfn-for="Account" data-dfn-type="dict-member" data-export="" data-type="DOMString          " id="dom-account-imageuri">imageUri<a class="self-link" href="#dom-account-imageuri"></a></dfn>; 
};
   
dictionary <a class="idl-code" data-link-type="dictionary" href="#dictdef-fidocredentialparameters" id="ref-for-dictdef-fidocredentialparameters-2">FIDOCredentialParameters</a> { 
    required <a data-link-type="idl-name" href="#enumdef-credentialtype" id="ref-for-enumdef-credentialtype-1">CredentialType</a>        <dfn class="idl-code" data-dfn-for="FIDOCredentialParameters" data-dfn-type="dict-member" data-export="" data-type="CredentialType        " id="dom-fidocredentialparameters-type">type<a class="self-link" href="#dom-fidocredentialparameters-type"></a></dfn>; 
    required <a data-link-type="idl-name" href="#algorithmidentifier" id="ref-for-algorithmidentifier-2">AlgorithmIdentifier</a>   <dfn class="idl-code" data-dfn-for="FIDOCredentialParameters" data-dfn-type="dict-member" data-export="" data-type="AlgorithmIdentifier   " id="dom-fidocredentialparameters-algorithm">algorithm<a class="self-link" href="#dom-fidocredentialparameters-algorithm"></a></dfn>; 
}; 

enum <a class="idl-code" data-link-type="enum" href="#enumdef-credentialtype" id="ref-for-enumdef-credentialtype-2">CredentialType</a> { 
    <dfn class="idl-code" data-dfn-for="CredentialType" data-dfn-type="enum-value" data-export="" id="dom-credentialtype-fido">"FIDO"<a class="self-link" href="#dom-credentialtype-fido"></a></dfn> 
}; 

interface <a class="idl-code" data-link-type="interface" href="#credential" id="ref-for-credential-4">Credential</a> { 
    readonly attribute <a data-link-type="idl-name" href="#enumdef-credentialtype" id="ref-for-enumdef-credentialtype-3">CredentialType</a> <dfn class="idl-code" data-dfn-for="Credential" data-dfn-type="attribute" data-export="" data-readonly="" data-type="CredentialType " id="dom-credential-type">type<a class="self-link" href="#dom-credential-type"></a></dfn>; 
    readonly attribute DOMString      <dfn class="idl-code" data-dfn-for="Credential" data-dfn-type="attribute" data-export="" data-readonly="" data-type="DOMString      " id="dom-credential-id">id<a class="self-link" href="#dom-credential-id"></a></dfn>; 
};
  
dictionary <dfn class="dfn-paneled idl-code" data-dfn-type="dictionary" data-export="" data-lt="FIDOExtensions" id="dictdef-fidoextensions">FIDOExtensions<span class="dfn-panel" data-deco=""><b><a href="#dictdef-fidoextensions">#dictdef-fidoextensions</a></b><b>Referenced in:</b><span><a href="#ref-for-dictdef-fidoextensions-1">4. FIDO Credential API</a> <a href="#ref-for-dictdef-fidoextensions-2">(2)</a></span></span></dfn> {
};
</pre>
   <h3 class="heading settled" data-level="4.1" id="iface-credential"><span class="secno">4.1. </span><span class="content"><dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export="" data-lt="FIDOCredentials" id="fidocredentials">FIDOCredentials<span class="dfn-panel" data-deco=""><b><a href="#fidocredentials">#fidocredentials</a></b><b>Referenced in:</b><span><a href="#ref-for-fidocredentials-1">4. FIDO Credential API</a> <a href="#ref-for-fidocredentials-2">(2)</a></span></span></dfn> Interface</span><a class="self-link" href="#iface-credential"></a></h3>
   <p>This interface consists of the following methods.</p>
   <h4 class="heading settled" data-level="4.1.1" id="makeCredential"><span class="secno">4.1.1. </span><span class="content">Create a new credential (<dfn class="dfn-paneled idl-code" data-dfn-for="FIDOCredentials" data-dfn-type="method" data-export="" data-lt="makeCredential(accountInformation, cryptoParameters, attestationChallenge, credentialTimeoutSeconds, blacklist, credentialExtensions)|makeCredential(accountInformation, cryptoParameters, attestationChallenge, credentialTimeoutSeconds, blacklist)|makeCredential(accountInformation, cryptoParameters, attestationChallenge, credentialTimeoutSeconds)|makeCredential(accountInformation, cryptoParameters, attestationChallenge)" id="dom-fidocredentials-makecredential">makeCredential()<span class="dfn-panel" data-deco=""><b><a href="#dom-fidocredentials-makecredential">#dom-fidocredentials-makecredential</a></b><b>Referenced in:</b><span><a href="#ref-for-dom-fidocredentials-makecredential-1">3.1. The authenticatorMakeCredential operation</a></span><span><a href="#ref-for-dom-fidocredentials-makecredential-2">4. FIDO Credential API</a></span><span><a href="#ref-for-dom-fidocredentials-makecredential-3">6.4.3.5. Verifying AndroidClientData specific contextual bindings</a></span><span><a href="#ref-for-dom-fidocredentials-makecredential-4">7. FIDO Extensions</a> <a href="#ref-for-dom-fidocredentials-makecredential-5">(2)</a></span><span><a href="#ref-for-dom-fidocredentials-makecredential-6">7.2. Defining extensions</a></span><span><a href="#ref-for-dom-fidocredentials-makecredential-7">7.3. Extending request parameters</a> <a href="#ref-for-dom-fidocredentials-makecredential-8">(2)</a></span><span><a href="#ref-for-dom-fidocredentials-makecredential-9">8.2. Authenticator Selection Extension</a></span></span></dfn> method)</span><a class="self-link" href="#makeCredential"></a></h4>
   <p>With this method, a script can request the user agent to create a new credential of a given type and persist it to the underlying platform, which may involve data storage managed by the browser or the OS. The user agent will prompt the user to approve this operation. On success, the promise will be resolved with a <code class="idl"><a data-link-type="idl" href="#fidocredentialinfo" id="ref-for-fidocredentialinfo-3">FIDOCredentialInfo</a></code> object describing the newly created credential.</p>
   <p>This method takes the following parameters:</p>
   <ul>
    <li>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="accountInformation" data-noexport="" id="accountinformation">accountInformation<span class="dfn-panel" data-deco=""><b><a href="#accountinformation">#accountinformation</a></b><b>Referenced in:</b><span><a href="#ref-for-accountinformation-1">4.1.1. Create a new credential (makeCredential() method)</a></span></span></dfn> parameter specifies information about the user account for which the credential is being created. This is meant for later use by the authenticator when it needs to prompt the user to select a credential.
    <li>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="cryptoParameters" data-noexport="" id="cryptoparameters">cryptoParameters<span class="dfn-panel" data-deco=""><b><a href="#cryptoparameters">#cryptoparameters</a></b><b>Referenced in:</b><span><a href="#ref-for-cryptoparameters-1">4.1.1. Create a new credential (makeCredential() method)</a> <a href="#ref-for-cryptoparameters-2">(2)</a> <a href="#ref-for-cryptoparameters-3">(3)</a> <a href="#ref-for-cryptoparameters-4">(4)</a></span></span></dfn> parameter supplies information about the desired properties of the credential to be created. The sequence is ordered from most preferred to least preferred. The platform makes a best effort to create the most preferred credential that it can.
    <li>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="attestationChallenge" data-noexport="" id="attestationchallenge">attestationChallenge<span class="dfn-panel" data-deco=""><b><a href="#attestationchallenge">#attestationchallenge</a></b><b>Referenced in:</b><span><a href="#ref-for-attestationchallenge-1">4.1.1. Create a new credential (makeCredential() method)</a></span></span></dfn> parameter contains a challenge intended to be used for generating the attestation statement of the newly created credential.
    <li>The optional <dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="credentialTimeoutSeconds" data-noexport="" id="credentialtimeoutseconds">credentialTimeoutSeconds<span class="dfn-panel" data-deco=""><b><a href="#credentialtimeoutseconds">#credentialtimeoutseconds</a></b><b>Referenced in:</b><span><a href="#ref-for-credentialtimeoutseconds-1">4.1.1. Create a new credential (makeCredential() method)</a> <a href="#ref-for-credentialtimeoutseconds-2">(2)</a></span></span></dfn> parameter specifies a time, in seconds, that the caller is willing to wait for the call to complete. This is treated as a hint, and may be overridden by the platform.
    <li>The optional <dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="blacklist" data-noexport="" id="blacklist">blacklist<span class="dfn-panel" data-deco=""><b><a href="#blacklist">#blacklist</a></b><b>Referenced in:</b><span><a href="#ref-for-blacklist-1">4.1.1. Create a new credential (makeCredential() method)</a> <a href="#ref-for-blacklist-2">(2)</a></span></span></dfn> parameter is intended for use by Relying Parties that wish to limit the creation of multiple credentials for the same account on a single authenticator. The platform is requested to return an error if the new credential would be created on an authenticator that also contains one of the credentials enumerated in this parameter.
    <li>The optional <dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="credentialExtensions" data-noexport="" id="credentialextensions">credentialExtensions<span class="dfn-panel" data-deco=""><b><a href="#credentialextensions">#credentialextensions</a></b><b>Referenced in:</b><span><a href="#ref-for-credentialextensions-1">4.1.1. Create a new credential (makeCredential() method)</a></span></span></dfn> parameter contains additional parameters requesting additional processing by the client and authenticator. For example, the caller may request that only authenticators with certain capabilities be used to create the credential, or that additional information be returned in the attestation statement. Alternatively, the caller may specify an additional message that they would like the authenticator to display to the user. Extensions are defined in <a href="#signature-format">§5 Signature Format</a>.
   </ul>
   <p>When this method is invoked, the user agent MUST execute the following algorithm:</p>
   <p></p>
   <ol type="1">
    <li>If <a data-link-type="dfn" href="#credentialtimeoutseconds" id="ref-for-credentialtimeoutseconds-1"><code>credentialTimeoutSeconds</code></a> was specified, check if its value lies within a reasonable range as defined by the platform and if not, correct it to the closest value lying within that range. Set <var>adjustedTimeout</var> to this adjusted value. If <a data-link-type="dfn" href="#credentialtimeoutseconds" id="ref-for-credentialtimeoutseconds-2"><code>credentialTimeoutSeconds</code></a> was not specified then set <var>adjustedTimeout</var> to a platform-specific default.
    <li>Let <var>promise</var> be a new <a data-link-type="dfn" href="#promises" id="ref-for-promises-1">Promise</a>. Return <var>promise</var> and start a timer for <var>adjustedTimeout</var> seconds. Then asynchronously continue executing the following steps.
    <li>Set <var>callerOrigin</var> to the <a data-link-type="dfn" href="#origin" id="ref-for-origin-1"><code>origin</code></a> of the caller. Derive the RP ID from <var>callerOrigin</var> by computing the "public suffix + 1" or "PS+1" (which is also referred to as the "Effective Top-Level Domain plus One" or "eTLD+1") part of <var>callerOrigin</var> <a data-link-type="biblio" href="#biblio-psl">[PSL]</a>. Set <var>rpId</var> to the RP ID.
    <li>Initialize <var>issuedRequests</var> to an empty list.
    <li>
      Process each element of <a data-link-type="dfn" href="#cryptoparameters" id="ref-for-cryptoparameters-1"><code>cryptoParameters</code></a> using the following steps: 
     <ol type="a">
      <li>Let <var>current</var> be the currently selected element of <a data-link-type="dfn" href="#cryptoparameters" id="ref-for-cryptoparameters-2"><code>cryptoParameters</code></a>.
      <li>If <var>current.type</var> does not contain a <code class="idl"><a data-link-type="idl" href="#enumdef-credentialtype" id="ref-for-enumdef-credentialtype-4">CredentialType</a></code> supported by this implementation, then stop processing <var>current</var> and move on to the next element in <a data-link-type="dfn" href="#cryptoparameters" id="ref-for-cryptoparameters-3"><code>cryptoParameters</code></a>.
      <li>Let <var>normalizedAlgorithm</var> be the result of normalizing an algorithm using the procedure defined in <a data-link-type="biblio" href="#biblio-webcryptoapi">[WebCryptoAPI]</a>, with <var>alg</var> set to <var>current.algorithm</var> and <var>op</var> set to "generateKey". If an error occurs during this procedure, then stop processing <var>current</var> and move on to the next element in <a data-link-type="dfn" href="#cryptoparameters" id="ref-for-cryptoparameters-4"><code>cryptoParameters</code></a>.
     </ol>
    <li>If <a data-link-type="dfn" href="#blacklist" id="ref-for-blacklist-1"><code>blacklist</code></a> is undefined, set it to the empty list.
    <li>If <a data-link-type="dfn" href="#credentialextensions" id="ref-for-credentialextensions-1"><code>credentialExtensions</code></a> was specified, process any extensions supported by this client platform, to produce the extension data that needs to be sent to the authenticator. Call this data <var>clientExtensions</var>.
    <li>For each embedded or external authenticator currently available on this platform: asynchronously invoke the <a data-link-type="dfn" href="#authenticatormakecredential" id="ref-for-authenticatormakecredential-3"><code>authenticatorMakeCredential</code></a> operation on that authenticator with <var>callerOrigin</var>, <var>rpId</var>, <a data-link-type="dfn" href="#accountinformation" id="ref-for-accountinformation-1"><code>accountInformation</code></a>, <var>current.type</var>, <var>normalizedAlgorithm</var>, <a data-link-type="dfn" href="#blacklist" id="ref-for-blacklist-2"><code>blacklist</code></a>, <a data-link-type="dfn" href="#attestationchallenge" id="ref-for-attestationchallenge-1"><code>attestationChallenge</code></a> and <var>clientExtensions</var> as parameters. Add a corresponding entry to <var>issuedRequests</var>.
    <li>
      While <var>issuedRequests</var> is not empty, perform the following actions depending upon the <var>adjustedTimeout</var> timer and responses from the authenticators: 
     <ol type="a">
      <li>If the <var>adjustedTimeout</var> timer expires, then for each entry in <var>issuedRequests</var> invoke the <a data-link-type="dfn" href="#authenticatorcancel" id="ref-for-authenticatorcancel-1"><code>authenticatorCancel</code></a> operation on that authenticator and remove its entry from the list.
      <li>If any authenticator returns a status indicating that the user cancelled the operation, delete that authenticator’s entry from <var>issuedRequests</var>. For each remaining entry in <var>issuedRequests</var> invoke the <a data-link-type="dfn" href="#authenticatorcancel" id="ref-for-authenticatorcancel-2"><code>authenticatorCancel</code></a> operation on that authenticator and remove its entry from the list.
      <li>If any authenticator returns an error status, delete the corresponding entry from <var>issuedRequests</var>.
      <li>If any authenticator indicates success, create a new <code class="idl"><a data-link-type="idl" href="#fidocredentialinfo" id="ref-for-fidocredentialinfo-4">FIDOCredentialInfo</a></code> object named <var>value</var> and populate its fields with the values returned from the authenticator. Resolve <var>promise</var> with <var>value</var> and terminate this algorithm.
     </ol>
    <li>Resolve <var>promise</var> with a <a data-link-type="dfn" href="#domexception" id="ref-for-domexception-1"><code>DOMException</code></a> whose name is "<code>NotFoundError</code>", and terminate this algorithm.
   </ol>
   <p>During the above process, the user agent SHOULD show some UI to the user to guide them in the process of selecting and authorizing an authenticator.</p>
   <h4 class="heading settled" data-level="4.1.2" id="getAssertion"><span class="secno">4.1.2. </span><span class="content">Use an existing credential (<dfn class="dfn-paneled idl-code" data-dfn-for="FIDOCredentials" data-dfn-type="method" data-export="" data-lt="getAssertion(assertionChallenge, assertionTimeoutSeconds, whitelist, assertionExtensions)|getAssertion(assertionChallenge, assertionTimeoutSeconds, whitelist)|getAssertion(assertionChallenge, assertionTimeoutSeconds)|getAssertion(assertionChallenge)" id="dom-fidocredentials-getassertion">getAssertion()<span class="dfn-panel" data-deco=""><b><a href="#dom-fidocredentials-getassertion">#dom-fidocredentials-getassertion</a></b><b>Referenced in:</b><span><a href="#ref-for-dom-fidocredentials-getassertion-1">3.2. The authenticatorGetAssertion operation</a></span><span><a href="#ref-for-dom-fidocredentials-getassertion-2">4. FIDO Credential API</a></span><span><a href="#ref-for-dom-fidocredentials-getassertion-3">4.5.5. FIDO Assertion Extensions (dictionary FIDOExtensions)</a></span><span><a href="#ref-for-dom-fidocredentials-getassertion-4">7. FIDO Extensions</a> <a href="#ref-for-dom-fidocredentials-getassertion-5">(2)</a></span><span><a href="#ref-for-dom-fidocredentials-getassertion-6">7.2. Defining extensions</a></span><span><a href="#ref-for-dom-fidocredentials-getassertion-7">7.3. Extending request parameters</a> <a href="#ref-for-dom-fidocredentials-getassertion-8">(2)</a></span></span></dfn> method)</span><a class="self-link" href="#getAssertion"></a></h4>
   <p>This method is used to discover and use an existing FIDO 2.0 credential, with the user’s consent. The script optionally specifies some criteria to indicate what credentials are acceptable to it. The user agent and/or platform locates credentials matching the specified criteria, and guides the user to pick one that the script should be allowed to use. The user may choose not to provide a credential even if one is present, for example to maintain privacy.</p>
   <p>This method takes the following parameters:</p>
   <ul>
    <li>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="assertionChallenge" data-noexport="" id="assertionchallenge">assertionChallenge<span class="dfn-panel" data-deco=""><b><a href="#assertionchallenge">#assertionchallenge</a></b><b>Referenced in:</b><span><a href="#ref-for-assertionchallenge-1">4.1.2. Use an existing credential (getAssertion() method)</a></span></span></dfn> parameter contains a string that the selected authenticator is expected to sign to produce the assertion.
    <li>The optional <dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="assertionTimeoutSeconds" data-noexport="" id="assertiontimeoutseconds">assertionTimeoutSeconds<span class="dfn-panel" data-deco=""><b><a href="#assertiontimeoutseconds">#assertiontimeoutseconds</a></b><b>Referenced in:</b><span><a href="#ref-for-assertiontimeoutseconds-1">4.1.2. Use an existing credential (getAssertion() method)</a> <a href="#ref-for-assertiontimeoutseconds-2">(2)</a></span></span></dfn> parameter specifies a time, in seconds, that the caller is willing to wait for the call to complete. This is treated as a hint, and may be overridden by the platform.
    <li>The optional <dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="whitelist" data-noexport="" id="whitelist">whitelist<span class="dfn-panel" data-deco=""><b><a href="#whitelist">#whitelist</a></b><b>Referenced in:</b><span><a href="#ref-for-whitelist-1">4.1.2. Use an existing credential (getAssertion() method)</a> <a href="#ref-for-whitelist-2">(2)</a></span></span></dfn> member contains a list of credentials acceptable to the caller, in order of the caller’s preference.
    <li>The optional <dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="assertionExtensions" data-noexport="" id="assertionextensions">assertionExtensions<span class="dfn-panel" data-deco=""><b><a href="#assertionextensions">#assertionextensions</a></b><b>Referenced in:</b><span><a href="#ref-for-assertionextensions-1">4.1.2. Use an existing credential (getAssertion() method)</a></span></span></dfn> parameter contains additional parameters requesting additional processing by the client and authenticator. For example, if transaction confirmation is sought from the user, then the prompt string would be included in an extension. Extensions are defined in a companion specification.
   </ul>
   <p>When this method is invoked, the user agent MUST execute the following algorithm:</p>
   <p></p>
   <ol type="1">
    <li>If <a data-link-type="dfn" href="#assertiontimeoutseconds" id="ref-for-assertiontimeoutseconds-1"><code>assertionTimeoutSeconds</code></a> was specified, check if its value lies within a reasonable range as defined by the platform and if not, correct it to the closest value lying within that range. Set <var>adjustedTimeout</var> to this adjusted value. If <a data-link-type="dfn" href="#assertiontimeoutseconds" id="ref-for-assertiontimeoutseconds-2"><code>assertionTimeoutSeconds</code></a> was not specified then set <var>adjustedTimeout</var> to a platform-specific default.
    <li>Let <var>promise</var> be a new <a data-link-type="dfn" href="#promises" id="ref-for-promises-2">Promise</a>. Return <var>promise</var> and start a timer for <var>adjustedTimeout</var> seconds. Then asynchronously continue executing the following steps.
    <li>Set <var>callerOrigin</var> to the <a data-link-type="dfn" href="#origin" id="ref-for-origin-2"><code>origin</code></a> of the caller. Derive the RP ID from <var>callerOrigin</var> by computing the "public suffix + 1" or "PS+1" (which is also referred to as the "Effective Top-Level Domain plus One" or "eTLD+1") part of <var>callerOrigin</var> <a data-link-type="biblio" href="#biblio-psl">[PSL]</a>. Set <var>rpId</var> to the RP ID.
    <li>Initialize <var>issuedRequests</var> to an empty list.
    <li>If <a data-link-type="dfn" href="#assertionextensions" id="ref-for-assertionextensions-1"><code>assertionExtensions</code></a> was specified, process any extensions supported by this client platform, to produce the extension data that needs to be sent to the authenticator. Call this data <var>clientExtensions</var>.
    <li>
      For each embedded or external authenticator currently available on this platform, perform the following steps: 
     <ol type="a">
      <li>If <a data-link-type="dfn" href="#whitelist" id="ref-for-whitelist-1"><code>whitelist</code></a> is undefined or empty, let <var>credentialList</var> be a list containing a single wildcard entry.
      <li>If <a data-link-type="dfn" href="#whitelist" id="ref-for-whitelist-2"><code>whitelist</code></a> is defined and non-empty, optionally execute a platform-specific procedure to determine which of these credentials can possibly be present on this authenticator. Set <var>credentialList</var> to this filtered list. If <var>credentialList</var> is empty, ignore this authenticator and do not perform any of the following per-authenticator steps.
      <li>Asynchronously invoke the <a data-link-type="dfn" href="#authenticatorgetassertion" id="ref-for-authenticatorgetassertion-3"><code>authenticatorGetAssertion</code></a> operation on this authenticator with <var>callerOrigin</var>, <var>rpId</var>, <a data-link-type="dfn" href="#assertionchallenge" id="ref-for-assertionchallenge-1"><code>assertionChallenge</code></a>, <var>credentialList</var>, and <var>clientExtensions</var> as parameters.
      <li>Add an entry to <var>issuedRequests</var>, corresponding to this request.
     </ol>
    <li>
      While <var>issuedRequests</var> is not empty, perform the following actions depending upon the <var>adjustedTimeout</var> timer and responses from the authenticators: 
     <ol type="a">
      <li>If the timer for <var>adjustedTimeout</var> expires, then for each entry in <var>issuedRequests</var> invoke the <a data-link-type="dfn" href="#authenticatorcancel" id="ref-for-authenticatorcancel-3"><code>authenticatorCancel</code></a> operation on that authenticator and remove its entry from the list.
      <li>If any authenticator returns a status indicating that the user cancelled the operation, delete that authenticator’s entry from <var>issuedRequests</var>. For each remaining entry in <var>issuedRequests</var> invoke the <a data-link-type="dfn" href="#authenticatorcancel" id="ref-for-authenticatorcancel-4"><code>authenticatorCancel</code></a> operation on that authenticator, and remove its entry from the list.
      <li>If any authenticator returns an error status, delete the corresponding entry from <var>issuedRequests</var>.
      <li>If any authenticator returns success, create a new <code class="idl"><a data-link-type="idl" href="#fidoassertion" id="ref-for-fidoassertion-2">FIDOAssertion</a></code> object named <var>value</var> and populate its fields with the values returned from the authenticator. Resolve <var>promise</var> with <code>value</code> and terminate this algorithm.
     </ol>
    <li>Resolve <var>promise</var> with a <a data-link-type="dfn" href="#domexception" id="ref-for-domexception-2"><code>DOMException</code></a> whose name is "<code>NotFoundError</code>", and terminate this algorithm.
   </ol>
   <p>During the above process, the user agent SHOULD show some UI to the user to guide them in the process of selecting and authorizing an authenticator with which to complete the operation.</p>
   <h3 class="heading settled" data-level="4.2" id="iface-credentialInfo"><span class="secno">4.2. </span><span class="content"><dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export="" data-lt="FIDOCredentialInfo" id="fidocredentialinfo">FIDOCredentialInfo<span class="dfn-panel" data-deco=""><b><a href="#fidocredentialinfo">#fidocredentialinfo</a></b><b>Referenced in:</b><span><a href="#ref-for-fidocredentialinfo-1">4. FIDO Credential API</a> <a href="#ref-for-fidocredentialinfo-2">(2)</a></span><span><a href="#ref-for-fidocredentialinfo-3">4.1.1. Create a new credential (makeCredential() method)</a> <a href="#ref-for-fidocredentialinfo-4">(2)</a></span></span></dfn> Interface</span><a class="self-link" href="#iface-credentialInfo"></a></h3>
   <div>
    <p>This interface represents a newly-created FIDO credential. It contains information about the credential that can be used to locate it later for use, and also contains metadata that can be used by the FIDO Relying Party to assess the strength of the credential during registration.</p>
    <p>The <dfn data-dfn-for="FIDOCredentialInfo" data-dfn-type="dfn" data-noexport="" id="fidocredentialinfo-credential">credential<a class="self-link" href="#fidocredentialinfo-credential"></a></dfn> attribute contains a unique identifier for the credential represented by this object.</p>
    <p>The <dfn data-dfn-for="FIDOCredentialInfo" data-dfn-type="dfn" data-noexport="" id="fidocredentialinfo-algorithm">algorithm<a class="self-link" href="#fidocredentialinfo-algorithm"></a></dfn> attribute contains the cryptographic algorithm associated with the credential, in the format defined in <a data-link-type="biblio" href="#biblio-webcryptoapi">[WebCryptoAPI]</a>.</p>
    <p>The <dfn data-dfn-for="FIDOCredentialInfo" data-dfn-type="dfn" data-noexport="" id="fidocredentialinfo-publickey">publicKey<a class="self-link" href="#fidocredentialinfo-publickey"></a></dfn> attribute contains the public key associated with the credential, represented as a JsonWebKey structure as defined in <a data-link-type="biblio" href="#biblio-webcryptoapi">[WebCryptoAPI]</a>.</p>
    <p>The <dfn data-dfn-for="FIDOCredentialInfo" data-dfn-type="dfn" data-noexport="" id="fidocredentialinfo-attestation">attestation<a class="self-link" href="#fidocredentialinfo-attestation"></a></dfn> attribute contains a key attestation statement returned by the authenticator. This provides information about the credential and the authenticator it is held in, such as the level of security assurance provided by the authenticator.</p>
   </div>
   <h3 class="heading settled" data-level="4.3" id="iface-account"><span class="secno">4.3. </span><span class="content">User Account Information (dictionary <dfn class="dfn-paneled idl-code" data-dfn-type="dictionary" data-export="" data-lt="Account" id="dictdef-account">Account<span class="dfn-panel" data-deco=""><b><a href="#dictdef-account">#dictdef-account</a></b><b>Referenced in:</b><span><a href="#ref-for-dictdef-account-1">4. FIDO Credential API</a> <a href="#ref-for-dictdef-account-2">(2)</a></span></span></dfn>)</span><a class="self-link" href="#iface-account"></a></h3>
   <div>
    <p>This dictionary is used by the caller to specify information about the user account and Relying Party with which a credential is to be associated. It is intended to help the authenticator in providing a friendly credential selection interface for the user.</p>
    <p> The <dfn data-dfn-for="Account" data-dfn-type="dfn" data-noexport="" id="account-rpdisplayname">rpDisplayName<a class="self-link" href="#account-rpdisplayname"></a></dfn> member contains the friendly name of the Relying Party, such as "Google", "Microsoft" or "PayPal".</p>
    <p>The <dfn data-dfn-for="Account" data-dfn-type="dfn" data-noexport="" id="account-displayname">displayName<a class="self-link" href="#account-displayname"></a></dfn> member contains the friendly name associated with the user account by the Relying Party, such as "John P. Smith".</p>
    <p>The <dfn data-dfn-for="Account" data-dfn-type="dfn" data-noexport="" id="account-name">name<a class="self-link" href="#account-name"></a></dfn> member contains a detailed name for the account, such as "john.p.smith@example.com".</p>
    <p>The <dfn data-dfn-for="Account" data-dfn-type="dfn" data-noexport="" id="account-id">id<a class="self-link" href="#account-id"></a></dfn> member contains an identifier for the account, stored for the use of the Relying Party. This is not meant to be displayed to the user.</p>
    <p>The <dfn data-dfn-for="Account" data-dfn-type="dfn" data-noexport="" id="account-imageuri">imageUri<a class="self-link" href="#account-imageuri"></a></dfn> member contains a URI that resolves to the user’s account image. This may be a URL that can be used to retrieve the user’s current avatar, or a data URI that contains the image data.</p>
   </div>
   <h3 class="heading settled" data-level="4.4" id="credential-params"><span class="secno">4.4. </span><span class="content">Parameters for Credential Generation (dictionary <dfn class="dfn-paneled idl-code" data-dfn-type="dictionary" data-export="" data-lt="FIDOCredentialParameters" id="dictdef-fidocredentialparameters">FIDOCredentialParameters<span class="dfn-panel" data-deco=""><b><a href="#dictdef-fidocredentialparameters">#dictdef-fidocredentialparameters</a></b><b>Referenced in:</b><span><a href="#ref-for-dictdef-fidocredentialparameters-1">4. FIDO Credential API</a> <a href="#ref-for-dictdef-fidocredentialparameters-2">(2)</a></span></span></dfn>)</span><a class="self-link" href="#credential-params"></a></h3>
   <div>
    <p>This dictionary is used to supply additional parameters when creating a new credential.</p>
    <p>The <dfn data-dfn-for="FIDOCredentialParameters" data-dfn-type="dfn" data-noexport="" id="fidocredentialparameters-type">type<a class="self-link" href="#fidocredentialparameters-type"></a></dfn> member specifies the type of credential to be created.</p>
    <p>The <dfn data-dfn-for="FIDOCredentialParameters" data-dfn-type="dfn" data-noexport="" id="fidocredentialparameters-algorithm">algorithm<a class="self-link" href="#fidocredentialparameters-algorithm"></a></dfn> member specifies the cryptographic algorithm with which the newly generated credential will be used.</p>
   </div>
   <h3 class="heading settled" data-level="4.5" id="supporting-data-structures"><span class="secno">4.5. </span><span class="content">Supporting Data Structures</span><a class="self-link" href="#supporting-data-structures"></a></h3>
   <p>The FIDO credential type uses certain data structures that are specified in supporting specifications. These are as follows.</p>
   <h4 class="heading settled" data-level="4.5.1" id="credentialType"><span class="secno">4.5.1. </span><span class="content">Credential Type enumeration (enum <dfn class="dfn-paneled idl-code" data-dfn-type="enum" data-export="" data-lt="CredentialType" id="enumdef-credentialtype">CredentialType<span class="dfn-panel" data-deco=""><b><a href="#enumdef-credentialtype">#enumdef-credentialtype</a></b><b>Referenced in:</b><span><a href="#ref-for-enumdef-credentialtype-1">4. FIDO Credential API</a> <a href="#ref-for-enumdef-credentialtype-2">(2)</a> <a href="#ref-for-enumdef-credentialtype-3">(3)</a></span><span><a href="#ref-for-enumdef-credentialtype-4">4.1.1. Create a new credential (makeCredential() method)</a></span></span></dfn>)</span><a class="self-link" href="#credentialType"></a></h4>
   <div>
    <p>This enumeration defines the valid credential types. It is an extension point; values may be added to it in the future, as more credential types are defined. The values of this enumeration are used for versioning the FIDO assertion and attestation statement according to the type of the authenticator.</p>
    <p>Currently one credential type is defined, namely "<dfn data-dfn-for="CredentialType" data-dfn-type="dfn" data-noexport="" id="credentialtype-fido">FIDO<a class="self-link" href="#credentialtype-fido"></a></dfn>", the FIDO 2.0 credential type.</p>
   </div>
   <h4 class="heading settled" data-level="4.5.2" id="credential-identifier"><span class="secno">4.5.2. </span><span class="content">Unique Identifier for Credential (interface <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export="" data-lt="Credential" id="credential">Credential<span class="dfn-panel" data-deco=""><b><a href="#credential">#credential</a></b><b>Referenced in:</b><span><a href="#ref-for-credential-1">4. FIDO Credential API</a> <a href="#ref-for-credential-2">(2)</a> <a href="#ref-for-credential-3">(3)</a> <a href="#ref-for-credential-4">(4)</a></span><span><a href="#ref-for-credential-5">5.4. Client encoding of assertions</a></span></span></dfn>)</span><a class="self-link" href="#credential-identifier"></a></h4>
   <p>This interface contains the attributes that are returned to the caller when a new credential is created, and can be used later by the caller to select a credential for use.</p>
   <div>
    <p>The <dfn data-dfn-for="Credential" data-dfn-type="dfn" data-noexport="" id="credential-type">type<a class="self-link" href="#credential-type"></a></dfn> attribute indicates the specification and version that this credential conforms to.</p>
    <p>The <dfn data-dfn-for="Credential" data-dfn-type="dfn" data-noexport="" id="credential-id">id<a class="self-link" href="#credential-id"></a></dfn> attribute contains an identifier for the credential, chosen by the platform with help from the authenticator. This identifier is used to look up credentials for use, and is therefore expected to be globally unique with high probability across all credentials of the same type. This API does not constrain the format or length of this identifier, except that it must be sufficient for the platform to uniquely select a key. For example, an authenticator without on-board storage may create identifiers that consist of the key material wrapped with a key that is burned into the authenticator.</p>
   </div>
   <h4 class="heading settled" data-level="4.5.3" id="alg-identifier"><span class="secno">4.5.3. </span><span class="content">Cryptographic Algorithm Identifier (type <code class="idl"><a data-link-type="idl" href="#algorithmidentifier" id="ref-for-algorithmidentifier-3">AlgorithmIdentifier</a></code>)</span><a class="self-link" href="#alg-identifier"></a></h4>
   <p>A string or dictionary identifying a cryptographic algorithm and optionally a set of parameters for that algorithm. This type is defined in <a data-link-type="biblio" href="#biblio-webcryptoapi">[WebCryptoAPI]</a>.</p>
   <h4 class="heading settled" data-level="4.5.4" id="iface-assertion"><span class="secno">4.5.4. </span><span class="content">FIDO Assertion (interface <code class="idl"><a data-link-type="idl" href="#fidoassertion" id="ref-for-fidoassertion-3">FIDOAssertion</a></code>)</span><a class="self-link" href="#iface-assertion"></a></h4>
   <p>FIDO 2.0 credentials produce a cryptographic signature that provides proof of possession of a private key as well as evidence of user consent to a specific transaction. The structure of these signatures is defined in <a href="#fido-assertion">§5.4 Client encoding of assertions</a>.</p>
   <h4 class="heading settled" data-level="4.5.5" id="iface-assertion-extensions"><span class="secno">4.5.5. </span><span class="content">FIDO Assertion Extensions (dictionary <dfn data-dfn-type="dfn" data-noexport="" id="fidoextensions">FIDOExtensions<a class="self-link" href="#fidoextensions"></a></dfn>)</span><a class="self-link" href="#iface-assertion-extensions"></a></h4>
   <p>This is a dictionary containing zero or more extensions as defined in <a href="#extensions">§7 FIDO Extensions</a>. An extension is an additional parameter that can be passed to the <a data-link-type="functionish" href="#dom-fidocredentials-getassertion" id="ref-for-dom-fidocredentials-getassertion-3">getAssertion()</a> method and triggers some additional processing by the client platform and/or the authenticator.</p>
   <p> If the caller wants to pass extensions to the platform, it SHOULD do so by adding one
        entry per extension to this <code>FIDOExtensions</code> dictionary with 
        the extension identifier as the key, and the extension’s value as the value
        (see <a href="#signature-format">§5 Signature Format</a> for details). </p>
   <h4 class="heading settled" data-level="4.5.6" id="iface-attestation-statement"><span class="secno">4.5.6. </span><span class="content">Key Attestation Statement (interface <dfn data-dfn-type="dfn" data-noexport="" id="attestationstatement">AttestationStatement<a class="self-link" href="#attestationstatement"></a></dfn>)</span><a class="self-link" href="#iface-attestation-statement"></a></h4>
   <p>FIDO 2.0 authenticators also provide some form of key attestation. The basic requirement is that the authenticator can produce, for each credential public key, attestation information that can be verified by a Relying Party. Typically this information contains a signature by an attesting key over the attested public key and a challenge, as well as a certificate or similar information providing provenance information for the attesting key, enabling a trust decision to be made. The structure of these attestation statements is defined in <a data-link-type="biblio" href="#biblio-fidokeyattestation">[FIDOKeyAttestation]</a>.</p>
   <h2 class="heading settled" data-level="5" id="signature-format"><span class="secno">5. </span><span class="content">Signature Format</span><a class="self-link" href="#signature-format"></a></h2>
   <p>FIDO 2.0 signatures are bound to various contextual data. These data are
observed, and added at different levels of the stack as a signature request
passes from the server to the authenticator. In verifying a signature, the
server checks these bindings against expected values.</p>
   <p>The components of a system using FIDO 2.0 can be divided into three layers:</p>
   <ol>
    <li>The relying party (RP), which uses the FIDO 2.0 services.
  The relying party may, for
  example, be a web-application running in a browser, or a native application
  that runs directly on the OS platform.
    <li>The client platform, which consists of the user’s OS and device used to
  host the RP’s client-side app. For web-applications, the browser also belongs
  to this layer.
    <li>The authenticator itself, which provides key management and
  cryptographic signatures.
   </ol>
   <p>When the RP client-side application is a web-application, the interface between 1 and 2
is the <a href="#api">FIDO Credential API</a>, but is platform specific for native applications.
In cases where the authenticator is not tightly integrated with the platform, the interface
between 2 and 3 is a separately-defined protocol.
This specification defines the common signature format
shared by all layers.  This includes how the different contextual bindings are
encoded, signed over, and delivered to the RP.</p>
   <p>The goals of this design can be summarized as follows.</p>
   <ul>
    <li>The scheme for generating signatures should accommodate cases where the
  link between the client platform and authenticator is very limited, in
  bandwidth and/or latency. Examples include Bluetooth Low Energy and Near-Field
  Communication.
    <li>The data processed by the authenticator should be small and easy to
  interpret in low-level code. In particular, authenticators should not have to
  parse high-level encodings such as JSON.
    <li>Both the client platform and the authenticator should have the flexibility
  to add contextual bindings as needed.
    <li>The design aims to reuse as much as possible of existing encoding formats
  in order to aid adoption and implementation.
   </ul>
   <p>The contextual bindings are divided in two: Those added by the RP or the
client platform, referred to as <dfn data-dfn-type="dfn" data-noexport="" id="client-data">client data<a class="self-link" href="#client-data"></a></dfn>; and those added by the
authenticator, referred to as the <dfn data-dfn-type="dfn" data-noexport="" id="authenticator-data">authenticator data<a class="self-link" href="#authenticator-data"></a></dfn>.  The client
data must be signed over, but an authenticator is otherwise not interested in
its contents. To save bandwidth and processing requirements on the
authenticator, the client platform hashes the client data and sends only
the result to the authenticator. The authenticator signs over the combination
of this hash, and its own authenticator data.</p>
   <h3 class="heading settled" data-level="5.1" id="sec-client-data"><span class="secno">5.1. </span><span class="content">Client data</span><a class="self-link" href="#sec-client-data"></a></h3>
   <p>The client data represents the contextual bindings of both the RP and the
  client platform.  It is a key-value mapping with string-valued keys. Values may be
  any type that has a valid encoding in JSON.  It MUST contain at least the
  following key-value pairs.</p>
<pre class="idl def">dictionary <dfn class="dfn-paneled idl-code" data-dfn-type="dictionary" data-export="" data-lt="ClientData" id="dictdef-clientdata">ClientData<span class="dfn-panel" data-deco=""><b><a href="#dictdef-clientdata">#dictdef-clientdata</a></b><b>Referenced in:</b><span><a href="#ref-for-dictdef-clientdata-1">5.1. Client data</a> <a href="#ref-for-dictdef-clientdata-2">(2)</a></span><span><a href="#ref-for-dictdef-clientdata-3">6.4.3.4. AndroidAttestationClientData</a></span><span><a href="#ref-for-dictdef-clientdata-4">7. FIDO Extensions</a> <a href="#ref-for-dictdef-clientdata-5">(2)</a></span><span><a href="#ref-for-dictdef-clientdata-6">7.2. Defining extensions</a> <a href="#ref-for-dictdef-clientdata-7">(2)</a></span><span><a href="#ref-for-dictdef-clientdata-8">7.3. Extending request parameters</a></span><span><a href="#ref-for-dictdef-clientdata-9">7.4. Extending client processing</a> <a href="#ref-for-dictdef-clientdata-10">(2)</a></span></span></dfn> {
  DOMString       <dfn class="idl-code" data-dfn-for="ClientData" data-dfn-type="dict-member" data-export="" data-type="DOMString       " id="dom-clientdata-challenge">challenge<a class="self-link" href="#dom-clientdata-challenge"></a></dfn>;
  DOMString       <dfn class="idl-code" data-dfn-for="ClientData" data-dfn-type="dict-member" data-export="" data-type="DOMString       " id="dom-clientdata-facet">facet<a class="self-link" href="#dom-clientdata-facet"></a></dfn>;
  <a data-link-type="idl-name" href="#jsonwebkey" id="ref-for-jsonwebkey-1">JsonWebKey</a>      <dfn class="idl-code" data-dfn-for="ClientData" data-dfn-type="dict-member" data-export="" data-type="JsonWebKey      " id="dom-clientdata-tokenbinding">tokenBinding<a class="self-link" href="#dom-clientdata-tokenbinding"></a></dfn>;
  object          <dfn class="dfn-paneled idl-code" data-dfn-for="ClientData" data-dfn-type="dict-member" data-export="" data-lt="extensions" data-type="object          " id="dom-clientdata-extensions">extensions<span class="dfn-panel" data-deco=""><b><a href="#dom-clientdata-extensions">#dom-clientdata-extensions</a></b><b>Referenced in:</b><span><a href="#ref-for-dom-clientdata-extensions-1">7.4. Extending client processing</a></span></span></dfn>; // optional
  DOMString       <dfn class="dfn-paneled idl-code" data-dfn-for="ClientData" data-dfn-type="dict-member" data-export="" data-lt="hashAlg" data-type="DOMString       " id="dom-clientdata-hashalg">hashAlg<span class="dfn-panel" data-deco=""><b><a href="#dom-clientdata-hashalg">#dom-clientdata-hashalg</a></b><b>Referenced in:</b><span><a href="#ref-for-dom-clientdata-hashalg-1">5.1. Client data</a> <a href="#ref-for-dom-clientdata-hashalg-2">(2)</a></span></span></dfn>;
};
</pre>
   <div>
    <dl>
     <dt>DOMString <dfn data-dfn-for="ClientData" data-dfn-type="dfn" data-noexport="" id="clientdata-challenge">challenge<a class="self-link" href="#clientdata-challenge"></a></dfn>
     <dd> A base64url-encoded challenge provided by the RP. 
     <dt>DOMString <dfn data-dfn-for="ClientData" data-dfn-type="dfn" data-noexport="" id="clientdata-facet">facet<a class="self-link" href="#clientdata-facet"></a></dfn>
     <dd> A string value describing the RP identifier facet.
      When the RP client-side app is a website, this is its fully qualified web origin,
      using the syntax defined by <a data-link-type="biblio" href="#biblio-rfc6454">[RFC6454]</a>. When the client-side app is a native
      application, this string is a platform specific identifier. 
     <dt>JsonWebKey <dfn data-dfn-for="ClientData" data-dfn-type="dfn" data-noexport="" id="clientdata-tokenbinding">tokenBinding<a class="self-link" href="#clientdata-tokenbinding"></a></dfn>
     <dd> A JsonWebKey object <a data-link-type="biblio" href="#biblio-jwk">[JWK]</a> describing the public key that this client uses for
      the Token Binding protocol when communicating with the Relying Party.
      This can be omitted if no Token Binding has been negotiated between the
      client and the Relying Party. 
     <dt>optional object <dfn data-dfn-for="ClientData" data-dfn-type="dfn" data-noexport="" id="clientdata-extensions">extensions<a class="self-link" href="#clientdata-extensions"></a></dfn>
     <dd> An object with extension-provided authenticator data.
      Signature extensions are detailed in Section <a href="#extensions">§7 FIDO Extensions</a>. 
     <dt>DOMString <dfn data-dfn-for="ClientData" data-dfn-type="dfn" data-noexport="" id="clientdata-hashalg">hashAlg<a class="self-link" href="#clientdata-hashalg"></a></dfn>
     <dd> The hash algorithm used to compute clientDataHash 
      (see <a href="#authenticator-signature">§5.3 Generating a signature</a>).  Use "S256" for SHA-256, 
      "S384" for SHA384, "S512" for SHA512, and "SM3" for SM3 
      (see <a href="#iana-considerations">§9 IANA Considerations</a>). 
    </dl>
   </div>
   <p>The client data MAY contain additional properties.</p>
   <p>Before making a request to an authenticator, the
  client platform layer SHALL perform the following steps.</p>
   <ol>
    <li>Let <dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="clientDataJSON" data-noexport="" id="clientdatajson">clientDataJSON<span class="dfn-panel" data-deco=""><b><a href="#clientdatajson">#clientdatajson</a></b><b>Referenced in:</b><span><a href="#ref-for-clientdatajson-1">5.1. Client data</a></span><span><a href="#ref-for-clientdatajson-2">5.4. Client encoding of assertions</a></span><span><a href="#ref-for-clientdatajson-3">6.3.1. AttestationCore</a></span></span></dfn> be the UTF-8 encoded JSON serialization <a data-link-type="biblio" href="#biblio-rfc7159">[RFC7159]</a> of <code class="idl"><a data-link-type="idl" href="#dictdef-clientdata" id="ref-for-dictdef-clientdata-1">ClientData</a></code>.
    <li>Let <var>clientDataHash</var> be the hash (computed using <code class="idl"><a data-link-type="idl" href="#dom-clientdata-hashalg" id="ref-for-dom-clientdata-hashalg-1">hashAlg</a></code>) of <a data-link-type="dfn" href="#clientdatajson" id="ref-for-clientdatajson-1">clientDataJSON</a>, as an array.
   </ol>
   <p>The <var>clientDataHash</var> value is incorporated into a signature
  by a FIDO authenticator (see <a href="#authenticator-signature">§5.3 Generating a signature</a>).
  It is delivered to integrated authenticators
  in platform specific manners, and to external authenticators as a part of
  a signature request.
  The client platform SHOULD also preserve the exact <code>encodedClientData</code> string used to create it, for embedding in a signature object sent back to
  the RP (see <a href="#authenticator-signature">§5.3 Generating a signature</a>).
  This is necessary since multiple JSON encodings of the same client
  data are possible.</p>
   <p>The hash algorithm <code class="idl"><a data-link-type="idl" href="#dom-clientdata-hashalg" id="ref-for-dom-clientdata-hashalg-2">hashAlg</a></code> used to compute <var>clientDataHash</var> is 
    included in the <code class="idl"><a data-link-type="idl" href="#dictdef-clientdata" id="ref-for-dictdef-clientdata-2">ClientData</a></code> object. This way it is available to the RP and 
    it is also hashed over when computing <var>clientDataHash</var> and hence
    anchored in the signature itself. </p>
   <h3 class="heading settled" data-level="5.2" id="sec-authenticator-data"><span class="secno">5.2. </span><span class="content">Authenticator data</span><a class="self-link" href="#sec-authenticator-data"></a></h3>
   <p>The authenticator data encodes contextual bindings made by the
  authenticator itself. The authenticator data has a compact but extensible
  encoding. This is desired since authenticators can be devices with limited
  capabilities and low power requirements, with much simpler software stacks
  than the client platform components.</p>
   <p>The encoding of authenticator data is a byte array <code>authenticatorData</code> of 5 bytes or more, as follows.</p>
   <table class="complex data longlastcol">
    <tbody>
     <tr>
      <th>Byte index
      <th>Description
     <tr>
      <td>0
      <td>
       Flags (bit 0 is the least significant bit): 
       <ul>
        <li>Bit 0: Test of User Presence (<code>TUP</code>) result.
        <li>Bits 1-6: Reserved for future use (<code>RFU</code>).
        <li>Bit 7: Extension data included (<code>ED</code>). Indicates if the
          authenticator data has extensions.
       </ul>
     <tr>
      <td>1-4
      <td>Signature counter (<code>signCount</code>), 32-bit unsigned big-endian integer.
     <tr>
      <td>5-
      <td>Extension-defined authenticator data. This is a CBOR <a data-link-type="biblio" href="#biblio-rfc7049">[RFC7049]</a> map with extension
      identifiers as keys, and extension authenticator data values as values. See <a href="#extensions">§7 FIDO Extensions</a> for details.
   </table>
   <p>The <code>TUP</code> flag SHALL be set if and only if the authenticator
  detected a user through an authenticator specific gesture. The <code>RFU</code> bits in the flags byte SHALL be set to zero.</p>
   <p>If the authenticator does not include any extension data, it MUST set the <code>ED</code> flag in the first byte to zero, and to one if extension data
  is included.</p>
   <p>The figure below shows a visual representation of the
  authenticator data structure.</p>
   <figure>
     <img src="img/fido-signature-formats-figure1.svg"> 
    <figcaption><code>authenticatorData</code> layout.</figcaption>
   </figure>
   <p class="note" role="note"> The <code>signatureData</code> describes its own length: If the ED flag is not set, it
  is always 5 bytes long. If the ED flag is set, it is 5 bytes plus the CBOR map that follows. </p>
   <h3 class="heading settled" data-level="5.3" id="authenticator-signature"><span class="secno">5.3. </span><span class="content">Generating a signature</span><a class="self-link" href="#authenticator-signature"></a></h3>
   <p>A raw cryptographic signature must assert the integrity of both the
  client data and the authenticator data. Thus, an authenticator SHALL
  compute a signature over the concatenation of the <var>authenticatorData</var> and the <var>clientDataHash</var>. </p>
   <figure id="fig-signature">
     <img src="img/fido-signature-formats-figure2.svg"> 
    <figcaption>Generating a signature on the authenticator.</figcaption>
   </figure>
   <p class="note" role="note"> A simple, undelimited concatenation, is safe to use here because the <var>authenticatorData</var> describes its own length. The <var>clientDataHash</var> (which potentially has a variable length) 
    is always the last element. </p>
   <p> The authenticator MUST return both the <var>authenticatorData</var> and
    the raw signature back to the client. </p>
   <h3 class="heading settled" data-level="5.4" id="fido-assertion"><span class="secno">5.4. </span><span class="content">Client encoding of assertions</span><a class="self-link" href="#fido-assertion"></a></h3>
   <p>The client platform uses an authenticator assertion to construct
  the final {{FIDO assertion}} object returned to the RP as follows.</p>
<pre class="idl def">interface <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export="" data-lt="FIDOAssertion" id="fidoassertion">FIDOAssertion<span class="dfn-panel" data-deco=""><b><a href="#fidoassertion">#fidoassertion</a></b><b>Referenced in:</b><span><a href="#ref-for-fidoassertion-1">4. FIDO Credential API</a></span><span><a href="#ref-for-fidoassertion-2">4.1.2. Use an existing credential (getAssertion() method)</a></span><span><a href="#ref-for-fidoassertion-3">4.5.4. FIDO Assertion (interface FIDOAssertion)</a></span></span></dfn> {
  attribute <a data-link-type="idl-name" href="#credential" id="ref-for-credential-5">Credential</a> <dfn class="idl-code" data-dfn-for="FIDOAssertion" data-dfn-type="attribute" data-export="" data-type="Credential " id="dom-fidoassertion-credential">credential<a class="self-link" href="#dom-fidoassertion-credential"></a></dfn>;
  attribute DOMString  <dfn class="idl-code" data-dfn-for="FIDOAssertion" data-dfn-type="attribute" data-export="" data-type="DOMString  " id="dom-fidoassertion-clientdata">clientData<a class="self-link" href="#dom-fidoassertion-clientdata"></a></dfn>;
  attribute DOMString  <dfn class="dfn-paneled idl-code" data-dfn-for="FIDOAssertion" data-dfn-type="attribute" data-export="" data-lt="authenticatorData" data-type="DOMString  " id="dom-fidoassertion-authenticatordata">authenticatorData<span class="dfn-panel" data-deco=""><b><a href="#dom-fidoassertion-authenticatordata">#dom-fidoassertion-authenticatordata</a></b><b>Referenced in:</b><span><a href="#ref-for-dom-fidoassertion-authenticatordata-1">5.4. Client encoding of assertions</a></span></span></dfn>;
  attribute DOMString  <dfn class="idl-code" data-dfn-for="FIDOAssertion" data-dfn-type="attribute" data-export="" data-type="DOMString  " id="dom-fidoassertion-signature">signature<a class="self-link" href="#dom-fidoassertion-signature"></a></dfn>;
};
</pre>
   <div>
    <dl>
     <dt>attribute Credential <dfn data-dfn-for="FIDOAssertion" data-dfn-type="dfn" data-noexport="" id="fidoassertion-credential">credential<a class="self-link" href="#fidoassertion-credential"></a></dfn>
     <dd> An object representing which credential was used to generate an assertion. 
     <dt>attribute DOMString <dfn data-dfn-for="FIDOAssertion" data-dfn-type="dfn" data-noexport="" id="fidoassertion-clientdata">clientData<a class="self-link" href="#fidoassertion-clientdata"></a></dfn>
     <dd> A base64url encoding of <a data-link-type="dfn" href="#clientdatajson" id="ref-for-clientdatajson-2">clientDataJSON</a>.
      (See <a href="#sec-client-data">§5.1 Client data</a>) 
     <dt>attribute DOMString authenticatorData
     <dd> A base64url encoding of <code class="idl"><a data-link-type="idl" href="#dom-fidoassertion-authenticatordata" id="ref-for-dom-fidoassertion-authenticatordata-1">authenticatorData</a></code>.
      (See <a href="#sec-authenticator-data">§5.2 Authenticator data</a>) 
     <dt>attribute DOMString <dfn data-dfn-for="FIDOAssertion" data-dfn-type="dfn" data-noexport="" id="fidoassertion-signature">signature<a class="self-link" href="#fidoassertion-signature"></a></dfn>
     <dd> A base64url encoding of the raw signature returned from the authenticator.
      (See <a href="#authenticator-signature">§5.3 Generating a signature</a>) 
    </dl>
    <p>This assertion is delivered to the RP in either a platform specific manner, or
  in the case of web applications, according to the FIDO Web API (<a href="#api">§4 FIDO Credential API</a>).
  It contains all the information that the RP’s FIDO server requires to
  reconstruct the signature base string, as well as to decode and validate
  the bindings of both the client- and authenticator data.</p>
    <h2 class="heading settled" data-level="6" id="attestation"><span class="secno">6. </span><span class="content">Key Attestation Format</span><a class="self-link" href="#attestation"></a></h2>
    <p>This specification defines generic data structures that cover the
	semantics of FIDO Authenticator attestation. This specification also 
	provides a profile of these structures when a TPM <a data-link-type="biblio" href="#biblio-tpm">[TPM]</a> acts as a crypto kernel. 
	More profiles are expected to be added as the specification
	evolves.</p>
    <h3 class="heading settled" data-level="6.1" id="attestation-overview"><span class="secno">6.1. </span><span class="content">Overview</span><a class="self-link" href="#attestation-overview"></a></h3>
    <h4 class="heading settled" data-level="6.1.1" id="attestation-models"><span class="secno">6.1.1. </span><span class="content">Attestation Models</span><a class="self-link" href="#attestation-models"></a></h4>
    <p>FIDO 2.0 specifies multiple attestation models:</p>
    <dl>
     <dt>Full Basic Attestation
     <dd>
      In the case of full basic attestation <a data-link-type="biblio" href="#biblio-uafprotocol">[UAFProtocol]</a>, the Authenticator’s attestation private key is
	    specific to an Authenticator model.  That means that an Authenticator of the same model
	    typically shares the same attestation private key. 
      <p>This model is also used for FIDO UAF 1.0 and FIDO U2F 1.0.</p>
     <dt>Surrogate Basic Attestation
     <dd>In the case of surrogate basic attestation <a data-link-type="biblio" href="#biblio-uafprotocol">[UAFProtocol]</a>, the 
	    Authenticator doesn’t have any specific attestation key.  Instead it uses 
	    the authentication key to (self-)sign the (surrogate) attestation message.  
	    Authenticators without meaningful protection measures for an attestation private key
	    typically use this attestation model. 
     <dt>Privacy CA
     <dd>
      In this case, the authenticator owns an authenticator-specific (endorsement) key.  
	    This key is used to securely communicate with a trusted third party, 
	    the Privacy CA.  The Authenticator can generate
	    multiple attestation key pairs and asks the Privacy CA to issue an 
	    attestation certificate for it. 
      <p>Using this approach, the Authenticator can limit the exposure of the 
	      endorsement key (which is a global correlation handle) to Privacy CA(s).
	      Attestation keys can be requested for each FIDO credential individually. </p>
      <p class="note" role="note">This concept typically leads to multiple attestation certificates.
	      The attestation certificate requested most recently is called "active". </p>
     <dt>Direct Anonymous Attestation (DAA)
     <dd>
      In this case, the Authenticator receives DAA credentials from a single DAA-Issuer.
	    These DAA credentials are used along with blinding to sign the attestation data.
	    The concept of blinding avoids the DAA credentials being misused as global correlation handle. 
      <p>FIDO 2.0 supports DAA using elliptic curve cryptography and bilinear pairings, 
	      called ECDAA (see <a data-link-type="biblio" href="#biblio-fidoecdaaalgorithm">[FIDOEcdaaAlgorithm]</a>) in this specification.</p>
    </dl>
    <p>Compliant FIDO Servers MUST support all attestation models.  
	  Authenticators can choose what attestation model to implement. </p>
    <p class="note" role="note">Relying parties can always decide what attestation models are acceptable by policy. </p>
    <h4 class="heading settled" data-level="6.1.2" id="attestation-contextual-data"><span class="secno">6.1.2. </span><span class="content">Contextual Data</span><a class="self-link" href="#attestation-contextual-data"></a></h4>
    <p>FIDO 2.0 attestation statements are bound to various contextual data. These data are
	  observed, and added at different levels of the stack as a signature request
	  passes from the server to the authenticator. In verifying a signature, the
	  server checks these bindings against expected values.</p>
    <p>These components can be divided into three layers:</p>
    <ol>
     <li>The relying party (RP) consists of two subcomponents: an online
	    service and a client-side application. The client-side app may, for
	    example, be a web application running in a browser, or a native application
	    that runs directly on the OS platform.
     <li>The client platform, which consists of the user’s OS and device used to
	    host the RP’s client-side app. For web applications, the browser also belongs
	    to this layer.
     <li>The authenticator itself, which provides key generation and key management and
	    cryptographic signatures.
    </ol>
    <p>The goals of this design can be summarized as follows. </p>
    <ul>
     <li>The scheme for generating keys and attestation statements should accommodate cases where the
	      link between the client platform and authenticator is very limited, in
	      bandwidth and/or latency. Examples include Bluetooth Low Energy and Near-Field
	      Communication.
     <li>The data processed by the authenticator should be small and easy to
	      interpret in low-level code. In particular, authenticators should not have to
	      parse high-level encodings such as JSON.
     <li>Both the client platform and the authenticator should have the flexibility
	      to add contextual bindings, as needed.
     <li>The design aims to reuse existing encoding formats as much as possible
	      to aid adoption and implementation.
    </ul>
    <p></p>
    <p> There are two kinds of contextual bindings:
	  Those added by the RP or the client platform,
	  referred to as <dfn data-dfn-for="FIDOAssertion" data-dfn-type="dfn" data-noexport="" id="fidoassertion-client-data">client data<a class="self-link" href="#fidoassertion-client-data"></a></dfn> (see <a href="#signature-format">§5 Signature Format</a>)
	  and those added by the
	  authenticator, referred to as the <dfn data-dfn-for="FIDOAssertion" data-dfn-type="dfn" data-noexport="" id="fidoassertion-attestation-data">attestation data<a class="self-link" href="#fidoassertion-attestation-data"></a></dfn>.  The client
	  data must be signed over, but an authenticator is otherwise not interested in
	  its contents.  More specifically, the authenticator cannot attest to the correctness of such data.
	  To save bandwidth and processing requirements on the
	  authenticator, the client platform hashes the client data and sends only
	  the hash result to the authenticator. The authenticator attestation statement includes the combination
	  of this hash, and its own attestation data. </p>
    <h4 class="heading settled" data-level="6.1.3" id="attestation-raw-data-types"><span class="secno">6.1.3. </span><span class="content">Attestation Raw Data Types</span><a class="self-link" href="#attestation-raw-data-types"></a></h4>
    <p> FIDO specifies pluggable attestation raw data types, i.e., 
	  ways to serialize the data being attested to by the authenticator.
	  The reason is to be able to support existing devices like TPMs and other
	  platform-specific formats. </p>
    <p>Each attestation type provides the ability to cryptographically attest to a public key, the
	  authenticator model, and contextual data to a remote party. </p>
    <p>Attestation raw data types are orthogonal to attestation models, i.e. 
	  attestation raw data types in general are not restricted to a single attestation model. </p>
    <h3 class="heading settled" data-level="6.2" id="attestation-statement"><span class="secno">6.2. </span><span class="content">Attestation Statement</span><a class="self-link" href="#attestation-statement"></a></h3>
    <p>When an attestation statement is required for an Authenticator, the client
	needs to ask the Authenticator to generate one. This section describes the
	attestation statement data structures. Attestation statements
	can also include some host and other Authenticator information. </p>
    <p>The attestation statement consists of</p>
    <ol>
     <li>the <code>header</code> object, containing the signing algorithm and 
	  additional information required to verify the attestation signature. 
     <li>the <code>core</code> object, containing the attested data.  This object
	  is a container and can carry multiple, authenticator model specific, 
	  attestation rawData types (see section <a href="#defined-attestation-raw-data-types">§6.4 Defined Attestation Raw Data Types</a>). 
     <li>the <code>signature</code> object.  This object contains the cryptographic
	  signature computed over the <code>rawData</code> object.  
	  The structure of this object depends on the signature algorithm. 
    </ol>
    <h3 class="heading settled" data-level="6.3" id="attestation-client-encoding"><span class="secno">6.3. </span><span class="content">Client encoding of attestation statements</span><a class="self-link" href="#attestation-client-encoding"></a></h3>
    <p>The client platform uses an authenticator generated 
	  attestation signature (<code>signature</code>) and the 
	  authenticator generated <code>rawData</code> object to construct
	  the final attestation statement object (which will be returned to the RP). 
	  This attestation statement is encoded as: </p>
<pre class="idl def">interface <dfn class="dfn-paneled idl-code" data-dfn-for="FIDOAssertion" data-dfn-type="interface" data-export="" data-lt="AttestationStatement" id="fidoassertion-attestationstatement">AttestationStatement<span class="dfn-panel" data-deco=""><b><a href="#fidoassertion-attestationstatement">#fidoassertion-attestationstatement</a></b><b>Referenced in:</b><span><a href="#ref-for-fidoassertion-attestationstatement-1">4. FIDO Credential API</a></span></span></dfn> {
    readonly    attribute <a data-link-type="idl-name" href="#fidoassertion-attestationheader" id="ref-for-fidoassertion-attestationheader-1">AttestationHeader</a> <dfn class="idl-code" data-dfn-for="AttestationStatement" data-dfn-type="attribute" data-export="" data-readonly="" data-type="AttestationHeader " id="dom-attestationstatement-header">header<a class="self-link" href="#dom-attestationstatement-header"></a></dfn>;
    readonly    attribute <a data-link-type="idl-name" href="#fidoassertion-attestationcore" id="ref-for-fidoassertion-attestationcore-1">AttestationCore</a>   <dfn class="idl-code" data-dfn-for="AttestationStatement" data-dfn-type="attribute" data-export="" data-readonly="" data-type="AttestationCore   " id="dom-attestationstatement-core">core<a class="self-link" href="#dom-attestationstatement-core"></a></dfn>;
    readonly    attribute DOMString         <dfn class="idl-code" data-dfn-for="AttestationStatement" data-dfn-type="attribute" data-export="" data-readonly="" data-type="DOMString         " id="dom-attestationstatement-signature">signature<a class="self-link" href="#dom-attestationstatement-signature"></a></dfn>;
};
</pre>
    <dl>
     <dt>readonly attribute AttestationHeader <dfn data-dfn-for="AttestationStatement" data-dfn-type="dfn" data-noexport="" id="attestationstatement-header">header<a class="self-link" href="#attestationstatement-header"></a></dfn>
     <dd>Attestation header, including algorithm, (optionally) the claimed AAGUID 
	    and (optionally) the attestation certificate chain. 
     <dt>readonly attribute AttestationCore <dfn data-dfn-for="AttestationStatement" data-dfn-type="dfn" data-noexport="" id="attestationstatement-core">core<a class="self-link" href="#attestationstatement-core"></a></dfn>
     <dd>AttestationCore object.  This object includes the attested <code>rawData</code> and 
	    its <code>type</code> and <code>version</code>.
     <dt>readonly attribute DOMString <dfn data-dfn-for="AttestationStatement" data-dfn-type="dfn" data-noexport="" id="attestationstatement-signature">signature<a class="self-link" href="#attestationstatement-signature"></a></dfn>
     <dd>The base64url-encoded attestation signature.  The structure of this 
	    object depends on the signature algorithm specified in the header. 
    </dl>
    <p>This attestation statement is delivered to the RP according to the Client API.
	  It contains all the information that the RP’s FIDO server requires to
	  reconstruct the signature base string, as well as to decode and validate
	  the bindings of both the client- and authenticator data. </p>
    <h4 class="heading settled" data-level="6.3.1" id="sec-attestationcore"><span class="secno">6.3.1. </span><span class="content">AttestationCore</span><a class="self-link" href="#sec-attestationcore"></a></h4>
    <p>Data attested by the Authenticator and description of its structure.
	Different types of Authenticators might generate different object types 
	(identified by <code>type</code> and <code>version</code>).</p>
<pre class="idl def">interface <dfn class="dfn-paneled idl-code" data-dfn-for="FIDOAssertion" data-dfn-type="interface" data-export="" data-lt="AttestationCore" id="fidoassertion-attestationcore">AttestationCore<span class="dfn-panel" data-deco=""><b><a href="#fidoassertion-attestationcore">#fidoassertion-attestationcore</a></b><b>Referenced in:</b><span><a href="#ref-for-fidoassertion-attestationcore-1">6.3. Client encoding of attestation statements</a></span></span></dfn> {
    readonly    attribute DOMString     <dfn class="idl-code" data-dfn-for="AttestationCore" data-dfn-type="attribute" data-export="" data-readonly="" data-type="DOMString     " id="dom-attestationcore-type">type<a class="self-link" href="#dom-attestationcore-type"></a></dfn>;
    readonly    attribute unsigned long <dfn class="idl-code" data-dfn-for="AttestationCore" data-dfn-type="attribute" data-export="" data-readonly="" data-type="unsigned long " id="dom-attestationcore-version">version<a class="self-link" href="#dom-attestationcore-version"></a></dfn>;
    readonly    attribute DOMString     <dfn class="idl-code" data-dfn-for="AttestationCore" data-dfn-type="attribute" data-export="" data-readonly="" data-type="DOMString     " id="dom-attestationcore-rawdata">rawData<a class="self-link" href="#dom-attestationcore-rawdata"></a></dfn>;
    readonly    attribute DOMString     <dfn class="idl-code" data-dfn-for="AttestationCore" data-dfn-type="attribute" data-export="" data-readonly="" data-type="DOMString     " id="dom-attestationcore-clientdata">clientData<a class="self-link" href="#dom-attestationcore-clientdata"></a></dfn>;
};  
</pre>
    <dl>
     <dt>readonly attribute DOMString <dfn data-dfn-for="AttestationCore" data-dfn-type="dfn" data-noexport="" id="attestationcore-type">type<a class="self-link" href="#attestationcore-type"></a></dfn>
     <dd> The type of the rawData object. This specification defines these
	    attestation raw data types: "tpm", "packed", and "android". Other attestation
	    raw data types may be defined in further versions of this specification. 
     <dt>readonly attribute unsigned long <dfn data-dfn-for="AttestationCore" data-dfn-type="dfn" data-noexport="" id="attestationcore-version">version<a class="self-link" href="#attestationcore-version"></a></dfn>
     <dd>The version number of the rawData object.
     <dt>readonly attribute DOMString <dfn data-dfn-for="AttestationCore" data-dfn-type="dfn" data-noexport="" id="attestationcore-rawdata">rawData<a class="self-link" href="#attestationcore-rawdata"></a></dfn>
     <dd> The rawData object (for type "android"), or the base64url-encoded rawData
	    object (for types "tpm" and "packed"), containing the attested public key
	    and the <code>clientDataHash</code>. 
     <dt>readonly attribute DOMString <dfn data-dfn-for="AttestationCore" data-dfn-type="dfn" data-noexport="" id="attestationcore-clientdata">clientData<a class="self-link" href="#attestationcore-clientdata"></a></dfn>
     <dd> A base64url encoding of <a data-link-type="dfn" href="#clientdatajson" id="ref-for-clientdatajson-3">clientDataJSON</a> (see <a href="#signature-format">§5 Signature Format</a>). The
	    exact encoding must be preserved as the hash (clientDataHash) has been
	    computed over it. 
    </dl>
    <h5 class="heading settled" data-level="6.3.1.1" id="sec-attestation-client-data"><span class="secno">6.3.1.1. </span><span class="content">Client data</span><a class="self-link" href="#sec-attestation-client-data"></a></h5>
    <p> The client platform SHALL deliver, through the EAP API, the <code>clientDataHash</code> (see <a href="#signature-format">§5 Signature Format</a>) to the authenticator.  
	    The client platform MUST also preserve the exact <code>encodedClientData</code> string (see <a href="#signature-format">§5 Signature Format</a>), for embedding
	    in a signature object sent back to the RP. This is necessary since multiple
	    JSON encodings of the same client data are possible. </p>
    <h4 class="heading settled" data-level="6.3.2" id="sec-attestation-header"><span class="secno">6.3.2. </span><span class="content">AttestationHeader</span><a class="self-link" href="#sec-attestation-header"></a></h4>
    <p>Additional data required to verify the attestation signature.</p>
<pre class="idl def">interface <dfn class="dfn-paneled idl-code" data-dfn-for="FIDOAssertion" data-dfn-type="interface" data-export="" data-lt="AttestationHeader" id="fidoassertion-attestationheader">AttestationHeader<span class="dfn-panel" data-deco=""><b><a href="#fidoassertion-attestationheader">#fidoassertion-attestationheader</a></b><b>Referenced in:</b><span><a href="#ref-for-fidoassertion-attestationheader-1">6.3. Client encoding of attestation statements</a></span></span></dfn> {
    readonly    attribute DOMString   <dfn class="idl-code" data-dfn-for="AttestationHeader" data-dfn-type="attribute" data-export="" data-readonly="" data-type="DOMString   " id="dom-attestationheader-claimedaaguid">claimedAAGUID<a class="self-link" href="#dom-attestationheader-claimedaaguid"></a></dfn>;
    readonly    attribute DOMString[] <dfn class="idl-code" data-dfn-for="AttestationHeader" data-dfn-type="attribute" data-export="" data-readonly="" data-type="DOMString[] " id="dom-attestationheader-x5c">x5c<a class="self-link" href="#dom-attestationheader-x5c"></a></dfn>;
    readonly    attribute DOMString   <dfn class="idl-code" data-dfn-for="AttestationHeader" data-dfn-type="attribute" data-export="" data-readonly="" data-type="DOMString   " id="dom-attestationheader-alg">alg<a class="self-link" href="#dom-attestationheader-alg"></a></dfn>;
};
</pre>
    <dl>
     <dt>readonly attribute DOMString <dfn data-dfn-for="AttestationHeader" data-dfn-type="dfn" data-noexport="" id="attestationheader-claimedaaguid">claimedAAGUID<a class="self-link" href="#attestationheader-claimedaaguid"></a></dfn>
     <dd>The claimed Authenticator Attestation GUID (a version 4 GUID, see <a data-link-type="biblio" href="#biblio-rfc4122">[RFC4122]</a>).  
	    This value is used by the FIDO Server to 
	    lookup the trust anchor for verifying this AttestationCore object.  
	    If the verification succeeds, 
	    the AAGUID related to the trust anchor is trusted.  This field MUST be present, if either no
	    attestation certificates are used (e.g., DAA) or if the attestation 
	    certificate doesn’t contain the AAGUID value in an extension. 
     <dt>readonly attribute DOMString[] <dfn data-dfn-for="AttestationHeader" data-dfn-type="dfn" data-noexport="" id="attestationheader-x5c">x5c<a class="self-link" href="#attestationheader-x5c"></a></dfn>
     <dd>Attestation Certificate and its certificate chain as described
	    in <a data-link-type="biblio" href="#biblio-rfc7515">[RFC7515]</a> section 4.1.6.
     <dt>readonly attribute DOMString <dfn data-dfn-for="AttestationHeader" data-dfn-type="dfn" data-noexport="" id="attestationheader-alg">alg<a class="self-link" href="#attestationheader-alg"></a></dfn>
     <dd>
      The name of the algorithm used to generate the attestation signature according to <a data-link-type="biblio" href="#biblio-rfc7518">[RFC7518]</a>. 
      <p>See <a href="#packed-attestation-signature">§6.4.1.3 Signature</a> for the signature algorithms 
	      to be implemented by FIDO Servers.</p>
    </dl>
    <h3 class="heading settled" data-level="6.4" id="defined-attestation-raw-data-types"><span class="secno">6.4. </span><span class="content">Defined Attestation Raw Data Types</span><a class="self-link" href="#defined-attestation-raw-data-types"></a></h3>
    <p> Attestation Raw Data (<code>rawData</code>) is the to-be-signed object of
	  the attestation statement. FIDO supports pluggable attestation data types.
	  This allows support of TPM generated attestation data as well as support of
	  other FIDO authenticators. </p>
    <p> The contents of the attestation data must be controlled (i.e., generated or
	  at least verified) by the authenticator itself. </p>
    <h4 class="heading settled" data-level="6.4.1" id="packed-attestation"><span class="secno">6.4.1. </span><span class="content">Packed Attestation</span><a class="self-link" href="#packed-attestation"></a></h4>
    <p>Packed attestation is a FIDO optimized format of attestation data.  It uses a very compact but
	  still extensible encoding method.  Encoding this format can even be implemented by authenticators
	  with very limited resources (e.g., secure elements).</p>
    <h5 class="heading settled" data-level="6.4.1.1" id="sec-raw-data-packed"><span class="secno">6.4.1.1. </span><span class="content">Attestation rawData (type="packed")</span><a class="self-link" href="#sec-raw-data-packed"></a></h5>
    <p>The attestation data encodes contextual bindings made by the
	      authenticator itself. Unlike client data, the authenticator data has
	      a compact but extensible encoding. This is desired since authenticators can
	      be devices with limited capabilities and low power requirements, with much
	      simpler software stacks than the client platform components.</p>
    <p>For this type, only version="1" is defined at this time.</p>
    <p>The field <code>rawData</code> is the <b>base64url encoding of the byte array</b>.
	      The encoding of attestation data (for type "packed") is a byte array 
	      of 45 bytes + length of public key + length of KeyHandle + potentially more extensions. 
	      The first bytes before the extensions have a fixed layout as follows:</p>
    <table class="complex data longlastcol">
     <tbody>
      <tr>
       <th>Length (in bytes)
       <th>Description
      <tr>
       <td>2
       <td>0xF1D0, fixed big-endian TAG to make sure this object won’t be 
		  confused with other (non-FIDO) binary objects.
      <tr>
       <td>1
       <td>
        Flags (bit 0 is the least significant bit): 
        <ul>
         <li>Bit 0: Test of User Presence (<code>TUP</code>) result.
         <li>Bits 1-6: Reserved for future use (<code>RFU</code>).
         <li>Bit 7: Extension data included (<code>ED</code>). Indicates whether the
		      authenticator added extensions (see below).
        </ul>
      <tr>
       <td>4
       <td>Signature counter (<code>signCount</code>), 32-bit unsigned big-endian integer.
      <tr>
       <td>2
       <td>
         Public key algorithm and encoding (16-bit big-endian value).
		  Allowed values are: 
        <ol>
         <li>
          0x0100. This is raw ANSI X9.62 formatted Elliptic Curve public key <a data-link-type="biblio" href="#biblio-sec1">[SEC1]</a>. 
          <p>I.e., <code>[0x04, X (n bytes), Y (n bytes)]</code>.  Where the 
			byte <code>0x04</code> denotes the uncompressed point compression method 
			and n denotes the key length in bytes.</p>
         <li>
          0x0102.  Raw encoded RSA PKCS1 or 
		      RSASSA-PSS public key <a data-link-type="biblio" href="#biblio-rfc3447">[RFC3447]</a>. 
          <p>In the case of RSASSA-PSS, the default parameters according 
			to <a data-link-type="biblio" href="#biblio-rfc4055">[RFC4055]</a> MUST be assumed, i.e., </p>
          <ul>
           <li>Mask Generation Algorithm MGF1 with SHA256
           <li>Salt Length of 32 bytes, i.e., the length of a SHA256 hash value.
           <li>Trailer Field value of 1, which represents the trailer field with 
			    hexadecimal value <code>0xBC</code>. 
          </ul>
          <p></p>
          <p>That is, <code>[modulus (256 bytes), e (m-n bytes)]</code>.  
			Where <code>m</code> is the total length of the field.</p>
          <p>This total length should be taken from the object containing this key</p>
        </ol>
      <tr>
       <td>2
       <td>Byte length m of following public key bytes (16 bit value 
		  with most significant byte first). 
      <tr>
       <td>(length)
       <td>The public key (m bytes) according to the encoding denoted before.
      <tr>
       <td>2
       <td>Byte length l of KeyHandle 
      <tr>
       <td>(length)
       <td>KeyHandle (l bytes)
      <tr>
       <td>2
       <td>Byte length n of clientDataHash 
      <tr>
       <td>n
       <td>clientDataHash (see <a href="#sec-attestation-client-data">§6.3.1.1 Client data</a>).  
		  This is the hash of <code>clientData</code>.  The hash algorithm itself is stored
		  in the <code>clientData</code> object <a href="#signature-format">§5 Signature Format</a>. 
      <tr>
       <td>As defined by the extension map
       <td>Extension-defined authenticator data. This is a CBOR <a data-link-type="biblio" href="#biblio-rfc7049">[RFC7049]</a> map with 
		  extension identifiers as keys, and extension authenticator data values as values. 
		  See <a href="#extensions">§7 FIDO Extensions</a> for a description 
		  of the extension mechanism.
		  See <a href="#sec-extensions-for-packed-attestation-rawdata">§6.4.1.2 Extensions for Packed Attestation rawData</a> for pre-defined extensions. 
    </table>
    <p>The <code>TUP</code> flag SHALL be set if and only if the authenticator
	      detected a user through an authenticator-specific gesture. The <code>RFU</code> bits in the flags byte SHALL be cleared (i.e., zeroed).</p>
    <p>If the authenticator does not wish to add extensions, it MUST clear
	      the <code>ED</code> flag in the third byte.</p>
    <h5 class="heading settled" data-level="6.4.1.2" id="sec-extensions-for-packed-attestation-rawdata"><span class="secno">6.4.1.2. </span><span class="content">Extensions for Packed Attestation rawData</span><a class="self-link" href="#sec-extensions-for-packed-attestation-rawdata"></a></h5>
    <h6 class="heading settled" data-level="6.4.1.2.1" id="aaguid-extension"><span class="secno">6.4.1.2.1. </span><span class="content">AAGUID Extension</span><a class="self-link" href="#aaguid-extension"></a></h6>
    <dl>
     <dt>Extension identifier
     <dd><code>fido.aaguid</code>
     <dt>Client argument
     <dd>N/A
     <dt>Client processing
     <dd>N/A
     <dt>Authenticator argument
     <dd>N/A
     <dt>Authenticator processing
     <dd>This extension is added automatically by the authenticator.  This extension can be added
		  to attestation statements and signatures. 
     <dt>Authenticator data
     <dd>
      A 128-bit Authenticator Attestation GUID encoded as a CBOR text string (major type 3). 
      <p>This AAGUID is used to identify the Authenticator model (Authenticator Attestation GUID).</p>
      <div class="note" role="note">
       <p>The authenticator model (identified by the AAGUID) can be derived from 
			(a) here, or  
			(b) from the attestation certificate (if we have an authenticator specific
			or authenticator model specific attestation certificate), 
			or (c) or from the claimed AAGUID in the client 
			encoded attestation statement (if we have one attestation root certificate 
			per authenticator model). </p>
       <p>In the case of DAA there is no need for an X.509 
			attestation certificate hierarchy. 
			Instead the trust anchor being known to the RP is 
			the DAA root key (i.e. ECPoint2 X, Y).  This root key must be dedicated
			to a single authenticator model. </p>
      </div>
    </dl>
    <h6 class="heading settled" data-level="6.4.1.2.2" id="supported-extensions-extension"><span class="secno">6.4.1.2.2. </span><span class="content">SupportedExtensions Extension</span><a class="self-link" href="#supported-extensions-extension"></a></h6>
    <dl>
     <dt>Extension identifier
     <dd><code>fido.exts</code>
     <dt>Client argument
     <dd>N/A
     <dt>Client processing
     <dd>N/A
     <dt>Authenticator argument
     <dd>N/A
     <dt>Authenticator processing
     <dd>This extension is added automatically by the authenticator.  This extension can be added
		  to attestation statements. 
     <dt>Authenticator data
     <dd>The SupportedExtension extension is a list (CBOR array) of extension identifiers 
		  encoded as UTF-8 Strings. 
    </dl>
    <h6 class="heading settled" data-level="6.4.1.2.3" id="uvi-extension"><span class="secno">6.4.1.2.3. </span><span class="content">User Verification Index (UVI) Extension</span><a class="self-link" href="#uvi-extension"></a></h6>
    <dl>
     <dt>Extension identifier
     <dd><code>fido.uvi</code>
     <dt>Client argument
     <dd>N/A
     <dt>Client processing
     <dd>N/A
     <dt>Authenticator argument
     <dd>N/A
     <dt>Authenticator processing
     <dd>This extension is added automatically by the authenticator.  This extension can be added
		  to attestation statements and signatures. 
     <dt>Authenticator data
     <dd>
      The user verification index (UVI) is a value uniquely identifying 
		  a user verification data record.  The UVI is encoded as CBOR byte string (type 0x58). 
      <p>Each UVI value MUST be specific to the related key (in order to provide unlinkability).  
		      It also must contain sufficient entropy that makes guessing impractical.  
		      UVI values MUST NOT be reused by the Authenticator (for other biometric data or users). </p>
      <p>The UVI data can be used by FIDO Servers to understand whether an authentication
		      was authorized by the exact same biometric data as the initial key generation.
		      This allows the detection and prevention of "friendly fraud". </p>
      <p>As an example, the UVI could be computed as SHA256(KeyID | SHA256(rawUVI)),
		      where the rawUVI reflects (a) the biometric reference data, 
		      (b) the related OS level user ID and (c) an identifier which changes whenever a
		      factory reset is performed for the device, e.g. 
		      rawUVI = biometricReferenceData | OSLevelUserID | FactoryResetCounter. </p>
      <p>FIDO Servers supporting UVI extensions MUST support a length of up to 32 bytes
		      for the UVI value. </p>
      <p>Example for rawData containing one UVI extension</p>
<pre>F1 D0                         -- This is a FIDO packed rawData object
81                            -- TUP and ED set
00 00 00 01                   -- (initial) signature counter
...                           -- all public key alg etc.
A1                            -- extension: CBOR map of one element
  68                          -- Key 1: CBOR text string of 8 bytes
    66 69 64 6F 2E 75 76 69   -- "fido.uvi" UTF-8 string
  58 20                       -- Value 1: CBOR byte string with 0x20 bytes
  00 43 B8 E3 BE 27 95 8C     -- the UVI value itself
  28 D5 74 BF 46 8A 85 CF 
  46 9A 14 F0 E5 16 69 31 
  DA 4B CF FF C1 BB 11 32 
  82
</pre>
    </dl>
    <h5 class="heading settled" data-level="6.4.1.3" id="packed-attestation-signature"><span class="secno">6.4.1.3. </span><span class="content">Signature</span><a class="self-link" href="#packed-attestation-signature"></a></h5>
    <p>The <code>signature</code> is computed over the base64url-decoded <code>rawData</code> field.</p>
     The following 
	    algorithms must be implemented by FIDO Servers: 
    <ol>
     <li>"ES256" <a data-link-type="biblio" href="#biblio-rfc7518">[RFC7518]</a>
     <li>"RS256" <a data-link-type="biblio" href="#biblio-rfc7518">[RFC7518]</a>
     <li>"PS256" <a data-link-type="biblio" href="#biblio-rfc7518">[RFC7518]</a>
     <li>"ED256" <a data-link-type="biblio" href="#biblio-fidoecdaaalgorithm">[FIDOEcdaaAlgorithm]</a>
    </ol>
     Authenticators can choose which algorithm to implement. 
    <h5 class="heading settled" data-level="6.4.1.4" id="packed-attestation-cert-requirements"><span class="secno">6.4.1.4. </span><span class="content">Packed attestation statement certificate requirements</span><a class="self-link" href="#packed-attestation-cert-requirements"></a></h5>
    <p class="note" role="note">In the case of DAA attestation <a data-link-type="biblio" href="#biblio-fidoecdaaalgorithm">[FIDOEcdaaAlgorithm]</a> no attestation certificate is used. </p>
    <p>The attestation certificate MUST have the following
	      fields/extensions: </p>
    <ul>
     <li>Version must be set to 3.
     <li>
      Subject field MUST be set to: 
      <dl>
       <dt>Subject-C
       <dd>Country where the Authenticator vendor is incorporated
       <dt>Subject-O
       <dd>Legal name of the Authenticator vendor
       <dt>Subject-OU
       <dd>Authenticator Attestation
       <dt>Subject-CN
       <dd>No stipulation.
      </dl>
     <li>
      If the related attestation root certificate is used for multiple authenticator 
		models, the following extension MUST be present: 
      <p>Extension OID <code>1 3 6 1 4 1 45724 1 1 4</code> (id-fido-gen-ce-aaguid) containing the AAGUID as value. </p>
     <li>The Basic Constraints extension MUST have the cA component set
		to false 
     <li>An Authority Information Access (AIA) extension with entry <code>id-ad-ocsp</code> and 
		a CRL Distribution Point extension <a data-link-type="biblio" href="#biblio-rfc5280">[RFC5280]</a> are both optional as the status of attestation certificates is
		available through the FIDO Metadata Service <a data-link-type="biblio" href="#biblio-fidometadataservice">[FIDOMetadataService]</a>. 
    </ul>
    <h4 class="heading settled" data-level="6.4.2" id="tpm-attestation"><span class="secno">6.4.2. </span><span class="content">TPM Attestation</span><a class="self-link" href="#tpm-attestation"></a></h4>
    <h5 class="heading settled" data-level="6.4.2.1" id="sec-raw-data-tpm"><span class="secno">6.4.2.1. </span><span class="content">Attestation rawData (type="tpm")</span><a class="self-link" href="#sec-raw-data-tpm"></a></h5>
    <p> The value of <code>rawData</code> is the <b>base64url encoding of a binary object</b>.
	      This binary object is either a
              TPM_CERTIFY_INFO or a TPM_CERTIFY_INFO2 structure <a data-link-type="biblio" href="#biblio-tpmv1-2-part2">[TPMv1-2-Part2]</a> sections 11.1 and 11.2, if <code>attestationStatement.core.version</code> equals 1. Else, if <code>attestationStatement.core.version</code> equals 2, it MUST be
              the base64url encoding of a TPMS_ATTEST structure as defined in <a data-link-type="biblio" href="#biblio-tpmv2-part2">[TPMv2-Part2]</a> sections 10.12.9. </p>
    <p> The field "extraData" (in the case of TPMS_ATTEST) or the field "data" 
	      (in the case of TPM_CERTIFY_INFO or TPM_CERTIFY_INFO2) MUST contain 
	      the <code>clientDataHash</code> (see [[#signature-format]). </p>
    <h5 class="heading settled" data-level="6.4.2.2" id="tpm-attestation-signature"><span class="secno">6.4.2.2. </span><span class="content">Signature</span><a class="self-link" href="#tpm-attestation-signature"></a></h5>
    <p> If <code>attestationStatement.core.version</code> equals 1, (i.e., for
              TPM 1.2), RSASSA-PKCS1-v1_5 signature algorithm (section 8.2 of <a data-link-type="biblio" href="#biblio-rfc3447">[RFC3447]</a>) can be used by FIDO Authenticators (i.e. <code>attestationStatement.header.alg</code>="RS256"). </p>
    <p> If <code>attestationStatement.core.version</code> equals 2, the
              following algorithms can be used by FIDO Authenticators: </p>
    <ol>
     <li>TPM_ALG_RSASSA (0x14).  This is the same algorithm RSASSA-PKCS1-v1_5 
		as for version 1 but for use with TPMv2. <code>attestationStatement.header.alg</code>="RS256".
     <li>TPM_ALG_RSAPSS (0x16); <code>attestationStatement.header.alg</code>="PS256".
     <li>TPM_ALG_ECDSA (0x18); <code>attestationStatement.header.alg</code>="ES256".
     <li>TPM_ALG_ECDAA (0x1A); <code>attestationStatement.header.alg</code>="ED256".
     <li>TPM_ALG_SM2 (0x1B); <code>attestationStatement.header.alg</code>="SM256".
    </ol>
    <p>The <code>signature</code> is computed over the base64url-decoded <code>rawData</code> field</p>
    <p>See <a href="#packed-attestation-signature">§6.4.1.3 Signature</a> for the signature algorithms 
	      to be implemented by FIDO Servers. </p>
    <h5 class="heading settled" data-level="6.4.2.3" id="tpm-cert-requirements"><span class="secno">6.4.2.3. </span><span class="content">TPM attestation statement certificate requirements</span><a class="self-link" href="#tpm-cert-requirements"></a></h5>
    <p>TPM attestation certificate MUST have the following
	      fields/extensions: </p>
    <ul>
     <li>Version must be set to 3.
     <li>Subject field MUST be set to empty.
     <li>The Subject Alternative Name extension must be set as defined in <a data-link-type="biblio" href="#biblio-tpmv2-ek-profile">[TPMv2-EK-Profile]</a> section 3.2.9 if "version" equals 2 and <a data-link-type="biblio" href="#biblio-tpmv1-2-credential-profiles">[TPMv1-2-Credential-Profiles]</a> section 3.2.9 if "version" equals 1. 
     <li>The Extended Key Usage extension MUST contain the
		"joint-iso-itu-t(2) internationalorganizations(23) 133
		tcg-kp(8) tcg-kp-AIKCertificate(3)" OID. 
     <li>The Basic Constraints extension MUST have the CA component set
		to false 
     <li>An Authority Information Access (AIA) extension with entry <code>id-ad-ocsp</code> and 
		a CRL Distribution Point extension <a data-link-type="biblio" href="#biblio-rfc5280">[RFC5280]</a> are both optional as the status of attestation certificates is
		available through the FIDO Metadata Service <a data-link-type="biblio" href="#biblio-fidometadataservice">[FIDOMetadataService]</a>. 
    </ul>
    <h4 class="heading settled" data-level="6.4.3" id="android-attestation"><span class="secno">6.4.3. </span><span class="content">Android Attestation</span><a class="self-link" href="#android-attestation"></a></h4>
    <p> When the Authenticator in question is a platform-provided
       Authenticator on the Android platform, the attestation statement is
       based on the <a href="https://developer.android.com/training/safetynet/index.html#compat-check-response"> SafetyNet API</a>. </p>
    <p>Android attestation statement MUST always be used in conjunction with the more 
	  specific <code>AndroidAttestationClientData</code> (see <a href="#sec-android-attestationclientdata">§6.4.3.4 AndroidAttestationClientData</a>)
	  in order to let the RP App store the public key in the attestation object. </p>
    <h5 class="heading settled" data-level="6.4.3.1" id="sec-attestation-android"><span class="secno">6.4.3.1. </span><span class="content">Attestation rawData (type="android")</span><a class="self-link" href="#sec-attestation-android"></a></h5>
    <p> Android SafetyNet returns a JWS <a data-link-type="biblio" href="#biblio-rfc7515">[RFC7515]</a> object (see <a href="https://developer.android.com/training/safetynet/index.html#compat-check-response"> SafetyNet online documentation</a>) in Compact
	    Serialization. A JWS in Compact Serialization consists of three segments
	    (each a base64url-encoded string) separated by a dot ("."). The <code>rawData</code> object is the concatenation of: </p>
    <ol>
     <li>the first segment (a base64url encoding of the UTF-8 encoded JWS Protected Header)
     <li>a dot "."
     <li>the second segment (a base64url encoding of the UTF-8 encoded JWS Payload).
    </ol>
    <p> In contrast to the "packed" and "tpm" attestation types, for the
	    "android" attestation type, the <code>rawData</code> field and the <code>rawData</code> object are the same string. (In the "packed" and
	    "tpm" attestation types the <code>rawData</code> field is the
	    base64url-encoding of the <code>rawData</code> object.) </p>
    <h5 class="heading settled" data-level="6.4.3.2" id="sec-android-attestation-signature"><span class="secno">6.4.3.2. </span><span class="content">Signature</span><a class="self-link" href="#sec-android-attestation-signature"></a></h5>
    <p> The signature is directly computed over the <code>rawData</code> field, as
	    defined above (see <a data-link-type="biblio" href="#biblio-rfc7515">[RFC7515]</a> for more details). The third segment of the
	    JWS returned by SafetyNet is the base64url encoding of this signature,
	    and also becomes the <code>AttestationStatement.signature</code>. </p>
    <h5 class="heading settled" data-level="6.4.3.3" id="safetynet-conversion"><span class="secno">6.4.3.3. </span><span class="content">Converting SafetyNet response to attestationStatement</span><a class="self-link" href="#safetynet-conversion"></a></h5>
    <p> The Authenticator and/or platform SHOULD use the steps outlined below to
	    create an attestationStatement from an Android SafetyNet response. It MAY
	    use a different algorithm, as long as the results are the same. </p>
    <ol>
     <li>create clientDataJSON with type AndroidAttestationClientData (see below) and 
	      compute clientData as base64url-encoded clientDataJSON.
     <li>provide the clientDataHash computed as the hash value of clientData 
	      as Nonce value when requesting the SafetyNet attestation.
     <li>take SafetyNet response <var>snr</var>.  This is a JWS object (<a data-link-type="biblio" href="#biblio-rfc7515">[RFC7515]</a>).
     <li>extract the base64url-encoded Protected Header <var>hdr</var> from <var>snr</var> (see <a data-link-type="biblio" href="#biblio-rfc7515">[RFC7515]</a>)
     <li>extract the base64url-encoded payload <var>p</var> from <var>snr</var>
     <li>extract the base64url-encoded signature <var>s</var> from <var>snr</var>
     <li>set <code>AttestationStatement.core.rawData</code> = <var>hdr</var> | "." | <var>p</var>
     <li>set <code>AttestationStatement.signature</code> = <var>s</var>
     <li>base64url-decode <var>hdr</var> into <var>hdr-d</var>
     <li>set <code>AttestationStatement.header.alg</code> = <var>hdr-d</var>.alg
     <li>if <var>hdr-d</var>.x5c is present, then set <code>AttestationStatement.header.x5c</code> = <var>hdr-d</var>.x5c
     <li> if <var>hdr-d</var>.x5u is present, then resolve the URL and add the 
	      retrieved certificate chain to <code>AttestationStatement.header.x5c</code> 
     <li>set <code>AttestationStatement.core.type</code> = "android"
     <li>set <code>AttestationStatement.core.version</code> to the 
	      version number of Google Play Services responsible for providing the SafetyNet API
    </ol>
    <h5 class="heading settled" data-level="6.4.3.4" id="sec-android-attestationclientdata"><span class="secno">6.4.3.4. </span><span class="content">AndroidAttestationClientData</span><a class="self-link" href="#sec-android-attestationclientdata"></a></h5>
    <p> The ClientData dictionary is extended in the following way: </p>
<pre class="idl def">dictionary <dfn class="idl-code" data-dfn-for="FIDOAssertion" data-dfn-type="dictionary" data-export="" id="dictdef-fidoassertion-androidattestationclientdata">AndroidAttestationClientData<a class="self-link" href="#dictdef-fidoassertion-androidattestationclientdata"></a></dfn> : <a data-link-type="idl-name" href="#dictdef-clientdata" id="ref-for-dictdef-clientdata-3">ClientData</a> {
             <a data-link-type="idl-name" href="#jsonwebkey" id="ref-for-jsonwebkey-2">JsonWebKey</a>             <dfn class="idl-code" data-dfn-for="AndroidAttestationClientData" data-dfn-type="dict-member" data-export="" data-type="JsonWebKey             " id="dom-androidattestationclientdata-publickey">publicKey<a class="self-link" href="#dom-androidattestationclientdata-publickey"></a></dfn>;
             boolean                <dfn class="idl-code" data-dfn-for="AndroidAttestationClientData" data-dfn-type="dict-member" data-export="" data-type="boolean                " id="dom-androidattestationclientdata-isinsidesecurehardware">isInsideSecureHardware<a class="self-link" href="#dom-androidattestationclientdata-isinsidesecurehardware"></a></dfn>;
             DOMString              <dfn class="idl-code" data-dfn-for="AndroidAttestationClientData" data-dfn-type="dict-member" data-export="" data-type="DOMString              " id="dom-androidattestationclientdata-userauthentication">userAuthentication<a class="self-link" href="#dom-androidattestationclientdata-userauthentication"></a></dfn>;
             unsigned long <dfn class="idl-code" data-dfn-for="AndroidAttestationClientData" data-dfn-type="dict-member" data-export="" data-type="unsigned long " id="dom-androidattestationclientdata-userauthenticationvaliditydurationseconds">userAuthenticationValidityDurationSeconds<a class="self-link" href="#dom-androidattestationclientdata-userauthenticationvaliditydurationseconds"></a></dfn>; // optional
};  
</pre>
    <dl>
     <dt>JsonWebKey <dfn data-dfn-for="AndroidAttestationClientData" data-dfn-type="dfn" data-noexport="" id="androidattestationclientdata-publickey">publicKey<a class="self-link" href="#androidattestationclientdata-publickey"></a></dfn>
     <dd> The public key generated by the Authenticator, as a JsonWebKey object (see <a data-link-type="biblio" href="#biblio-webcryptoapi">[WebCryptoAPI]</a>). 
     <dt>boolean <dfn data-dfn-for="AndroidAttestationClientData" data-dfn-type="dfn" data-noexport="" id="androidattestationclientdata-isinsidesecurehardware">isInsideSecureHardware<a class="self-link" href="#androidattestationclientdata-isinsidesecurehardware"></a></dfn>
     <dd> <code>true</code> if the key resides inside secure hardware (e.g.,
              Trusted Execution Environment (TEE) or Secure Element (SE)). 
     <dt>DOMString <dfn data-dfn-for="AndroidAttestationClientData" data-dfn-type="dfn" data-noexport="" id="androidattestationclientdata-userauthentication">userAuthentication<a class="self-link" href="#androidattestationclientdata-userauthentication"></a></dfn>
     <dd> One of "none", "keyguard", or "fingerprint". <em>none</em> means
              that the user has not enrolled a fingerprint, or set up a secure
              lock screen, and that therefore the key has not been linked to user
              authentication. <em>keyguard</em> means that the generated key only
              be used after the user unlocks a secure lock screen. <em>fingerprint</em> means that each operation involving the
              generated key must be individually authorized by the user by
              presenting a fingerprint. 
     <dt>optional unsigned long <dfn data-dfn-for="AndroidAttestationClientData" data-dfn-type="dfn" data-noexport="" id="androidattestationclientdata-userauthenticationvaliditydurationseconds">userAuthenticationValidityDurationSeconds<a class="self-link" href="#androidattestationclientdata-userauthenticationvaliditydurationseconds"></a></dfn>
     <dd> If the <code>userAuthentication</code> is set to "keyguard", then
              this parameter specifies the duration of time (seconds) for which
              this key is authorized to be used after the user is successfully
              authenticated. 
    </dl>
    <h5 class="heading settled" data-level="6.4.3.5" id="verifying-android-contextual-bindings"><span class="secno">6.4.3.5. </span><span class="content">Verifying AndroidClientData specific contextual bindings</span><a class="self-link" href="#verifying-android-contextual-bindings"></a></h5>
    <p> A relying party shall verify the clientData contextual bindings (see step 4 
	      in <a href="#verifying-an-attestation-statement">§6.5 Verifying an Attestation Statement</a>) as follows: </p>
    <ul>
     <li> Check that <code>AndroidAttestationClientData.challenge</code> equals the
		attestationChallenge that was passed into the <code class="idl"><a data-link-type="idl" href="#dom-fidocredentials-makecredential" id="ref-for-dom-fidocredentials-makecredential-3">makeCredential()</a></code> call. 
     <li> Check that the <code>facet</code> and <code>tokenBinding</code> parameters in the <code>AndroidAttestationClientData</code> match the
		RP App. 
     <li> Check that <code>AndroidAttestationClientData.publicKey</code> is the same key as the one
		returned in the <code>FIDOCredentialInfo</code> by the <code>makeCredential</code> call. 
     <li> Check that the hash of the clientDataJSON matches the <code>nonce</code> attribute in the payload of the <code>safetynetResponse</code> JWS. 
     <li> Check that the <code>ctsProfileMatch</code> attribute in the payload
		of the <code>safetynetResponse</code> is true. 
     <li> Check that the <code>apkPackageName</code> attribute in the payload of the <code>safetynetResponse</code> matches package name of the application calling 
		SafetyNet API. 
     <li> Check that the <code>apkDigestSha256</code> attribute in the
		payload of the <code>safetynetResponse</code> matches the package hash 
		of the application calling SafetyNet API. 
     <li> Check that the <code>apkCertificateDigestSha256</code> attribute in the
		payload of the <code>safetynetResponse</code> matches the hash of the signing certificate 
		of the application calling SafetyNet API. 
    </ul>
    <h3 class="heading settled" data-level="6.5" id="verifying-an-attestation-statement"><span class="secno">6.5. </span><span class="content">Verifying an Attestation Statement</span><a class="self-link" href="#verifying-an-attestation-statement"></a></h3>
    <p>This section outlines the recommended algorithm for verifying an
	  attestation statement, independent of attestation type. </p>
    <p>Upon receiving an attestation statement, the relying party
	  shall: </p>
    <ol>
     <li>Verify that the attestation statement is properly formatted
     <li>
      If <code>attestationSignature.alg</code> is not ECDAA (e.g., not "ED256" and not "ED512"): 
      <ol>
       <li>Lookup the attestation root certificate from a trusted source.  
		The FIDO Metadata Service <a data-link-type="biblio" href="#biblio-fidometadataservice">[FIDOMetadataService]</a> provides an easy way to access such information.
		The <code>header.claimedAAGUID</code> can be used for this lookup. 
       <li>Verify that 
		the attestation certificate chain is valid and
		chains up to a trusted root (following <a data-link-type="biblio" href="#biblio-rfc5280">[RFC5280]</a>). 
       <li>Verify that the attestation certificate has the right Extended Key Usage (EKU) based
		on the FIDO Authenticator type (as denoted by the <code>header.type</code> member). In case of a
		type="tpm", this EKU shall be OID "2.23.133.8.3". 
       <li>If the attestation type is "android", verify that the attestation certificate is issued 
	          to the hostname "attest.android.com" (see <a href="https://developer.android.com/training/safetynet/index.html#compat-check-response"> SafetyNet online documentation</a>). 
       <li>Verify that all issuing CA certificates in the chain are valid
		and not revoked. 
       <li> Verify the <code>signature</code> on <code>core.rawData</code> using the
		attestation certificate public key and algorithm as identified by <code>header.alg</code>. 
       <li> Verify <code>core.rawData</code> syntax and that it doesn’t contradict the signing 
		algorithm specified in <code>header.alg</code>. 
       <li>If the attestation certificate contains an extension with 
		OID <code>1 3 6 1 4 1 45724 1 1 4</code> (id-fido-gen-ce-aaguid) verify that the value of this extension matches <code>header.claimedAAGUID</code>.  This identifies the Authenticator model. 
       <li>If such extension doesn’t exist, 
		the attestation root certificate is dedicated to a single Authenticator model. 
      </ol>
     <li>
      If <code>attestationSignature.alg</code> is ECDAA (e.g., "ED256", "ED512"): 
      <ol>
       <li>Lookup the DAA 
		root key from a trusted source.  The FIDO Metadata Service <a data-link-type="biblio" href="#biblio-fidometadataservice">[FIDOMetadataService]</a> provides an easy way to access such information.
		The <code>header.claimedAAGUID</code> can be used for this lookup. 
       <li>Perform DAA-Verify on <code>signature</code> for <code>core.rawData</code> (see <a data-link-type="biblio" href="#biblio-fidoecdaaalgorithm">[FIDOEcdaaAlgorithm]</a>).
       <li> Verify <code>core.rawData</code> syntax and that it doesn’t contradict the signing 
		algorithm specified in <code>header.alg</code>. 
       <li>The DAA root key is dedicated to a single Authenticator model.
      </ol>
     <li>Verify the contextual bindings (e.g., channel binding) from the 
	    clientData (see <a href="#sec-attestation-client-data">§6.3.1.1 Client data</a>). 
     <li> Verify that user verification method and other authenticator characteristics 
	    related to this authenticator model, match the relying party policy.
	    The FIDO Metadata Service <a data-link-type="biblio" href="#biblio-fidometadataservice">[FIDOMetadataService]</a> provides an easy way to access the authenticator characteristics. 
    </ol>
    <p>The relying party MAY take any of the below actions when
	verification of an attestation statement fails:</p>
    <ul>
     <li> Reject the request, such as a registration request, associated
	    with the attestation statement. 
     <li> Accept the request associated with the attestation statement but
	    treat the attested FIDO Credential as one with surrogate basic 
	    attestation (see <a href="#attestation-models">§6.1.1 Attestation Models</a>), if policy allows it.
	    If doing so, there is no cryptographic proof that the FIDO Credential 
	    has been generated by a particular Authenticator model.  
	    See <a data-link-type="biblio" href="#biblio-fidosecref">[FIDOSecRef]</a> and <a data-link-type="biblio" href="#biblio-uafprotocol">[UAFProtocol]</a> for more details on the relevance on attestation. 
    </ul>
    <p>Verification of attestation statements requires that the relying
	  party trusts the root of the attestation certificate chain.
	  Also, the relying party must have access to certificate status
	  information for the intermediate CA certificates. The relying
	  party must also be able to build the attestation certificate
	  chain if the client didn’t provide this chain in the
	  attestation information. </p>
    <h3 class="heading settled" data-level="6.6" id="sec-attestation-security-considerations"><span class="secno">6.6. </span><span class="content">Security Considerations</span><a class="self-link" href="#sec-attestation-security-considerations"></a></h3>
    <h4 class="heading settled" data-level="6.6.1" id="sec-attestation-privacy"><span class="secno">6.6.1. </span><span class="content">Privacy</span><a class="self-link" href="#sec-attestation-privacy"></a></h4>
    <p>Attestation keys may be used to track users or link
	  various online identities of the same user together. This may
	  be mitigated in several ways, including: </p>
    <ul>
     <li>A FIDO Authenticator manufacturer may choose to ship all of their devices with
	    the same (or a fixed number of) attestation key(s) (called Full Basic Attestation). This will
	    anonymize the user at the risk of not being able to revoke a
	    particular attestation key should its FIDO Authenticator be compromised. 
     <li>A FIDO Authenticator may be capable of dynamically generating different attestation keys
	    (and requesting related certificates) per origin (following the Privacy CA model). 
	    For example, a FIDO Authenticator can ship with a master 
	    attestation key (and certificate), and
	    combined with a cloud operated privacy CA, can dynamically generate per origin
	    attestation keys and attestation certificates. 
     <li>A FIDO Authenticator can implement direct anonymous 
	    attestation (see <a data-link-type="biblio" href="#biblio-fidoecdaaalgorithm">[FIDOEcdaaAlgorithm]</a>).  Using this scheme the authenticator
	    generates a blinded attestation signature.  This allows the relying party to verify 
	    the signature using the DAA root key, but the attestation signature doesn’t 
	    serve as a global correlation handle. 
    </ul>
    <h4 class="heading settled" data-level="6.6.2" id="ca-compromise"><span class="secno">6.6.2. </span><span class="content">Attestation Certificate and Attestation Certificate CA Compromise</span><a class="self-link" href="#ca-compromise"></a></h4>
    <p>When an intermediate CA or a root CA used for issuing attestation
	  certificates is compromised, FIDO Authenticator attestation keys are still
	  safe although their certificates can no longer be trusted. A
	  FIDO Authenticator manufacturer that has recorded the public attestation keys
	  for their devices can issue new attestation certificates for
	  these keys from a new intermediate CA or from a new root CA.
	  If the root CA changes, the relying parties must update their trusted 
	  root certificates accordingly. </p>
    <p>A FIDO Authenticator attestation certificate must be revoked by the issuing CA
	  if its key has been compromised. A FIDO Authenticator manufacturer may need to
	  ship a firmware update and inject new attestation keys and
	  certificates into already manufactured FIDO Authenticators, if
	  the exposure was due to a firmware flaw.
	  (The process by which this happens is out of scope for this specification.)
	  No further valid
	  attestation statements can be made by the affected FIDO Authenticators unless
	  the FIDO Authenticator manufacturer has this capability. </p>
    <p>If attestation certificate validation fails due to a revoked
	  intermediate attestation CA certificate, and relying party policy requires rejecting
	  the registration/authentication request in these situations,
	  then it is recommended that the relying party also un-registers
	  (or marks as "surrogate attestation" (see <a href="#attestation-models">§6.1.1 Attestation Models</a>), policy permitting) 
	  FIDO credentials that were registered post the CA compromise date using an attestation
	  certificate chaining up to the same intermediate CA. It is thus
	  recommended that relying parties remember intermediate attestation CA certificates
	  during Authenticator registration in order to un-register related FIDO Credentials if 
	  the registration was performed after revocation of such certificates. </p>
    <p>If a DAA attestation key has been compromised, it can be added to the
	  RogueList (i.e., the list of revoked authenticators) maintained by the related DAA-Issuer.
	  The relying party should verify whether an authenticator belongs to the
	  RogueList when performing DAA-Verify.  The FIDO Metadata Service <a data-link-type="biblio" href="#biblio-fidometadataservice">[FIDOMetadataService]</a> provides an easy way to access such information. </p>
    <h4 class="heading settled" data-level="6.6.3" id="cert-hierarchy"><span class="secno">6.6.3. </span><span class="content">Attestation Certificate Hierarchy</span><a class="self-link" href="#cert-hierarchy"></a></h4>
    <p>A 3 tier hierarchy for attestation certificates is recommended 
	  (i.e., Attestation Root, Attestation Issuing CA, Attestation Certificate). 
	  It is also recommended that
	  for each FIDO Authenticator device line (i.e., model), a separate issuing CA is used to help
	  facilitate isolating problems with a specific version of a device. </p>
    <p>If the attestation root certificate is <em>not</em> dedicated 
	  to a single FIDO Authenticator device line (i.e., AAGUID),
	  the AAGUID must be specified either in the attestation certificate itself or 
	  as an extension in the <code>core.rawData</code>. </p>
    <h2 class="heading settled" data-level="7" id="extensions"><span class="secno">7. </span><span class="content">FIDO Extensions</span><a class="self-link" href="#extensions"></a></h2>
    <p> The mechanism for generating FIDO 2.0 credentials, as well as requesting and
  generating FIDO 2.0 assertions, as defined in <a href="#api">§4 FIDO Credential API</a>,
  can be extended to suit particular use cases. Each case is
  addressed by defining a <em>registration extension</em> and/or a <em>signature extension</em>. Extensions can define additions to the
  following steps and data: </p>
    <ul>
     <li> <code class="idl"><a data-link-type="idl" href="#dom-fidocredentials-makecredential" id="ref-for-dom-fidocredentials-makecredential-4">makeCredential()</a></code> request parameters (see <a href="#api">§4 FIDO Credential API</a>) for
    registration extension. 
     <li> <code class="idl"><a data-link-type="idl" href="#dom-fidocredentials-getassertion" id="ref-for-dom-fidocredentials-getassertion-4">getAssertion()</a></code> request parameters (see <a href="#api">§4 FIDO Credential API</a>) for
    signature extensions. 
     <li> Client processing, and the <code class="idl"><a data-link-type="idl" href="#dictdef-clientdata" id="ref-for-dictdef-clientdata-4">ClientData</a></code> structure, for
    registration extensions and signature extensions. 
     <li> Authenticator processing, and the <var>authenticatorData</var> structure, for signature extensions. 
    </ul>
    <p> When requesting an assertion for a FIDO 2.0 credential, an RP can list a set
  of extensions to be used, if they are supported by the client and/or the
  authenticator. It sends the request parameters for each extension in the <code class="idl"><a data-link-type="idl" href="#dom-fidocredentials-getassertion" id="ref-for-dom-fidocredentials-getassertion-5">getAssertion()</a></code> call (for signature extensions) or <code class="idl"><a data-link-type="idl" href="#dom-fidocredentials-makecredential" id="ref-for-dom-fidocredentials-makecredential-5">makeCredential()</a></code> call (for registration extensions) to the client
  platform. The client platform performs additional processing for each
  extension that it supports, and augments <code class="idl"><a data-link-type="idl" href="#dictdef-clientdata" id="ref-for-dictdef-clientdata-5">ClientData</a></code> as required
  by the extension. For extensions that the client platform does not support,
  it passes the request parameters on to the authenticator when possible
  (criteria defined below). This allows one to define extensions that affect
  the authenticator only. </p>
    <p> Similarly, the authenticator performs additional processing for the
  extensions that it supports, and augments <var>authenticatorData</var> as
  specified by the extension. </p>
    <p> Extensions that are not supported are ignored. </p>
    <h3 class="heading settled" data-level="7.1" id="extension-id"><span class="secno">7.1. </span><span class="content">Extension identifiers</span><a class="self-link" href="#extension-id"></a></h3>
    <p> Extensions are identified by a string, chosen by the extension author. Extension identifiers
  should aim to be globally unique, e.g., by using reverse domain-name of the defining entity such
  as <code>com.example.fido.myextension</code>. </p>
    <p> Extensions that may exist in multiple versions should take care to include a version
  in their identifier. In effect, different versions are thus treated as different extensions. </p>
    <p> Standard extensions defined by FIDO in this specification use a fixed prefix of <code>fido.</code> for the extension identifiers. This prefix should not be used for 3rd party extensions. </p>
    <h3 class="heading settled" data-level="7.2" id="extension-specification"><span class="secno">7.2. </span><span class="content">Defining extensions</span><a class="self-link" href="#extension-specification"></a></h3>
    <p> A definition of an extension must specify, at minimum, an extension
    identifier and an extension client argument sent via the <code class="idl"><a data-link-type="idl" href="#dom-fidocredentials-getassertion" id="ref-for-dom-fidocredentials-getassertion-6">getAssertion()</a></code> or <code class="idl"><a data-link-type="idl" href="#dom-fidocredentials-makecredential" id="ref-for-dom-fidocredentials-makecredential-6">makeCredential()</a></code> call (see below).
    Additionally, extensions may specify additional values in <code class="idl"><a data-link-type="idl" href="#dictdef-clientdata" id="ref-for-dictdef-clientdata-6">ClientData</a></code>, <code>authenticatorData</code> (in the case of
    signature extensions), or both. </p>
    <p class="note" role="note"> An extension that does not define additions to <code class="idl"><a data-link-type="idl" href="#dictdef-clientdata" id="ref-for-dictdef-clientdata-7">ClientData</a></code> nor <code>authenticatorData</code> is possible, but should be avoided. In such
    cases, the relying party would have no indication if the extension was
    supported or processed by the client and/or authenticator. </p>
    <h3 class="heading settled" data-level="7.3" id="extension-request-parameters"><span class="secno">7.3. </span><span class="content">Extending request parameters</span><a class="self-link" href="#extension-request-parameters"></a></h3>
    <p> An extension defines two request arguments. The <dfn class="dfn-paneled" data-dfn-for="FIDOAssertion" data-dfn-type="dfn" data-lt="client argument" data-noexport="" id="fidoassertion-client-argument">client argument<span class="dfn-panel" data-deco=""><b><a href="#fidoassertion-client-argument">#fidoassertion-client-argument</a></b><b>Referenced in:</b><span><a href="#ref-for-fidoassertion-client-argument-1">7.3. Extending request parameters</a></span></span></dfn> is passed from the RP to the client in the <code class="idl"><a data-link-type="idl" href="#dom-fidocredentials-getassertion" id="ref-for-dom-fidocredentials-getassertion-7">getAssertion()</a></code> or <code class="idl"><a data-link-type="idl" href="#dom-fidocredentials-makecredential" id="ref-for-dom-fidocredentials-makecredential-7">makeCredential()</a></code> call, while the <dfn data-dfn-for="FIDOAssertion" data-dfn-type="dfn" data-noexport="" id="fidoassertion-authenticator-argument">authenticator
    argument<a class="self-link" href="#fidoassertion-authenticator-argument"></a></dfn> is passed from the client to the authenticator during the
    processing of these calls. </p>
    <p> Extension definitions MUST specify the valid values for their client
    argument. Clients are free to ignore extensions with an invalid client
    argument. Specifying an authenticator argument is optional, since some
    extensions may only affect client processing. </p>
    <p> An RP simultaneously requests the use of an extension and sets its client
    argument by including an entry in the <code class="idl"><a data-link-type="idl" href="#dom-fidocredentials-makecredential-accountinformation-cryptoparameters-attestationchallenge-credentialtimeoutseconds-blacklist-credentialextensions-credentialextensions" id="ref-for-dom-fidocredentials-makecredential-accountinformation-cryptoparameters-attestationchallenge-credentialtimeoutseconds-blacklist-credentialextensions-credentialextensions-1">credentialExtensions</a></code> or <code class="idl"><a data-link-type="idl" href="#dom-fidocredentials-getassertion-assertionchallenge-assertiontimeoutseconds-whitelist-assertionextensions-assertionextensions" id="ref-for-dom-fidocredentials-getassertion-assertionchallenge-assertiontimeoutseconds-whitelist-assertionextensions-assertionextensions-1">assertionExtensions</a></code> dictionary
    parameters to the <code class="idl"><a data-link-type="idl" href="#dom-fidocredentials-makecredential" id="ref-for-dom-fidocredentials-makecredential-8">makeCredential()</a></code> or <code class="idl"><a data-link-type="idl" href="#dom-fidocredentials-getassertion" id="ref-for-dom-fidocredentials-getassertion-8">getAssertion()</a></code> call. The entry key MUST be the extension identifier, and the value
    MUST be the <a data-link-type="dfn" href="#fidoassertion-client-argument" id="ref-for-fidoassertion-client-argument-1">client argument</a>. </p>
<pre class="example highlight" id="example-8fedc1a7"><a class="self-link" href="#example-8fedc1a7"></a>var assertionPromise = credentials.getAssertion(..., /* extensions */ {
  "com.example.fido.foobar": 42
});
</pre>
    <p> Extensions that affect the behavior of the client platform can define their
    argument to be any set of values that can be encoded in JSON. Such an
    extension will in general (but not always) specify additional values to the <code class="idl"><a data-link-type="idl" href="#dictdef-clientdata" id="ref-for-dictdef-clientdata-8">ClientData</a></code> structure (see below). It may also specify an
    authenticator argument that platforms implementing the extension are
    expected to send to the authenticator. The authenticator argument should be
    a byte string. </p>
    <p class="note" role="note"> Extensions should aim to define authenticator arguments that are as small
    as possible. Some authenticators communicate over low-bandwidth links such
    as Bluetooth Low-Energy or NFC. </p>
    <p class="note" role="note"> Extensions that do not need to pass any particular argument value, must
    still define a client argument. It is recommended that the argument be
    defined as the constant value <code>true</code> in this case. </p>
    <p> For extensions that specify additional authenticator processing only, it is
    desirable that the platform need not know the extension. To support this,
    platforms SHOULD pass the client argument of unknown extension as the
    authenticator argument unchanged, under the same extension identifier. The
    authenticator argument should be the CBOR encoding of the client argument,
    as specified in Section 4.2 of <a data-link-type="biblio" href="#biblio-rfc7049">[RFC7049]</a>. Clients SHOULD silently drop
    unknown extensions whose client argument cannot be encoded as a CBOR
    structure. </p>
    <h3 class="heading settled" data-level="7.4" id="extension-client-processing"><span class="secno">7.4. </span><span class="content">Extending client processing</span><a class="self-link" href="#extension-client-processing"></a></h3>
    <p> Extensions may define additional processing requirements on the client
    platform during the creation of credentials or the generation of an
    assertion. In order for the RP to verify the processing took place, or if
    the processing has a result value that the RP needs to be aware of, the
    extension should specify a client data value to be included in the <code class="idl"><a data-link-type="idl" href="#dictdef-clientdata" id="ref-for-dictdef-clientdata-9">ClientData</a></code> structure. </p>
    <p> The value may be any value that can be encoded as a JSON value. If any
    extension processed by a client defines such a value, the client SHOULD
    include a dictionary in <code class="idl"><a data-link-type="idl" href="#dictdef-clientdata" id="ref-for-dictdef-clientdata-10">ClientData</a></code> with the key <code class="idl"><a data-link-type="idl" href="#dom-clientdata-extensions" id="ref-for-dom-clientdata-extensions-1">extensions</a></code>. For each such extension, the client SHOULD add an
    entry to this dictionary with the extension identifier as the key, and the
    extension’s client data value. </p>
    <h3 class="heading settled" data-level="7.5" id="extension-authenticator-processing"><span class="secno">7.5. </span><span class="content">Extending authenticator processing with signature extensions</span><a class="self-link" href="#extension-authenticator-processing"></a></h3>
    <p> Signature extensions that define additional authenticator processing should
    similarly define an authenticator data value. The value may be any data
    that can be encoded as a CBOR value. An authenticator that processes a
    signature extension that defines such a value must include it in the <code>authenticatorData</code>. </p>
    <p> As specified in <a href="#sec-authenticator-data">§5.2 Authenticator data</a>, the authenticator data
    value of each processed extension is included in the extended data part of
    the <code>authenticatorData</code>. This part is a CBOR map, with extension
    identifiers as keys, and the authenticator data value of each extension as
    the value. </p>
    <h3 class="heading settled" data-level="7.6" id="sample-extensions"><span class="secno">7.6. </span><span class="content">Example extension</span><a class="self-link" href="#sample-extensions"></a></h3>
    <p>This section is non-normative.</p>
    <p> To illustrate the requirements above, consider a hypothetical extension <em>Geo</em>. This extension, if supported, lets both clients and
    authenticators embed their geolocation in signatures. </p>
    <p> The extension identifier is chosen as <code>com.example.fido.geo</code>.
    The client argument is the constant value <code>true</code>, since the
    extension does not require the RP to pass any particular information to the
    client, other than that it requests the use of the extension. The RP sets
    this value in its request for an assertion: </p>
<pre class="highlight">var assertionPromise =
    credentials.getAssertion("SGFuIFNvbG8gc2hvdCBmaXJzdC4",
        {}, /* Empty filter */
        { 'com.example.fido.geo': true });
</pre>
    <p> The extension defines the additional client data to be the client’s location, if known,
  as a GeoJSON <a data-link-type="biblio" href="#biblio-geojson">[GeoJSON]</a> point. The client constructs the following client data: </p>
<pre class="highlight">{
   ...,
   'extensions': {
       'com.example.fido.geo': {
           'type': 'Point',
           'coordinates': [65.059962, -13.993041]
       }
   }
}
</pre>
    <p> The extension also requires the client to set the authenticator parameter to the fixed value <code>1</code>. </p>
    <p> Finally, the extension requires the authenticator to specify its geolocation in the authenticator
  data, if known. The extension e.g. specifies that the location shall be encoded as a two-element
  array of floating point numbers, encoded with CBOR.
  An authenticator does this by including it in the <code>authenticatorData</code>.
  As an example, authenticator data may be as follows (notation taken from <a data-link-type="biblio" href="#biblio-rfc7049">[RFC7049]</a>): </p>
<pre>81 (hex)                      -- Flags, ED and TUP both set.
20 05 58 1F                   -- Signature counter
A1                            -- CBOR map of one element
  68                          -- Key 1: CBOR text string of 8 bytes
    66 69 64 6F 2E 67 65 6F   -- "fido.geo" UTF-8 string
  82                          -- Value 1: CBOR array of two elements
    FA 42 82 1E B3            -- Element 1: Latitude as CBOR encoded float
    FA C1 5F E3 7F            -- Element 2: Longitude as CBOR encoded float
</pre>
    <h2 class="heading settled" data-level="8" id="extension-standard"><span class="secno">8. </span><span class="content">Standard Extensions</span><a class="self-link" href="#extension-standard"></a></h2>
    <p> This section defines standard extensions defined by the FIDO Alliance. </p>
    <h3 class="heading settled" data-level="8.1" id="extension-txauth"><span class="secno">8.1. </span><span class="content">Transaction authorization</span><a class="self-link" href="#extension-txauth"></a></h3>
    <p> This signature extension allows for a simple form of transaction
    authorization. A relying party can specify a prompt string, intended for
    display on a trusted device on the authenticator. </p>
    <dl>
     <dt>Extension identifier
     <dd> <code>fido.txauth.simple</code> 
     <dt>Client argument
     <dd>A single UTF-8 encoded string <em>prompt</em>
     <dt>Client processing
     <dd>None, except default forwarding of client argument to authenticator argument.
     <dt>Authenticator argument
     <dd>The client argument encoded as a CBOR text string (major type 3).
     <dt>Authenticator processing
     <dd>The authenticator MUST display the prompt to the user before performing
        the user verification / test of user presence. The authenticator may insert line breaks if needed.
     <dt>Authenticator data
     <dd>A single UTF-8 string, representing the prompt <em>as displayed</em> (including any
        eventual line breaks).
    </dl>
    <p>The generic version of this extension allows images to be used as prints as well.  This is allows
  authenticators without a font rendering engine to be used and also supports a richer visual appearance.</p>
    <dl>
     <dt>Extension identifier
     <dd> <code>fido.txauth.generic</code> 
     <dt>Client argument
     <dd>
      A CBOR map with one pair of data items (CBOR tagged as 0xa1). The pair of data items consists of 
      <ol>
       <li>one UTF-8 encoded string <dfn data-dfn-for="FIDOAssertion" data-dfn-type="dfn" data-noexport="" id="fidoassertion-contenttype">contentType<a class="self-link" href="#fidoassertion-contenttype"></a></dfn>, containing 
	  the MIME-Type of the content, e.g. "image/png"
       <li>and the <dfn class="dfn-paneled" data-dfn-for="FIDOAssertion" data-dfn-type="dfn" data-lt="content" data-noexport="" id="fidoassertion-content">content<span class="dfn-panel" data-deco=""><b><a href="#fidoassertion-content">#fidoassertion-content</a></b><b>Referenced in:</b><span><a href="#ref-for-fidoassertion-content-1">8.1. Transaction authorization</a> <a href="#ref-for-fidoassertion-content-2">(2)</a> <a href="#ref-for-fidoassertion-content-3">(3)</a> <a href="#ref-for-fidoassertion-content-4">(4)</a> <a href="#ref-for-fidoassertion-content-5">(5)</a></span></span></dfn> itself, encoded as CBOR byte array.
      </ol>
     <dt>Client processing
     <dd>None, except default forwarding of client argument to authenticator argument.
     <dt>Authenticator argument
     <dd>The client argument encoded as a CBOR map.
     <dt>Authenticator processing
     <dd>The authenticator MUST display the <a data-link-type="dfn" href="#fidoassertion-content" id="ref-for-fidoassertion-content-1">content</a> to the user before performing
        the user verification / test of user presence. The authenticator may add other information below the <a data-link-type="dfn" href="#fidoassertion-content" id="ref-for-fidoassertion-content-2">content</a>.
        No changes are allowed to the <a data-link-type="dfn" href="#fidoassertion-content" id="ref-for-fidoassertion-content-3">content</a> itself, i.e. inside <a data-link-type="dfn" href="#fidoassertion-content" id="ref-for-fidoassertion-content-4">content</a> boundary box. 
     <dt>Authenticator data
     <dd> The hash value of the <a data-link-type="dfn" href="#fidoassertion-content" id="ref-for-fidoassertion-content-5">content</a> which was displayed.  
      The authenticator MUST use the same hash algorithm as it uses for the signature itself. 
    </dl>
    <h3 class="heading settled" data-level="8.2" id="extension-authenticator-selection"><span class="secno">8.2. </span><span class="content">Authenticator Selection Extension</span><a class="self-link" href="#extension-authenticator-selection"></a></h3>
    <p> This registration extension allows a Relying Party to guide the selection
    of the authenticator that will be leveraged when creating the credential.
    It is intended primarily for Relying Parties that wish to tightly control
    the experience around credential creation. </p>
    <dl>
     <dt>Extension identifier
     <dd> <code>fido.authn-sel</code> (only used during <code class="idl"><a data-link-type="idl" href="#dom-fidocredentials-makecredential" id="ref-for-dom-fidocredentials-makecredential-9">makeCredential()</a></code>) 
     <dt>Client argument
     <dd>
       A sequence of AAGUIDs: 
<pre class="idl highlight def">typedef sequence &lt; <a data-link-type="idl-name" href="#typedefdef-fidoassertion-aaguid" id="ref-for-typedefdef-fidoassertion-aaguid-1">AAGUID</a> > <dfn class="dfn-paneled idl-code" data-dfn-for="FIDOAssertion" data-dfn-type="typedef" data-export="" data-lt="AuthenticatorSelectionList" id="typedefdef-fidoassertion-authenticatorselectionlist">AuthenticatorSelectionList<span class="dfn-panel" data-deco=""><b><a href="#typedefdef-fidoassertion-authenticatorselectionlist">#typedefdef-fidoassertion-authenticatorselectionlist</a></b><b>Referenced in:</b><span><a href="#ref-for-typedefdef-fidoassertion-authenticatorselectionlist-1">8.2. Authenticator Selection Extension</a></span></span></dfn>;
</pre>
      <p>Each AAGUID corresponds to an authenticator attestation that is
      acceptable to the RP for this credential creation. The list is ordered by
      decreasing preference.<br></p>
      <p>An AAGUID is defined as a DOMString, and is the globally unique identifier
      of the authenticator attestation being sought.</p>
<pre class="idl highlight def">typedef DOMString <dfn class="dfn-paneled idl-code" data-dfn-for="FIDOAssertion" data-dfn-type="typedef" data-export="" data-lt="AAGUID" id="typedefdef-fidoassertion-aaguid">AAGUID<span class="dfn-panel" data-deco=""><b><a href="#typedefdef-fidoassertion-aaguid">#typedefdef-fidoassertion-aaguid</a></b><b>Referenced in:</b><span><a href="#ref-for-typedefdef-fidoassertion-aaguid-1">8.2. Authenticator Selection Extension</a></span></span></dfn>;
</pre>
     <dt>Client processing
     <dd> If the client supports the Authenticator Selection Extension, it MUST use
      the first available authenticator whose AAGUID is present in the <code class="idl"><a data-link-type="idl" href="#typedefdef-fidoassertion-authenticatorselectionlist" id="ref-for-typedefdef-fidoassertion-authenticatorselectionlist-1">AuthenticatorSelectionList</a></code>. If none of the available
      authenticators match a provided AAGUID, the client MUST select an
      authenticator from among the available authenticators to generate the
      credential. 
     <dt>Authenticator argument
     <dd>There is no authenticator argument.
     <dt>Authenticator processing
     <dd>None.
    </dl>
    <h2 class="heading settled" data-level="9" id="iana-considerations"><span class="secno">9. </span><span class="content">IANA Considerations</span><a class="self-link" href="#iana-considerations"></a></h2>
    <p>This specification registers the algorithm names "S256", "S384", "S512", and "SM3"
  with the IANA JSON Web Algorithms registry as defined in section 
  "Cryptographic Algorithms for Digital Signatures and MACs" in <a data-link-type="biblio" href="#biblio-rfc7518">[RFC7518]</a>.</p>
    <p> These names follow the naming strategy in <a href="https://tools.ietf.org/html/draft-ietf-oauth-spop-15">draft-ietf-oauth-spop-15</a>. </p>
    <p></p>
    <table class="def">
     <tbody>
      <tr>
       <td>Algorithm Name
       <td>"S256"
      <tr>
       <td>Algorithm Description
       <td>The SHA256 hash algorithm.
      <tr>
       <td>Algorithm Usage Location(s)
       <td>"alg", i.e. used with JWS.
      <tr>
       <td>JOSE Implementation Requirements
       <td>Optional+
      <tr>
       <td>Change Controller
       <td>FIDO Alliance, <a href="https://fidoalliance.org/contact/">Contact Us</a>
      <tr>
       <td>Specification Documents
       <td> <a data-link-type="biblio" href="#biblio-fips-180-4">[FIPS-180-4]</a> 
      <tr>
       <td>Algorithm Analysis Document(s)
       <td><a data-link-type="biblio" href="#biblio-sp800-107r1">[SP800-107r1]</a>
    </table>
    <p></p>
    <p></p>
    <table class="def">
     <tbody>
      <tr>
       <td>Algorithm Name
       <td>"S384"
      <tr>
       <td>Algorithm Description
       <td>The SHA384 hash algorithm.
      <tr>
       <td>Algorithm Usage Location(s)
       <td>"alg", i.e. used with JWS.
      <tr>
       <td>JOSE Implementation Requirements
       <td>Optional
      <tr>
       <td>Change Controller
       <td>FIDO Alliance, <a href="https://fidoalliance.org/contact/">Contact Us</a>
      <tr>
       <td>Specification Documents
       <td> <a data-link-type="biblio" href="#biblio-fips-180-4">[FIPS-180-4]</a> 
      <tr>
       <td>Algorithm Analysis Document(s)
       <td><a data-link-type="biblio" href="#biblio-sp800-107r1">[SP800-107r1]</a>
    </table>
    <p></p>
    <p></p>
    <table class="def">
     <tbody>
      <tr>
       <td>Algorithm Name
       <td>"S512"
      <tr>
       <td>Algorithm Description
       <td>The SHA512 hash algorithm.
      <tr>
       <td>Algorithm Usage Location(s)
       <td>"alg", i.e. used with JWS.
      <tr>
       <td>JOSE Implementation Requirements
       <td>Optional+
      <tr>
       <td>Change Controller
       <td>FIDO Alliance, <a href="https://fidoalliance.org/contact/">Contact Us</a>
      <tr>
       <td>Specification Documents
       <td> <a data-link-type="biblio" href="#biblio-fips-180-4">[FIPS-180-4]</a> 
      <tr>
       <td>Algorithm Analysis Document(s)
       <td><a data-link-type="biblio" href="#biblio-sp800-107r1">[SP800-107r1]</a>
    </table>
    <p></p>
    <p></p>
    <table class="def">
     <tbody>
      <tr>
       <td>Algorithm Name
       <td>"SM3"
      <tr>
       <td>Algorithm Description
       <td>The SM3 hash algorithm.
      <tr>
       <td>Algorithm Usage Location(s)
       <td>"alg", i.e. used with JWS.
      <tr>
       <td>JOSE Implementation Requirements
       <td>Optional
      <tr>
       <td>Change Controller
       <td>FIDO Alliance, <a href="https://fidoalliance.org/contact/">Contact Us</a>
      <tr>
       <td>Specification Documents
       <td> <a data-link-type="biblio" href="#biblio-oscca-sm3">[OSCCA-SM3]</a> 
      <tr>
       <td>Algorithm Analysis Document(s)
       <td>N/A
    </table>
    <p></p>
    <h2 class="heading settled" data-level="10" id="sample-scenarios"><span class="secno">10. </span><span class="content">Sample scenarios</span><a class="self-link" href="#sample-scenarios"></a></h2>
    <p><em>This section is not normative.</em></p>
    <p>In this section, we walk through some events in the lifecycle of a FIDO 2.0 credential, along with the corresponding sample code for using this API. Note that this is an example flow, and does not limit the scope of how the API can be used.</p>
    <p>As was the case in earlier sections, this flow focuses on a use case involving an external first-factor authenticator with its own display. One example of such an authenticator would be a smart phone. Other authenticator types are also supported by this API, subject to implementation by the platform. For instance, this flow also works without modification for the case of an authenticator that is embedded in the client platform. The flow also works for the case of an external authenticator without its own display (similar to a smart card) subject to specific implementation considerations. Specifically, the client platform needs to display any prompts that would otherwise be shown by the authenticator, and the authenticator needs to allow the client platform to enumerate all the authenticator’s credentials so that the client can have information to show appropriate prompts.</p>
    <h3 class="heading settled" data-level="10.1" id="sample-registration"><span class="secno">10.1. </span><span class="content">Registration</span><a class="self-link" href="#sample-registration"></a></h3>
    <p>This is the first time flow, when a new credential is created and registered with the server. </p>
    <ol type="1">
     <li>The user visits example.com, which serves up a script. At this point, the user must already be logged in using a legacy username and password, or additional authenticator, or other means acceptable to the Relying Party.
     <li>The Relying Party script runs the code snippet below. 
     <li>The client platform searches for and locates the external authenticator.
     <li>The client platform connects to the external authenticator, performing any pairing actions if necessary.
     <li>The external authenticator shows appropriate UI for the user to select the authenticator on which the new credential will be created, and obtains a biometric or other authorization gesture from the user.
     <li>The external authenticator returns a response to the client platform, which in turn returns a response to the RP script. If the user declined to select an authenticator or provide authorization, an appropriate error is returned.
     <li>
      If a new credential was created, 
      <ol type="a">
       <li>The RP script sends the newly generated public key to the server, along with additional information about public key such as attestation that it is held in trusted hardware.
       <li>The server stores the public key in its database and associates it with the user as well as with the strength of authentication indicated by attestation, also storing a friendly name for later use.
       <li>The script may store data such as the credential ID in local storage, to improve future UX by narrowing the choice of credential for the user.
      </ol>
    </ol>
    <p>The sample code for generating and registering a new key follows:</p>
<pre class="example highlight" id="example-5ec18e9f"><a class="self-link" href="#example-5ec18e9f"></a>var fidoAPI = window.fido;

if (!fidoAPI) { /* Platform not capable. Handle error. */ }

var userAccountInformation = {
  rpDisplayName: "PayPal",
  displayName: "John P. Smith",
  name: "johnpsmith@gmail.com",
  id: "1098237235409872";
  imageUri: "https://pics.paypal.com/00/p/aBjjjpqPb.png"
};

// This RP will accept either an ES256 or RS256 credential, but 
// prefers an ES256 credential.
var cryptoParams = [
  { 
    type: "FIDO",
    algorithm: "ES256",
  },
  {
    type: "FIDO",
    algorithm: "RS256",
  }
];
var challenge = "Y2xpbWIgYSBtb3VudGFpbg";
var timeoutSeconds = 300;  // 5 minutes
var blacklist = [];  // No blacklist
var extensions = {"fido.location": true};  // Include location information 
                                           // in attestation


// Note: The following call will cause the authenticator to display UI.
fidoAPI.makeCredential(userAccountInformation, cryptoParams, challenge,
                       timeoutSeconds, blacklist, extensions)
  .then(function (newCredentialInfo) {
    // Send new credential info to server for verification and registration.
}).catch(function (err) {
    // No acceptable authenticator or user refused consent. Handle appropriately.
});
</pre>
    <h3 class="heading settled" data-level="10.2" id="sample-authentication"><span class="secno">10.2. </span><span class="content">Authentication</span><a class="self-link" href="#sample-authentication"></a></h3>
    <p>This is the flow when a user with an already registered credential visits a website and wants to authenticate using the credential.</p>
    <ol type="1">
     <li>The user visits example.com, which serves up a script.
     <li>The script asks the client platform for a FIDO identity assertion, providing as much information as possible to narrow the choice of acceptable credentials for the user. This may be obtained from the data that was stored locally after registration, or by other means such as prompting the user for a username.
     <li>The Relying Party script runs one of the code snippets below.
     <li>The client platform searches for and locates the external authenticator.
     <li>The client platform connects to the external authenticator, performing any pairing actions if necessary.
     <li>The external authenticator presents the user with a notification that their attention is required. On opening the notification, the user is shown a friendly selection menu of acceptable credentials using the account information provided when creating the credentials, along with some information on the origin that is requesting these keys.
     <li>The authenticator obtains a biometric or other authorization gesture from the user.
     <li>The external authenticator returns a response to the client platform, which in turn returns a response to the RP script. If the user declined to select a credential or provide an authorization, an appropriate error is returned.
     <li>
      If an assertion was successfully generated and returned, 
      <ol type="a">
       <li>The script sends the assertion to the server.
       <li>The server examines the assertion and validates that it was correctly generated. If so, it looks up the identity associated with the associated public key; that identity is now authenticated. If the public key is not recognized by the server (e.g., deregistered by server due to inactivity) then the authentication has failed; each Relying Party will handle this in its own way.
       <li>The server now does whatever it would otherwise do upon successful authentication — return a success page, set authentication cookies, etc.
      </ol>
    </ol>
    <p>If the Relying Party script does not have any hints available (e.g., from locally stored data) to help it narrow the list of credentials, then the sample code for performing such an authentication might look like this:</p>
<pre class="example highlight" id="example-2ad471c8"><a class="self-link" href="#example-2ad471c8"></a>var fidoAPI = window.fido;

if (!fidoAPI) { /* Platform not capable. Handle error. */ }

var challenge = "Y2xpbWIgYSBtb3VudGFpbg";
var timeoutSeconds = 300;  // 5 minutes
var whitelist = [{ type: "FIDO" }];

fidoAPI.getAssertion(challenge, timeoutSeconds, whitelist)
  .then(function (assertion) {
    // Send assertion to server for verification
}).catch(function (err) {
    // No acceptable credential or user refused consent. Handle appropriately.
});
</pre>
    <p>On the other hand, if the Relying Party script has some hints to help it narrow the list of credentials, then the sample code for performing such an authentication might look like the following. Note that this sample also demonstrates how to use the extension for transaction authorization.</p>
<pre class="example highlight" id="example-4cd7d657"><a class="self-link" href="#example-4cd7d657"></a>var fidoAPI = window.fido;

if (!fidoAPI) { /* Platform not capable. Handle error. */ }

var challenge = "Y2xpbWIgYSBtb3VudGFpbg";
var timeoutSeconds = 300;  // 5 minutes
var acceptableCredential1 = {
  type: "FIDO",
  id: "ISEhISEhIWhpIHRoZXJlISEhISEhIQo=",
};
var acceptableCredential2 = {
  type: "FIDO",
  id: "cm9zZXMgYXJlIHJlZCwgdmlvbGV0cyBhcmUgYmx1ZQo=",
};
var whitelist = [acceptableCredential1, acceptableCredential2];
var extensions = { 'fido.txauth.simple': 
                   "Wave your hands in the air like you just don’t care" };
            
fidoAPI.getAssertion(challenge, timeoutSeconds, whitelist, extensions)
  .then(function (assertion) {
    // Send assertion to server for verification
}).catch(function (err) {
    // No acceptable credential or user refused consent. Handle appropriately.
});
</pre>
    <h3 class="heading settled" data-level="10.3" id="sample-decommissioning"><span class="secno">10.3. </span><span class="content">Decommissioning</span><a class="self-link" href="#sample-decommissioning"></a></h3>
    <p>The following are possible situations in which decommissioning a credential might be desired. Note that all of these are handled on the server side and do not need support from the API specified here.</p>
    <ul>
     <li>
       Possibility #1 — user reports the credential as lost. 
      <ul>
       <li>User goes to server.example.net, authenticates and follows a link to report a lost/stolen device.
       <li>Server returns a page showing the list of registered credentials with friendly names as configured during registration.
       <li>User selects a credential and the server deletes it from its database.
       <li>In future, Relying Party script does not specify this credential in any list of acceptable credentials, and assertions signed by this credential are rejected.
      </ul>
     <li>
       Possibility #2 — server deregisters the credential due to inactivity. 
      <ul>
       <li>Server deletes credential from its database during maintenance activity.
       <li>In the future, the Relying Party script does not specify this credential in any list of acceptable credentials, and assertions signed by this credential are rejected.
      </ul>
     <li>
       Possibility #3 — user deletes the credential from the device. 
      <ul>
       <li>User employs a device-specific method (e.g., device settings UI) to delete a credential from their device.
       <li>From this point on, this credential will not appear in any selection prompts, and no assertions can be generated with it.
       <li>Sometime later, the server deregisters this credential due to inactivity.
      </ul>
    </ul>
    <h2 class="heading settled" data-level="11" id="acknowledgements"><span class="secno">11. </span><span class="content">Acknowledgements</span><a class="self-link" href="#acknowledgements"></a></h2>
    <p>We would like to thank the following for their contributions to, and thorough review of, this specification: Jing Jin, Michael B. Jones, Rolf Lindemann. </p>
   </div>
  </main>
<script>
(function() {
  "use strict";
  var collapseSidebarText = '<span aria-hidden="true">←</span> '
                          + '<span>Collapse Sidebar</span>';
  var expandSidebarText   = '<span aria-hidden="true">→</span> '
                          + '<span>Pop Out Sidebar</span>';
  var tocJumpText         = '<span aria-hidden="true">↑</span> '
                          + '<span>Jump to Table of Contents</span>';

  var sidebarMedia = window.matchMedia('screen and (min-width: 78em)');
  var autoToggle   = function(e){ toggleSidebar(e.matches) };
  if(sidebarMedia.addListener) {
    sidebarMedia.addListener(autoToggle);
  }

  function toggleSidebar(on) {
    if (on == undefined) {
      on = !document.body.classList.contains('toc-sidebar');
    }

    /* Don’t scroll to compensate for the ToC if we’re above it already. */
    var headY = 0;
    var head = document.querySelector('.head');
    if (head) {
      // terrible approx of "top of ToC"
      headY += head.offsetTop + head.offsetHeight;
    }
    var skipScroll = window.scrollY < headY;

    var toggle = document.getElementById('toc-toggle');
    var tocNav = document.getElementById('toc');
    if (on) {
      var tocHeight = tocNav.offsetHeight;
      document.body.classList.add('toc-sidebar');
      document.body.classList.remove('toc-inline');
      toggle.innerHTML = collapseSidebarText;
      if (!skipScroll) {
        window.scrollBy(0, 0 - tocHeight);
      }
      tocNav.focus();
      sidebarMedia.addListener(autoToggle); // auto-collapse when out of room
    }
    else {
      document.body.classList.add('toc-inline');
      document.body.classList.remove('toc-sidebar');
      toggle.innerHTML = expandSidebarText;
      if (!skipScroll) {
        window.scrollBy(0, tocNav.offsetHeight);
      }
      if (toggle.matches(':hover')) {
        /* Unfocus button when not using keyboard navigation,
           because I don’t know where else to send the focus. */
        toggle.blur();
      }
    }
  }

  function createSidebarToggle() {
    /* Create the sidebar toggle in JS; it shouldn’t exist when JS is off. */
    var toggle = document.createElement('a');
      /* This should probably be a button, but appearance isn’t standards-track.*/
    toggle.id = 'toc-toggle';
    toggle.class = 'toc-toggle';
    toggle.href = '#toc';
    toggle.innerHTML = collapseSidebarText;

    sidebarMedia.addListener(autoToggle);
    var toggler = function(e) {
      e.preventDefault();
      sidebarMedia.removeListener(autoToggle); // persist explicit off states
      toggleSidebar();
      return false;
    }
    toggle.addEventListener('click', toggler, false);


    /* Get <nav id=toc-nav>, or make it if we don’t have one. */
    var tocNav = document.getElementById('toc-nav');
    if (!tocNav) {
      tocNav = document.createElement('p');
      tocNav.id = 'toc-nav';
      /* Prepend for better keyboard navigation */
      document.body.insertBefore(tocNav, document.body.firstChild);
    }
    /* While we’re at it, make sure we have a Jump to Toc link. */
    var tocJump = document.getElementById('toc-jump');
    if (!tocJump) {
      tocJump = document.createElement('a');
      tocJump.id = 'toc-jump';
      tocJump.href = '#toc';
      tocJump.innerHTML = tocJumpText;
      tocNav.appendChild(tocJump);
    }

    tocNav.appendChild(toggle);
  }

  var toc = document.getElementById('toc');
  if (toc) {
    createSidebarToggle();
    toggleSidebar(sidebarMedia.matches);

    /* If the sidebar has been manually opened and is currently overlaying the text
       (window too small for the MQ to add the margin to body),
       then auto-close the sidebar once you click on something in there. */
    toc.addEventListener('click', function(e) {
      if(e.target.tagName.toLowerCase() == "a" && document.body.classList.contains('toc-sidebar') && !sidebarMedia.matches) {
        toggleSidebar(false);
      }
    }, false);
  }
  else {
    console.warn("Can’t find Table of Contents. Please use <nav id='toc'> around the ToC.");
  }

  /* Wrap tables in case they overflow */
  var tables = document.querySelectorAll(':not(.overlarge) > table.data, :not(.overlarge) > table.index');
  var numTables = tables.length;
  for (var i = 0; i < numTables; i++) {
    var table = tables[i];
    var wrapper = document.createElement('div');
    wrapper.className = 'overlarge';
    table.parentNode.insertBefore(wrapper, table);
    wrapper.appendChild(table);
  }

})();
</script>
  <h2 class="no-num no-ref heading settled" id="index"><span class="content">Index</span><a class="self-link" href="#index"></a></h2>
  <h3 class="no-num no-ref heading settled" id="index-defined-here"><span class="content">Terms defined by this specification</span><a class="self-link" href="#index-defined-here"></a></h3>
  <ul class="index">
   <li><a href="#typedefdef-fidoassertion-aaguid">AAGUID</a><span>, in §8.2</span>
   <li><a href="#dictdef-account">Account</a><span>, in §4.3</span>
   <li><a href="#accountinformation">accountInformation</a><span>, in §4.1.1</span>
   <li>
    alg
    <ul>
     <li><a href="#dom-attestationheader-alg">attribute for AttestationHeader</a><span>, in §6.3.2</span>
     <li><a href="#attestationheader-alg">dfn for AttestationHeader</a><span>, in §6.3.2</span>
    </ul>
   <li>
    algorithm
    <ul>
     <li><a href="#dom-fidocredentialinfo-algorithm">attribute for FIDOCredentialInfo</a><span>, in §4</span>
     <li><a href="#dom-fidocredentialparameters-algorithm">dict-member for FIDOCredentialParameters</a><span>, in §4</span>
     <li><a href="#fidocredentialinfo-algorithm">dfn for FIDOCredentialInfo</a><span>, in §4.2</span>
     <li><a href="#fidocredentialparameters-algorithm">dfn for FIDOCredentialParameters</a><span>, in §4.4</span>
    </ul>
   <li><a href="#algorithmidentifier">AlgorithmIdentifier</a><span>, in §2.1</span>
   <li><a href="#dictdef-fidoassertion-androidattestationclientdata">AndroidAttestationClientData</a><span>, in §6.4.3.4</span>
   <li><a href="#assertionchallenge">assertionChallenge</a><span>, in §4.1.2</span>
   <li><a href="#assertionextensions">assertionExtensions</a><span>, in §4.1.2</span>
   <li><a href="#assertiontimeoutseconds">assertionTimeoutSeconds</a><span>, in §4.1.2</span>
   <li>
    attestation
    <ul>
     <li><a href="#dom-fidocredentialinfo-attestation">attribute for FIDOCredentialInfo</a><span>, in §4</span>
     <li><a href="#fidocredentialinfo-attestation">dfn for FIDOCredentialInfo</a><span>, in §4.2</span>
    </ul>
   <li><a href="#attestationchallenge">attestationChallenge</a><span>, in §4.1.1</span>
   <li><a href="#fidoassertion-attestationcore">AttestationCore</a><span>, in §6.3.1</span>
   <li><a href="#fidoassertion-attestation-data">attestation data</a><span>, in §6.1.2</span>
   <li><a href="#fidoassertion-attestationheader">AttestationHeader</a><span>, in §6.3.2</span>
   <li>
    AttestationStatement
    <ul>
     <li><a href="#attestationstatement">definition of</a><span>, in §4.5.6</span>
     <li><a href="#fidoassertion-attestationstatement">interface for FIDOAssertion</a><span>, in §6.3</span>
    </ul>
   <li><a href="#fidoassertion-authenticator-argument">authenticator
    argument</a><span>, in §7.3</span>
   <li><a href="#authenticatorcancel">authenticatorCancel</a><span>, in §3.3</span>
   <li><a href="#dom-fidoassertion-authenticatordata">authenticatorData</a><span>, in §5.4</span>
   <li><a href="#authenticator-data">authenticator data</a><span>, in §5</span>
   <li><a href="#authenticatorgetassertion">authenticatorGetAssertion</a><span>, in §3.2</span>
   <li><a href="#authenticatormakecredential">authenticatorMakeCredential</a><span>, in §3.1</span>
   <li><a href="#typedefdef-fidoassertion-authenticatorselectionlist">AuthenticatorSelectionList</a><span>, in §8.2</span>
   <li><a href="#blacklist">blacklist</a><span>, in §4.1.1</span>
   <li>
    challenge
    <ul>
     <li><a href="#dom-clientdata-challenge">dict-member for ClientData</a><span>, in §5.1</span>
     <li><a href="#clientdata-challenge">dfn for ClientData</a><span>, in §5.1</span>
    </ul>
   <li>
    claimedAAGUID
    <ul>
     <li><a href="#dom-attestationheader-claimedaaguid">attribute for AttestationHeader</a><span>, in §6.3.2</span>
     <li><a href="#attestationheader-claimedaaguid">dfn for AttestationHeader</a><span>, in §6.3.2</span>
    </ul>
   <li><a href="#fidoassertion-client-argument">client argument</a><span>, in §7.3</span>
   <li>
    client data
    <ul>
     <li><a href="#client-data">definition of</a><span>, in §5</span>
     <li><a href="#fidoassertion-client-data">dfn for FIDOAssertion</a><span>, in §6.1.2</span>
    </ul>
   <li>
    clientData
    <ul>
     <li><a href="#dom-fidoassertion-clientdata">attribute for FIDOAssertion</a><span>, in §5.4</span>
     <li><a href="#fidoassertion-clientdata">dfn for FIDOAssertion</a><span>, in §5.4</span>
     <li><a href="#dom-attestationcore-clientdata">attribute for AttestationCore</a><span>, in §6.3.1</span>
     <li><a href="#attestationcore-clientdata">dfn for AttestationCore</a><span>, in §6.3.1</span>
    </ul>
   <li><a href="#dictdef-clientdata">ClientData</a><span>, in §5.1</span>
   <li><a href="#clientdatajson">clientDataJSON</a><span>, in §5.1</span>
   <li><a href="#conforming-user-agent">conforming user agent</a><span>, in §2</span>
   <li><a href="#fidoassertion-content">content</a><span>, in §8.1</span>
   <li><a href="#fidoassertion-contenttype">contentType</a><span>, in §8.1</span>
   <li>
    core
    <ul>
     <li><a href="#dom-attestationstatement-core">attribute for AttestationStatement</a><span>, in §6.3</span>
     <li><a href="#attestationstatement-core">dfn for AttestationStatement</a><span>, in §6.3</span>
    </ul>
   <li><a href="#credential">Credential</a><span>, in §4.5.2</span>
   <li>
    credential
    <ul>
     <li><a href="#dom-fidocredentialinfo-credential">attribute for FIDOCredentialInfo</a><span>, in §4</span>
     <li><a href="#fidocredentialinfo-credential">dfn for FIDOCredentialInfo</a><span>, in §4.2</span>
     <li><a href="#dom-fidoassertion-credential">attribute for FIDOAssertion</a><span>, in §5.4</span>
     <li><a href="#fidoassertion-credential">dfn for FIDOAssertion</a><span>, in §5.4</span>
    </ul>
   <li><a href="#credentialextensions">credentialExtensions</a><span>, in §4.1.1</span>
   <li><a href="#credentialtimeoutseconds">credentialTimeoutSeconds</a><span>, in §4.1.1</span>
   <li><a href="#enumdef-credentialtype">CredentialType</a><span>, in §4.5.1</span>
   <li><a href="#cryptoparameters">cryptoParameters</a><span>, in §4.1.1</span>
   <li>
    displayName
    <ul>
     <li><a href="#dom-account-displayname">dict-member for Account</a><span>, in §4</span>
     <li><a href="#account-displayname">dfn for Account</a><span>, in §4.3</span>
    </ul>
   <li><a href="#domexception">DOMException</a><span>, in §2.1</span>
   <li><a href="#embedded-authenticators">Embedded authenticators</a><span>, in §1</span>
   <li>
    extensions
    <ul>
     <li><a href="#dom-clientdata-extensions">dict-member for ClientData</a><span>, in §5.1</span>
     <li><a href="#clientdata-extensions">dfn for ClientData</a><span>, in §5.1</span>
    </ul>
   <li><a href="#external-authenticators">External authenticators</a><span>, in §1</span>
   <li>
    facet
    <ul>
     <li><a href="#dom-clientdata-facet">dict-member for ClientData</a><span>, in §5.1</span>
     <li><a href="#clientdata-facet">dfn for ClientData</a><span>, in §5.1</span>
    </ul>
   <li><a href="#dom-window-fido">fido</a><span>, in §4</span>
   <li><a href="#dom-credentialtype-fido">"FIDO"</a><span>, in §4</span>
   <li><a href="#credentialtype-fido">FIDO</a><span>, in §4.5.1</span>
   <li><a href="#fidoassertion">FIDOAssertion</a><span>, in §5.4</span>
   <li><a href="#fidocredentialinfo">FIDOCredentialInfo</a><span>, in §4.2</span>
   <li><a href="#dictdef-fidocredentialparameters">FIDOCredentialParameters</a><span>, in §4.4</span>
   <li><a href="#fidocredentials">FIDOCredentials</a><span>, in §4.1</span>
   <li>
    FIDOExtensions
    <ul>
     <li><a href="#dictdef-fidoextensions">(dictionary)</a><span>, in §4</span>
     <li><a href="#fidoextensions">definition of</a><span>, in §4.5.5</span>
    </ul>
   <li><a href="#dom-fidocredentials-getassertion">getAssertion(assertionChallenge)</a><span>, in §4.1.2</span>
   <li><a href="#dom-fidocredentials-getassertion">getAssertion(assertionChallenge, assertionTimeoutSeconds)</a><span>, in §4.1.2</span>
   <li><a href="#dom-fidocredentials-getassertion">getAssertion(assertionChallenge, assertionTimeoutSeconds, whitelist)</a><span>, in §4.1.2</span>
   <li><a href="#dom-fidocredentials-getassertion">getAssertion(assertionChallenge, assertionTimeoutSeconds, whitelist, assertionExtensions)</a><span>, in §4.1.2</span>
   <li>
    hashAlg
    <ul>
     <li><a href="#dom-clientdata-hashalg">dict-member for ClientData</a><span>, in §5.1</span>
     <li><a href="#clientdata-hashalg">dfn for ClientData</a><span>, in §5.1</span>
    </ul>
   <li>
    header
    <ul>
     <li><a href="#dom-attestationstatement-header">attribute for AttestationStatement</a><span>, in §6.3</span>
     <li><a href="#attestationstatement-header">dfn for AttestationStatement</a><span>, in §6.3</span>
    </ul>
   <li>
    id
    <ul>
     <li><a href="#dom-account-id">dict-member for Account</a><span>, in §4</span>
     <li><a href="#dom-credential-id">attribute for Credential</a><span>, in §4</span>
     <li><a href="#account-id">dfn for Account</a><span>, in §4.3</span>
     <li><a href="#credential-id">dfn for Credential</a><span>, in §4.5.2</span>
    </ul>
   <li>
    imageUri
    <ul>
     <li><a href="#dom-account-imageuri">dict-member for Account</a><span>, in §4</span>
     <li><a href="#account-imageuri">dfn for Account</a><span>, in §4.3</span>
    </ul>
   <li>
    isInsideSecureHardware
    <ul>
     <li><a href="#dom-androidattestationclientdata-isinsidesecurehardware">dict-member for AndroidAttestationClientData</a><span>, in §6.4.3.4</span>
     <li><a href="#androidattestationclientdata-isinsidesecurehardware">dfn for AndroidAttestationClientData</a><span>, in §6.4.3.4</span>
    </ul>
   <li><a href="#jsonwebkey">JsonWebKey</a><span>, in §2.1</span>
   <li><a href="#dom-fidocredentials-makecredential">makeCredential(accountInformation, cryptoParameters, attestationChallenge)</a><span>, in §4.1.1</span>
   <li><a href="#dom-fidocredentials-makecredential">makeCredential(accountInformation, cryptoParameters, attestationChallenge, credentialTimeoutSeconds)</a><span>, in §4.1.1</span>
   <li><a href="#dom-fidocredentials-makecredential">makeCredential(accountInformation, cryptoParameters, attestationChallenge, credentialTimeoutSeconds, blacklist)</a><span>, in §4.1.1</span>
   <li><a href="#dom-fidocredentials-makecredential">makeCredential(accountInformation, cryptoParameters, attestationChallenge, credentialTimeoutSeconds, blacklist, credentialExtensions)</a><span>, in §4.1.1</span>
   <li>
    name
    <ul>
     <li><a href="#dom-account-name">dict-member for Account</a><span>, in §4</span>
     <li><a href="#account-name">dfn for Account</a><span>, in §4.3</span>
    </ul>
   <li><a href="#origin">origin</a><span>, in §2.1</span>
   <li><a href="#promises">Promises</a><span>, in §2.1</span>
   <li>
    publicKey
    <ul>
     <li><a href="#dom-fidocredentialinfo-publickey">attribute for FIDOCredentialInfo</a><span>, in §4</span>
     <li><a href="#fidocredentialinfo-publickey">dfn for FIDOCredentialInfo</a><span>, in §4.2</span>
     <li><a href="#dom-androidattestationclientdata-publickey">dict-member for AndroidAttestationClientData</a><span>, in §6.4.3.4</span>
     <li><a href="#androidattestationclientdata-publickey">dfn for AndroidAttestationClientData</a><span>, in §6.4.3.4</span>
    </ul>
   <li>
    rawData
    <ul>
     <li><a href="#dom-attestationcore-rawdata">attribute for AttestationCore</a><span>, in §6.3.1</span>
     <li><a href="#attestationcore-rawdata">dfn for AttestationCore</a><span>, in §6.3.1</span>
    </ul>
   <li>
    rpDisplayName
    <ul>
     <li><a href="#dom-account-rpdisplayname">dict-member for Account</a><span>, in §4</span>
     <li><a href="#account-rpdisplayname">dfn for Account</a><span>, in §4.3</span>
    </ul>
   <li><a href="#secure-contexts">secure contexts</a><span>, in §4</span>
   <li>
    signature
    <ul>
     <li><a href="#dom-fidoassertion-signature">attribute for FIDOAssertion</a><span>, in §5.4</span>
     <li><a href="#fidoassertion-signature">dfn for FIDOAssertion</a><span>, in §5.4</span>
     <li><a href="#dom-attestationstatement-signature">attribute for AttestationStatement</a><span>, in §6.3</span>
     <li><a href="#attestationstatement-signature">dfn for AttestationStatement</a><span>, in §6.3</span>
    </ul>
   <li>
    tokenBinding
    <ul>
     <li><a href="#dom-clientdata-tokenbinding">dict-member for ClientData</a><span>, in §5.1</span>
     <li><a href="#clientdata-tokenbinding">dfn for ClientData</a><span>, in §5.1</span>
    </ul>
   <li>
    type
    <ul>
     <li><a href="#dom-fidocredentialparameters-type">dict-member for FIDOCredentialParameters</a><span>, in §4</span>
     <li><a href="#dom-credential-type">attribute for Credential</a><span>, in §4</span>
     <li><a href="#fidocredentialparameters-type">dfn for FIDOCredentialParameters</a><span>, in §4.4</span>
     <li><a href="#credential-type">dfn for Credential</a><span>, in §4.5.2</span>
     <li><a href="#dom-attestationcore-type">attribute for AttestationCore</a><span>, in §6.3.1</span>
     <li><a href="#attestationcore-type">dfn for AttestationCore</a><span>, in §6.3.1</span>
    </ul>
   <li>
    userAuthentication
    <ul>
     <li><a href="#dom-androidattestationclientdata-userauthentication">dict-member for AndroidAttestationClientData</a><span>, in §6.4.3.4</span>
     <li><a href="#androidattestationclientdata-userauthentication">dfn for AndroidAttestationClientData</a><span>, in §6.4.3.4</span>
    </ul>
   <li>
    userAuthenticationValidityDurationSeconds
    <ul>
     <li><a href="#dom-androidattestationclientdata-userauthenticationvaliditydurationseconds">dict-member for AndroidAttestationClientData</a><span>, in §6.4.3.4</span>
     <li><a href="#androidattestationclientdata-userauthenticationvaliditydurationseconds">dfn for AndroidAttestationClientData</a><span>, in §6.4.3.4</span>
    </ul>
   <li>
    version
    <ul>
     <li><a href="#dom-attestationcore-version">attribute for AttestationCore</a><span>, in §6.3.1</span>
     <li><a href="#attestationcore-version">dfn for AttestationCore</a><span>, in §6.3.1</span>
    </ul>
   <li><a href="#whitelist">whitelist</a><span>, in §4.1.2</span>
   <li><a href="#window">Window</a><span>, in §2.1</span>
   <li>
    x5c
    <ul>
     <li><a href="#dom-attestationheader-x5c">attribute for AttestationHeader</a><span>, in §6.3.2</span>
     <li><a href="#attestationheader-x5c">dfn for AttestationHeader</a><span>, in §6.3.2</span>
    </ul>
  </ul>
  <h3 class="no-num no-ref heading settled" id="index-defined-elsewhere"><span class="content">Terms defined by reference</span><a class="self-link" href="#index-defined-elsewhere"></a></h3>
  <ul class="index">
   <li>
    <a data-link-type="biblio" href="#biblio-html">[HTML]</a> defines the following terms:
    <ul>
     <li><a href="https://html.spec.whatwg.org/multipage/browsers.html#window">Window</a>
    </ul>
  </ul>
  <h2 class="no-num no-ref heading settled" id="references"><span class="content">References</span><a class="self-link" href="#references"></a></h2>
  <h3 class="no-num no-ref heading settled" id="normative"><span class="content">Normative References</span><a class="self-link" href="#normative"></a></h3>
  <dl>
   <dt id="biblio-dom4">[DOM4]
   <dd>Anne van Kesteren; et al. <a href="http://www.w3.org/TR/dom/">W3C DOM4</a>. 19 November 2015. REC. URL: <a href="http://www.w3.org/TR/dom/">http://www.w3.org/TR/dom/</a>
   <dt id="biblio-fidoecdaaalgorithm">[FIDOEcdaaAlgorithm]
   <dd>R. Lindemann; A. Edgington; R. Urian. FIDO ECDAA Algorithm. FIDO Alliance Proposed Standard (To Be Published). 
   <dt id="biblio-fidokeyattestation">[FIDOKeyAttestation]
   <dd>FIDO 2.0: Key attestation format. 
   <dt id="biblio-fips-180-4">[FIPS-180-4]
   <dd><a href="http://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.180-4.pdf">FIPS PUB 180-4 Secure Hash Standard</a>. URL: <a href="http://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.180-4.pdf">http://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.180-4.pdf</a>
   <dt id="biblio-html">[HTML]
   <dd>Ian Hickson. <a href="https://html.spec.whatwg.org/multipage/">HTML Standard</a>. Living Standard. URL: <a href="https://html.spec.whatwg.org/multipage/">https://html.spec.whatwg.org/multipage/</a>
   <dt id="biblio-html5">[HTML5]
   <dd>Ian Hickson; et al. <a href="http://www.w3.org/TR/html5/">HTML5</a>. 28 October 2014. REC. URL: <a href="http://www.w3.org/TR/html5/">http://www.w3.org/TR/html5/</a>
   <dt id="biblio-oscca-sm3">[OSCCA-SM3]
   <dd><a href="http://www.oscca.gov.cn/UpFile/20101222141857786.pdf">SM3 Cryptographic Hash Algorithm</a>. December 2010. URL: <a href="http://www.oscca.gov.cn/UpFile/20101222141857786.pdf">http://www.oscca.gov.cn/UpFile/20101222141857786.pdf</a>
   <dt id="biblio-rfc7515">[RFC7515]
   <dd>M. Jones; J. Bradley; N. Sakimura. <a href="https://tools.ietf.org/html/rfc7515">JSON Web Signature (JWS)</a>. May 2015. Proposed Standard. URL: <a href="https://tools.ietf.org/html/rfc7515">https://tools.ietf.org/html/rfc7515</a>
   <dt id="biblio-rfc7518">[RFC7518]
   <dd>M. Jones. <a href="https://tools.ietf.org/html/rfc7518">JSON Web Algorithms (JWA)</a>. May 2015. Proposed Standard. URL: <a href="https://tools.ietf.org/html/rfc7518">https://tools.ietf.org/html/rfc7518</a>
   <dt id="biblio-sec1">[SEC1]
   <dd><a href="http://www.secg.org/sec1-v2.pdf">SEC1: Elliptic Curve Cryptography, Version 2.0</a>. URL: <a href="http://www.secg.org/sec1-v2.pdf">http://www.secg.org/sec1-v2.pdf</a>
   <dt id="biblio-webcryptoapi">[WebCryptoAPI]
   <dd>Ryan Sleevi; Mark Watson. <a href="http://www.w3.org/TR/WebCryptoAPI/">Web Cryptography API</a>. 11 December 2014. CR. URL: <a href="http://www.w3.org/TR/WebCryptoAPI/">http://www.w3.org/TR/WebCryptoAPI/</a>
   <dt id="biblio-webidl-1">[WebIDL-1]
   <dd>Cameron McCormack; Boris Zbarsky. <a href="http://www.w3.org/TR/WebIDL-1/">WebIDL Level 1</a>. 4 August 2015. WD. URL: <a href="http://www.w3.org/TR/WebIDL-1/">http://www.w3.org/TR/WebIDL-1/</a>
  </dl>
  <h3 class="no-num no-ref heading settled" id="informative"><span class="content">Informative References</span><a class="self-link" href="#informative"></a></h3>
  <dl>
   <dt id="biblio-fidometadataservice">[FIDOMetadataService]
   <dd>R. Lindemann; B. Hill; D. Baghdasaryan. <a href="https://fidoalliance.org/specs/fido-uaf-v1.0-ps-20141208/fido-uaf-metadata-service-v1.0-ps-20141208.html">FIDO Metadata Service v1.0</a>. FIDO Alliance Proposed Standard. URL: <a href="https://fidoalliance.org/specs/fido-uaf-v1.0-ps-20141208/fido-uaf-metadata-service-v1.0-ps-20141208.html">https://fidoalliance.org/specs/fido-uaf-v1.0-ps-20141208/fido-uaf-metadata-service-v1.0-ps-20141208.html</a>
   <dt id="biblio-fidosecref">[FIDOSecRef]
   <dd>R. Lindemann; D. Baghdasaryan; B. Hill. <a href="https://fidoalliance.org/specs/fido-uaf-v1.0-ps-20141208/fido-security-ref-v1.0-ps-20141208.html">FIDO Security Reference</a>. FIDO Alliance Proposed Standard. URL: <a href="https://fidoalliance.org/specs/fido-uaf-v1.0-ps-20141208/fido-security-ref-v1.0-ps-20141208.html">https://fidoalliance.org/specs/fido-uaf-v1.0-ps-20141208/fido-security-ref-v1.0-ps-20141208.html</a>
   <dt id="biblio-geojson">[GeoJSON]
   <dd><a href="http://geojson.org/geojson-spec.html">The GeoJSON Format Specification</a>. URL: <a href="http://geojson.org/geojson-spec.html">http://geojson.org/geojson-spec.html</a>
   <dt id="biblio-jwk">[JWK]
   <dd>Mike Jones. <a href="https://tools.ietf.org/html/draft-ietf-jose-json-web-key-11">JSON Web Key (JWK)</a>. 28 May 2013. Internet Draft. URL: <a href="https://tools.ietf.org/html/draft-ietf-jose-json-web-key-11">https://tools.ietf.org/html/draft-ietf-jose-json-web-key-11</a>
   <dt id="biblio-powerful-features">[POWERFUL-FEATURES]
   <dd>Mike West; Yan Zhu. <a href="http://www.w3.org/TR/powerful-features/">Privileged Contexts</a>. 24 April 2015. WD. URL: <a href="http://www.w3.org/TR/powerful-features/">http://www.w3.org/TR/powerful-features/</a>
   <dt id="biblio-psl">[PSL]
   <dd><cite><a href="https://publicsuffix.org/">Public Suffix List</a></cite>.    Mozilla Foundation.
   <dt id="biblio-rfc3447">[RFC3447]
   <dd>J. Jonsson; B. Kaliski. <a href="https://tools.ietf.org/html/rfc3447">Public-Key Cryptography Standards (PKCS) #1: RSA Cryptography Specifications Version 2.1</a>. February 2003. Informational. URL: <a href="https://tools.ietf.org/html/rfc3447">https://tools.ietf.org/html/rfc3447</a>
   <dt id="biblio-rfc4055">[RFC4055]
   <dd>J. Schaad; B. Kaliski; R. Housley. <a href="https://tools.ietf.org/html/rfc4055">Additional Algorithms and Identifiers for RSA Cryptography for use in the Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile</a>. June 2005. Proposed Standard. URL: <a href="https://tools.ietf.org/html/rfc4055">https://tools.ietf.org/html/rfc4055</a>
   <dt id="biblio-rfc4122">[RFC4122]
   <dd>P. Leach; M. Mealling; R. Salz. <a href="https://tools.ietf.org/html/rfc4122">A Universally Unique IDentifier (UUID) URN Namespace</a>. July 2005. Proposed Standard. URL: <a href="https://tools.ietf.org/html/rfc4122">https://tools.ietf.org/html/rfc4122</a>
   <dt id="biblio-rfc4648">[RFC4648]
   <dd>S. Josefsson. <a href="https://tools.ietf.org/html/rfc4648">The Base16, Base32, and Base64 Data Encodings</a>. October 2006. Proposed Standard. URL: <a href="https://tools.ietf.org/html/rfc4648">https://tools.ietf.org/html/rfc4648</a>
   <dt id="biblio-rfc5280">[RFC5280]
   <dd>D. Cooper; et al. <a href="https://tools.ietf.org/html/rfc5280">Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile</a>. May 2008. Proposed Standard. URL: <a href="https://tools.ietf.org/html/rfc5280">https://tools.ietf.org/html/rfc5280</a>
   <dt id="biblio-rfc6454">[RFC6454]
   <dd>A. Barth. <a href="https://tools.ietf.org/html/rfc6454">The Web Origin Concept</a>. December 2011. Proposed Standard. URL: <a href="https://tools.ietf.org/html/rfc6454">https://tools.ietf.org/html/rfc6454</a>
   <dt id="biblio-rfc7049">[RFC7049]
   <dd>C. Bormann; P. Hoffman. <a href="https://tools.ietf.org/html/rfc7049">Concise Binary Object Representation (CBOR)</a>. October 2013. Proposed Standard. URL: <a href="https://tools.ietf.org/html/rfc7049">https://tools.ietf.org/html/rfc7049</a>
   <dt id="biblio-rfc7159">[RFC7159]
   <dd>T. Bray, Ed.. <a href="https://tools.ietf.org/html/rfc7159">The JavaScript Object Notation (JSON) Data Interchange Format</a>. March 2014. Proposed Standard. URL: <a href="https://tools.ietf.org/html/rfc7159">https://tools.ietf.org/html/rfc7159</a>
   <dt id="biblio-sp800-107r1">[SP800-107r1]
   <dd>Quynh Dang. <a href="http://csrc.nist.gov/publications/nistpubs/800-107-rev1/sp800-107-rev1.pdf">NIST Special Publication 800-107: Recommendation for Applications Using Approved Hash Algorithms</a>. August 2012. URL: <a href="http://csrc.nist.gov/publications/nistpubs/800-107-rev1/sp800-107-rev1.pdf">http://csrc.nist.gov/publications/nistpubs/800-107-rev1/sp800-107-rev1.pdf</a>
   <dt id="biblio-tpm">[TPM]
   <dd><a href="http://www.trustedcomputinggroup.org/resources/tpm_main_specification">TPM Main Specification</a>. Accessed March 2014. URL: <a href="http://www.trustedcomputinggroup.org/resources/tpm_main_specification">http://www.trustedcomputinggroup.org/resources/tpm_main_specification</a>
   <dt id="biblio-tpmv1-2-credential-profiles">[TPMv1-2-Credential-Profiles]
   <dd><a href="http://www.trustedcomputinggroup.org/files/static_page_files/A55529C5-1A4B-B294-D0A5A400E1EDE13A/Credential_Profiles_V1.2_Level2_Revision8.pdf">TPM 1.2 Credential Profiles</a>. URL: <a href="http://www.trustedcomputinggroup.org/files/static_page_files/A55529C5-1A4B-B294-D0A5A400E1EDE13A/Credential_Profiles_V1.2_Level2_Revision8.pdf">http://www.trustedcomputinggroup.org/files/static_page_files/A55529C5-1A4B-B294-D0A5A400E1EDE13A/Credential_Profiles_V1.2_Level2_Revision8.pdf</a>
   <dt id="biblio-tpmv1-2-part2">[TPMv1-2-Part2]
   <dd><a href="http://www.trustedcomputinggroup.org/files/static_page_files/E55A303C-1A4B-B294-D066E66A82DAE27D/TPM%20Main-Part%202%20TPM%20Structures_v1.2_rev116_01032011.pdf">TPM 1.2 Part 2: Structures</a>. URL: <a href="http://www.trustedcomputinggroup.org/files/static_page_files/E55A303C-1A4B-B294-D066E66A82DAE27D/TPM%20Main-Part%202%20TPM%20Structures_v1.2_rev116_01032011.pdf">http://www.trustedcomputinggroup.org/files/static_page_files/E55A303C-1A4B-B294-D066E66A82DAE27D/TPM%20Main-Part%202%20TPM%20Structures_v1.2_rev116_01032011.pdf</a>
   <dt id="biblio-tpmv2-ek-profile">[TPMv2-EK-Profile]
   <dd><a href="http://www.trustedcomputinggroup.org/files/static_page_files/DCD56924-1A4B-B294-D0CEF64E80CEE01E/Credential_Profile_EK_V2.0_R12_PublicReview.pdf">TCG EK Credential Profile</a>. URL: <a href="http://www.trustedcomputinggroup.org/files/static_page_files/DCD56924-1A4B-B294-D0CEF64E80CEE01E/Credential_Profile_EK_V2.0_R12_PublicReview.pdf">http://www.trustedcomputinggroup.org/files/static_page_files/DCD56924-1A4B-B294-D0CEF64E80CEE01E/Credential_Profile_EK_V2.0_R12_PublicReview.pdf</a>
   <dt id="biblio-tpmv2-part2">[TPMv2-Part2]
   <dd><a href="http://www.trustedcomputinggroup.org/files/static_page_files/8C583202-1A4B-B294-D0469592DB10A6CD/TPM%20Rev%202.0%20Part%202%20-%20Structures%2001.16.pdf">Trusted Platform Module Library, Part 2: Structures</a>. URL: <a href="http://www.trustedcomputinggroup.org/files/static_page_files/8C583202-1A4B-B294-D0469592DB10A6CD/TPM%20Rev%202.0%20Part%202%20-%20Structures%2001.16.pdf">http://www.trustedcomputinggroup.org/files/static_page_files/8C583202-1A4B-B294-D0469592DB10A6CD/TPM%20Rev%202.0%20Part%202%20-%20Structures%2001.16.pdf</a>
   <dt id="biblio-uafprotocol">[UAFProtocol]
   <dd>R. Lindemann; et al. <a href="https://fidoalliance.org/specs/fido-uaf-v1.1-id-20150902/fido-uaf-protocol-v1.1-id-20150902.html">FIDO UAF Protocol Specification v1.0</a>. FIDO Alliance Proposed Standard. URL: <a href="https://fidoalliance.org/specs/fido-uaf-v1.1-id-20150902/fido-uaf-protocol-v1.1-id-20150902.html">https://fidoalliance.org/specs/fido-uaf-v1.1-id-20150902/fido-uaf-protocol-v1.1-id-20150902.html</a>
  </dl>
  <h2 class="no-num no-ref heading settled" id="idl-index"><span class="content">IDL Index</span><a class="self-link" href="#idl-index"></a></h2>
<pre class="idl def">partial interface <a class="idl-code" data-link-type="interface" href="https://html.spec.whatwg.org/multipage/browsers.html#window">Window</a> { 
    readonly attribute <a data-link-type="idl-name" href="#fidocredentials">FIDOCredentials</a> <a data-readonly="" data-type="FIDOCredentials " href="#dom-window-fido">fido</a>; 
}; 
   
interface <a class="idl-code" data-link-type="interface" href="#fidocredentials">FIDOCredentials</a> { 
    Promise &lt; <a data-link-type="idl-name" href="#fidocredentialinfo">FIDOCredentialInfo</a> > <a class="idl-code" data-link-type="method" href="#dom-fidocredentials-makecredential">makeCredential</a> ( 
        <a data-link-type="idl-name" href="#dictdef-account">Account</a>                               <a href="#dom-fidocredentials-makecredential-accountinformation-cryptoparameters-attestationchallenge-credentialtimeoutseconds-blacklist-credentialextensions-accountinformation">accountInformation</a>, 
        sequence &lt; <a data-link-type="idl-name" href="#dictdef-fidocredentialparameters">FIDOCredentialParameters</a> > <a href="#dom-fidocredentials-makecredential-accountinformation-cryptoparameters-attestationchallenge-credentialtimeoutseconds-blacklist-credentialextensions-cryptoparameters">cryptoParameters</a>, 
        DOMString                             <a href="#dom-fidocredentials-makecredential-accountinformation-cryptoparameters-attestationchallenge-credentialtimeoutseconds-blacklist-credentialextensions-attestationchallenge">attestationChallenge</a>,
        optional unsigned long                <a href="#dom-fidocredentials-makecredential-accountinformation-cryptoparameters-attestationchallenge-credentialtimeoutseconds-blacklist-credentialextensions-credentialtimeoutseconds">credentialTimeoutSeconds</a>,
        optional sequence &lt; <a data-link-type="idl-name" href="#credential">Credential</a> >      <a href="#dom-fidocredentials-makecredential-accountinformation-cryptoparameters-attestationchallenge-credentialtimeoutseconds-blacklist-credentialextensions-blacklist">blacklist</a>,
        optional <a data-link-type="idl-name" href="#dictdef-fidoextensions">FIDOExtensions</a>               <a href="#dom-fidocredentials-makecredential-accountinformation-cryptoparameters-attestationchallenge-credentialtimeoutseconds-blacklist-credentialextensions-credentialextensions">credentialExtensions</a>
    ); 
   
    Promise &lt; <a data-link-type="idl-name" href="#fidoassertion">FIDOAssertion</a> > <a class="idl-code" data-link-type="method" href="#dom-fidocredentials-getassertion">getAssertion</a> ( 
        DOMString                        <a href="#dom-fidocredentials-getassertion-assertionchallenge-assertiontimeoutseconds-whitelist-assertionextensions-assertionchallenge">assertionChallenge</a>,
        optional unsigned long           <a href="#dom-fidocredentials-getassertion-assertionchallenge-assertiontimeoutseconds-whitelist-assertionextensions-assertiontimeoutseconds">assertionTimeoutSeconds</a>,
        optional sequence &lt; <a data-link-type="idl-name" href="#credential">Credential</a> > <a href="#dom-fidocredentials-getassertion-assertionchallenge-assertiontimeoutseconds-whitelist-assertionextensions-whitelist">whitelist</a>, 
        optional <a data-link-type="idl-name" href="#dictdef-fidoextensions">FIDOExtensions</a>          <a href="#dom-fidocredentials-getassertion-assertionchallenge-assertiontimeoutseconds-whitelist-assertionextensions-assertionextensions">assertionExtensions</a> 
    ); 
}; 
   
interface <a class="idl-code" data-link-type="interface" href="#fidocredentialinfo">FIDOCredentialInfo</a> { 
    readonly attribute <a data-link-type="idl-name" href="#credential">Credential</a>           <a data-readonly="" data-type="Credential           " href="#dom-fidocredentialinfo-credential">credential</a>; 
    readonly attribute <a data-link-type="idl-name" href="#algorithmidentifier">AlgorithmIdentifier</a>  <a data-readonly="" data-type="AlgorithmIdentifier  " href="#dom-fidocredentialinfo-algorithm">algorithm</a>; 
    readonly attribute any                  <a data-readonly="" data-type="any                  " href="#dom-fidocredentialinfo-publickey">publicKey</a>; 
    readonly attribute <a data-link-type="idl-name" href="#fidoassertion-attestationstatement">AttestationStatement</a> <a data-readonly="" data-type="AttestationStatement " href="#dom-fidocredentialinfo-attestation">attestation</a>; 
}; 

dictionary <a class="idl-code" data-link-type="dictionary" href="#dictdef-account">Account</a> { 
    required DOMString <a data-type="DOMString " href="#dom-account-rpdisplayname">rpDisplayName</a>; 
    required DOMString <a data-type="DOMString " href="#dom-account-displayname">displayName</a>; 
    DOMString          <a data-type="DOMString          " href="#dom-account-name">name</a>; 
    DOMString          <a data-type="DOMString          " href="#dom-account-id">id</a>; 
    DOMString          <a data-type="DOMString          " href="#dom-account-imageuri">imageUri</a>; 
};
   
dictionary <a class="idl-code" data-link-type="dictionary" href="#dictdef-fidocredentialparameters">FIDOCredentialParameters</a> { 
    required <a data-link-type="idl-name" href="#enumdef-credentialtype">CredentialType</a>        <a data-type="CredentialType        " href="#dom-fidocredentialparameters-type">type</a>; 
    required <a data-link-type="idl-name" href="#algorithmidentifier">AlgorithmIdentifier</a>   <a data-type="AlgorithmIdentifier   " href="#dom-fidocredentialparameters-algorithm">algorithm</a>; 
}; 

enum <a class="idl-code" data-link-type="enum" href="#enumdef-credentialtype">CredentialType</a> { 
    <a href="#dom-credentialtype-fido">"FIDO"</a> 
}; 

interface <a class="idl-code" data-link-type="interface" href="#credential">Credential</a> { 
    readonly attribute <a data-link-type="idl-name" href="#enumdef-credentialtype">CredentialType</a> <a data-readonly="" data-type="CredentialType " href="#dom-credential-type">type</a>; 
    readonly attribute DOMString      <a data-readonly="" data-type="DOMString      " href="#dom-credential-id">id</a>; 
};
  
dictionary <a href="#dictdef-fidoextensions">FIDOExtensions</a> {
};

dictionary <a href="#dictdef-clientdata">ClientData</a> {
  DOMString       <a data-type="DOMString       " href="#dom-clientdata-challenge">challenge</a>;
  DOMString       <a data-type="DOMString       " href="#dom-clientdata-facet">facet</a>;
  <a data-link-type="idl-name" href="#jsonwebkey">JsonWebKey</a>      <a data-type="JsonWebKey      " href="#dom-clientdata-tokenbinding">tokenBinding</a>;
  object          <a data-type="object          " href="#dom-clientdata-extensions">extensions</a>; // optional
  DOMString       <a data-type="DOMString       " href="#dom-clientdata-hashalg">hashAlg</a>;
};

interface <a href="#fidoassertion">FIDOAssertion</a> {
  attribute <a data-link-type="idl-name" href="#credential">Credential</a> <a data-type="Credential " href="#dom-fidoassertion-credential">credential</a>;
  attribute DOMString  <a data-type="DOMString  " href="#dom-fidoassertion-clientdata">clientData</a>;
  attribute DOMString  <a data-type="DOMString  " href="#dom-fidoassertion-authenticatordata">authenticatorData</a>;
  attribute DOMString  <a data-type="DOMString  " href="#dom-fidoassertion-signature">signature</a>;
};

interface <a href="#fidoassertion-attestationstatement">AttestationStatement</a> {
    readonly    attribute <a data-link-type="idl-name" href="#fidoassertion-attestationheader">AttestationHeader</a> <a data-readonly="" data-type="AttestationHeader " href="#dom-attestationstatement-header">header</a>;
    readonly    attribute <a data-link-type="idl-name" href="#fidoassertion-attestationcore">AttestationCore</a>   <a data-readonly="" data-type="AttestationCore   " href="#dom-attestationstatement-core">core</a>;
    readonly    attribute DOMString         <a data-readonly="" data-type="DOMString         " href="#dom-attestationstatement-signature">signature</a>;
};

interface <a href="#fidoassertion-attestationcore">AttestationCore</a> {
    readonly    attribute DOMString     <a data-readonly="" data-type="DOMString     " href="#dom-attestationcore-type">type</a>;
    readonly    attribute unsigned long <a data-readonly="" data-type="unsigned long " href="#dom-attestationcore-version">version</a>;
    readonly    attribute DOMString     <a data-readonly="" data-type="DOMString     " href="#dom-attestationcore-rawdata">rawData</a>;
    readonly    attribute DOMString     <a data-readonly="" data-type="DOMString     " href="#dom-attestationcore-clientdata">clientData</a>;
};  

interface <a href="#fidoassertion-attestationheader">AttestationHeader</a> {
    readonly    attribute DOMString   <a data-readonly="" data-type="DOMString   " href="#dom-attestationheader-claimedaaguid">claimedAAGUID</a>;
    readonly    attribute DOMString[] <a data-readonly="" data-type="DOMString[] " href="#dom-attestationheader-x5c">x5c</a>;
    readonly    attribute DOMString   <a data-readonly="" data-type="DOMString   " href="#dom-attestationheader-alg">alg</a>;
};

dictionary <a href="#dictdef-fidoassertion-androidattestationclientdata">AndroidAttestationClientData</a> : <a data-link-type="idl-name" href="#dictdef-clientdata">ClientData</a> {
             <a data-link-type="idl-name" href="#jsonwebkey">JsonWebKey</a>             <a data-type="JsonWebKey             " href="#dom-androidattestationclientdata-publickey">publicKey</a>;
             boolean                <a data-type="boolean                " href="#dom-androidattestationclientdata-isinsidesecurehardware">isInsideSecureHardware</a>;
             DOMString              <a data-type="DOMString              " href="#dom-androidattestationclientdata-userauthentication">userAuthentication</a>;
             unsigned long <a data-type="unsigned long " href="#dom-androidattestationclientdata-userauthenticationvaliditydurationseconds">userAuthenticationValidityDurationSeconds</a>; // optional
};  

typedef sequence &lt; <a data-link-type="idl-name" href="#typedefdef-fidoassertion-aaguid">AAGUID</a> > <a href="#typedefdef-fidoassertion-authenticatorselectionlist">AuthenticatorSelectionList</a>;

typedef DOMString <a href="#typedefdef-fidoassertion-aaguid">AAGUID</a>;

</pre>
<script>
        document.body.addEventListener("click", function(e) {
            var queryAll = function(sel) { return [].slice.call(document.querySelectorAll(sel)); }
            // Find the dfn element or panel, if any, that was clicked on.
            var el = e.target;
            var target;
            while(el.parentElement) {
                if(el.tagName == "DFN") {
                    target = "dfn";
                    break;
                }
                if(/H\d/.test(el.tagName) && el.getAttribute('data-dfn-type') != null) {
                    target = "dfn";
                    break;
                }
                if(el.classList.contains("dfn-panel")) {
                    target = "dfn-panel";
                    break;
                }
                el = el.parentElement;
            }
            if(target != "dfn-panel") {
                // Turn off any currently "on" or "activated" panels.
                queryAll(".dfn-panel.on, .dfn-panel.activated").forEach(function(el){
                    el.classList.remove("on");
                    el.classList.remove("activated");
                });
            }
            if(target == "dfn") {
                // open the panel
                var dfnPanel = el.querySelector(".dfn-panel");
                if(dfnPanel) {
                    dfnPanel.classList.add("on");
                }
            } else if(target == "dfn-panel") {
                // Switch it to "activated" state, which pins it.
                el.classList.add("activated");
            }

        });
        </script>